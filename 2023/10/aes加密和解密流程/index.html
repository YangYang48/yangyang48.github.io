<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.85.0 with theme Tranquilpeak 0.4.8-BETA">
<meta name="author" content="Yang Ju">
<meta name="keywords" content="">
<meta name="description" content="AES (Advanced Encryption Standard)是一种区块加密标准算法，它的提出是为了升级替换原有的DES加密算法。因此它的安全强度高于DES算法。">


<meta property="og:description" content="AES (Advanced Encryption Standard)是一种区块加密标准算法，它的提出是为了升级替换原有的DES加密算法。因此它的安全强度高于DES算法。">
<meta property="og:type" content="article">
<meta property="og:title" content="AES加密和解密流程">
<meta name="twitter:title" content="AES加密和解密流程">
<meta property="og:url" content="https://yangyang48.github.io/2023/10/aes%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86%E6%B5%81%E7%A8%8B/">
<meta property="twitter:url" content="https://yangyang48.github.io/2023/10/aes%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86%E6%B5%81%E7%A8%8B/">
<meta property="og:site_name" content="欢迎来到我的博客~">
<meta property="og:description" content="AES (Advanced Encryption Standard)是一种区块加密标准算法，它的提出是为了升级替换原有的DES加密算法。因此它的安全强度高于DES算法。">
<meta name="twitter:description" content="AES (Advanced Encryption Standard)是一种区块加密标准算法，它的提出是为了升级替换原有的DES加密算法。因此它的安全强度高于DES算法。">
<meta property="og:locale" content="zh-cn">

  
    <meta property="article:published_time" content="2023-10-03T00:00:00">
  
  
    <meta property="article:modified_time" content="2023-10-03T00:00:00">
  
  
  
    
      <meta property="article:section" content="AES">
    
      <meta property="article:section" content="2023">
    
      <meta property="article:section" content="October">
    
  
  
    
      <meta property="article:tag" content="加密">
    
      <meta property="article:tag" content="解密">
    
      <meta property="article:tag" content="BASE64">
    
      <meta property="article:tag" content="AES128">
    
      <meta property="article:tag" content="AES192">
    
      <meta property="article:tag" content="AES256">
    
      <meta property="article:tag" content="轮密钥加">
    
      <meta property="article:tag" content="列混淆">
    
      <meta property="article:tag" content="字节代换">
    
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://yangyang48.github.io/cryptography/aes/aes_thumb.jpg">
  <meta property="twitter:image" content="https://yangyang48.github.io/cryptography/aes/aes_thumb.jpg">


  <meta property="og:image" content="https://yangyang48.github.io/cryptography/aes/aes_cover.png">
  <meta property="twitter:image" content="https://yangyang48.github.io/cryptography/aes/aes_cover.png">




  <meta property="og:image" content="https://yangyang48.github.io/thumb/20210711204627625.jpg">
  <meta property="twitter:image" content="https://yangyang48.github.io/thumb/20210711204627625.jpg">


    <title>AES加密和解密流程</title>

    <link rel="icon" href="https://yangyang48.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://yangyang48.github.io/2023/10/aes%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86%E6%B5%81%E7%A8%8B/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://yangyang48.github.io/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://yangyang48.github.io/css/copy-to-clipboard.css">
      
    

    
      
    
    

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://yangyang48.github.io/">欢迎来到我的博客~</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://yangyang48.github.io/#about">
    
    
    
      
        <img class="header-picture" src="https://yangyang48.github.io/thumb/20210711204627625.jpg" alt="作者的图片" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://yangyang48.github.io/#about">
          <img class="sidebar-profile-picture" src="https://yangyang48.github.io/thumb/20210711204627625.jpg" alt="作者的图片" />
        </a>
        <h4 class="sidebar-profile-name">Yang Ju</h4>
        
          <h5 class="sidebar-profile-bio">Nanjing University of Science and Technology</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">首页</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">分类</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">标签</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">归档</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">关于</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/YangYang48" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://blog.csdn.net/yangju147532896" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-chain"></i>
      
      <span class="sidebar-button-desc">CSDN</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              "
       style="background-image:url('/cryptography/aes/aes_cover.png')"
       data-behavior="4">
    
  </div>


      <div id="main" data-behavior="4"
        class="hasCover
               hasCoverMetaOut
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      AES加密和解密流程
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2023-10-03T00:00:00Z">
        
  十月 3, 2023

      </time>
    
    
  
  
    <span>发布在</span>
    
      <a class="category-link" href="https://yangyang48.github.io/categories/aes">AES</a>, 
    
      <a class="category-link" href="https://yangyang48.github.io/categories/2023">2023</a>, 
    
      <a class="category-link" href="https://yangyang48.github.io/categories/october">October</a>
    
  

  </div>

</div>
          
		  
		  <h5 id="wc" style="font-size: 1rem;text-align: center;">6600 Words|Read in about 31 Min|本文总阅读量<span id="busuanzi_value_page_pv"></span>次</h5>
      
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>AES (Advanced Encryption Standard)是一种区块加密标准算法，它的提出是为了升级替换原有的DES加密算法。因此它的安全强度高于DES算法。</p>
<h1 id="1简介">1简介</h1>
<p>AES的加密模式</p>
<table>
<thead>
<tr>
<th>AES的加密模式</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>密钥长度</td>
<td><code>AES128</code>、<code>AES192</code>、<code>AES256</code></td>
</tr>
<tr>
<td>加密模式</td>
<td><code>ECB</code>、<code>CBC</code>、<code>CFB</code>、<code>OFB</code>、<code>CTR</code>、<code>CCM</code>、<code>GCM</code>、<code>XTS</code></td>
</tr>
<tr>
<td>填充模式</td>
<td><code>NONE</code>、<code>PKCS7</code>、<code>ZERO</code>、<code>ANS1923</code>、<code>ISO7816_4</code>、<code>ISO10126</code></td>
</tr>
</tbody>
</table>
<p>现在的加密库一般会提供一些默认值，所以用户使用AES加密的时候，并没有去做这方面的配置。</p>
<p>密钥长度</p>
<p>这些密钥长度是以bit为单位的，一个字节为8个bit，所以128对应是16个字节，192对应24个字节，256对应是32个字节。</p>
<p>AES128</p>
<p>规定用于的秘钥是16个字节，超过16个字节，它不会被使用就当做没看见（截断处理）</p>
<p>然后，会把整个数据分成四行四列</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_2.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_2.png" >
  
    </a>
  
  
</div>

<p>AES192</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_4.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_4.png" >
  
    </a>
  
  
</div>

<p>AES256</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_5.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_5.png" >
  
    </a>
  
  
</div>

<p>以AES-256为例，假如现在我们想破解它，其难易程度如何呢？2^256^就是256位AES的密钥空间的组合数，远大于地球所有沙子的总数量（3×10^23）^。2^256^ &gt; 2^(10<em>25)^ &gt; 10^(3</em>25)^=10^75^&raquo;3×10^23^。现在问题来了：假设你能够把每一粒沙子做出一个存储设备，存一个值。你只能存储3*10^23^*个不同的答案。而你没法全部试一遍，这样破解难度依靠现有技术资源和时间长度，几乎是无法进行计算破解，难度系数等同于不可能。</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_1.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_1.png" >
  
    </a>
  
  
</div>

<p>加密模式</p>
<p>AES有很多加密模式，其中ECB是最经典的加密模式，其他很多模式都是通过ECB改变过来的，本文主要以ECB为主，后续顺带说一下CBC的加密模式。</p>
<p>填充模式</p>
<p>AES加密数据是以16字节为一组进行分组加密。要求明文的长度一定要是<strong>16个字节的倍数</strong>。如果不够16个字节的倍数的话，需要填充至16个字节倍数。</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_6.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_6.png" >
  
    </a>
  
  
</div>

<blockquote>
<p><strong>填充模式注意事项</strong></p>
<p>除了<strong>NONE模式</strong>填充以外的任何填充模式下，就算原始明文长度已经是16个字节的倍数，也一定要进行填充</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_7.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_7.png" >
  
    </a>
  
  
</div>

</blockquote>
<p>AES排列方式</p>
<p>在AES当中，它的排列方式是以列从上往下进行排列的，如下图所示</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_13.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_13.png" >
  
    </a>
  
  
</div>

<h1 id="1加密">1加密</h1>
<h2 id="11加密流程">1.1加密流程</h2>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_8.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_8.png" >
  
    </a>
  
  
</div>

<h2 id="12加密器内部流程">1.2加密器内部流程</h2>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_9.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_9.png" >
  
    </a>
  
  
</div>

<p>AES128加密器（10轮）</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_10.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_10.png" >
  
    </a>
  
  
</div>

<p>AES192加密器（12轮）</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_11.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_11.png" >
  
    </a>
  
  
</div>

<p>AES256加密器（14轮）</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_12.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_12.png" >
  
    </a>
  
  
</div>

<h2 id="13秘钥扩展">1.3秘钥扩展</h2>
<p>秘钥扩展就是把用户输入的（16/24/32）字节的秘钥扩展到（176,208,240）字节的轮秘钥。通俗的来讲，将用户输入的秘钥，扩展成比较长的秘钥。</p>
<blockquote>
<p>176/208/240这三个数是怎么来的</p>
<p>（<code>11*16 = 176</code>），（<code> 13*16 = 208</code>），（<code> 15*16 = 240</code>）</p>
</blockquote>
<p>nk值（秘钥的列数）</p>
<p>AES128的nk值为4（16/4=4）</p>
<p>AES192的nk值为6（24/4=6）</p>
<p>AES256的nk值为8（32/4=8）</p>
<h2 id="14秘钥扩展公式">1.4秘钥扩展公式</h2>
<p>这里以秘钥是0102030405060708090A0B0C0D0E0F10为例子</p>
<h3 id="141情况1">1.4.1情况1</h3>
<p>情况1：[当前列] % nk值 == 0</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>公式：[当前列-nk值] ⊕ 轮常量异或(字节代换(列位移([当前列-1])))
</code></pre></div>

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_14.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_14.png" >
  
    </a>
  
  
</div>

<p>其中涉及到了<strong>字节代换表</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
<th style="text-align:center">6</th>
<th style="text-align:center">7</th>
<th style="text-align:center">8</th>
<th style="text-align:center">9</th>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
<th style="text-align:center">E</th>
<th style="text-align:center">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">63</td>
<td style="text-align:center">7C</td>
<td style="text-align:center">77</td>
<td style="text-align:center">7B</td>
<td style="text-align:center">F2</td>
<td style="text-align:center">6B</td>
<td style="text-align:center">6F</td>
<td style="text-align:center">C5</td>
<td style="text-align:center">30</td>
<td style="text-align:center">01</td>
<td style="text-align:center">67</td>
<td style="text-align:center">2B</td>
<td style="text-align:center">FE</td>
<td style="text-align:center">D7</td>
<td style="text-align:center">AB</td>
<td style="text-align:center">76</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">CA</td>
<td style="text-align:center">82</td>
<td style="text-align:center">C9</td>
<td style="text-align:center">7D</td>
<td style="text-align:center">FA</td>
<td style="text-align:center">59</td>
<td style="text-align:center">47</td>
<td style="text-align:center">F0</td>
<td style="text-align:center">AD</td>
<td style="text-align:center">D4</td>
<td style="text-align:center">A2</td>
<td style="text-align:center">AF</td>
<td style="text-align:center">9C</td>
<td style="text-align:center">A4</td>
<td style="text-align:center">72</td>
<td style="text-align:center">C0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">B7</td>
<td style="text-align:center">FD</td>
<td style="text-align:center">93</td>
<td style="text-align:center">26</td>
<td style="text-align:center">36</td>
<td style="text-align:center">3F</td>
<td style="text-align:center">F7</td>
<td style="text-align:center">CC</td>
<td style="text-align:center">34</td>
<td style="text-align:center">A5</td>
<td style="text-align:center">E5</td>
<td style="text-align:center">F1</td>
<td style="text-align:center">71</td>
<td style="text-align:center">D8</td>
<td style="text-align:center">31</td>
<td style="text-align:center">15</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">04</td>
<td style="text-align:center">C7</td>
<td style="text-align:center">23</td>
<td style="text-align:center">C3</td>
<td style="text-align:center">1</td>
<td style="text-align:center">96</td>
<td style="text-align:center">05</td>
<td style="text-align:center">9A</td>
<td style="text-align:center">07</td>
<td style="text-align:center">12</td>
<td style="text-align:center">80</td>
<td style="text-align:center">E2</td>
<td style="text-align:center">EB</td>
<td style="text-align:center">27</td>
<td style="text-align:center">B2</td>
<td style="text-align:center">75</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">09</td>
<td style="text-align:center">83</td>
<td style="text-align:center">2C</td>
<td style="text-align:center">1A</td>
<td style="text-align:center">1B</td>
<td style="text-align:center">6E</td>
<td style="text-align:center">5A</td>
<td style="text-align:center">A0</td>
<td style="text-align:center">52</td>
<td style="text-align:center">3B</td>
<td style="text-align:center">D6</td>
<td style="text-align:center">B3</td>
<td style="text-align:center">29</td>
<td style="text-align:center">E3</td>
<td style="text-align:center">2F</td>
<td style="text-align:center">84</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">53</td>
<td style="text-align:center">D1</td>
<td style="text-align:center">00</td>
<td style="text-align:center">ED</td>
<td style="text-align:center">20</td>
<td style="text-align:center">FC</td>
<td style="text-align:center">B1</td>
<td style="text-align:center">5B</td>
<td style="text-align:center">6A</td>
<td style="text-align:center">CB</td>
<td style="text-align:center">BE</td>
<td style="text-align:center">39</td>
<td style="text-align:center">4A</td>
<td style="text-align:center">4C</td>
<td style="text-align:center">58</td>
<td style="text-align:center">CF</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">D0</td>
<td style="text-align:center">EF</td>
<td style="text-align:center">AA</td>
<td style="text-align:center">FB</td>
<td style="text-align:center">43</td>
<td style="text-align:center">4D</td>
<td style="text-align:center">33</td>
<td style="text-align:center">85</td>
<td style="text-align:center">45</td>
<td style="text-align:center">F9</td>
<td style="text-align:center">02</td>
<td style="text-align:center">7F</td>
<td style="text-align:center">50</td>
<td style="text-align:center">3C</td>
<td style="text-align:center">9F</td>
<td style="text-align:center">A8</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">51</td>
<td style="text-align:center">A3</td>
<td style="text-align:center">40</td>
<td style="text-align:center">8F</td>
<td style="text-align:center">92</td>
<td style="text-align:center">9D</td>
<td style="text-align:center">38</td>
<td style="text-align:center">F5</td>
<td style="text-align:center">BC</td>
<td style="text-align:center">B6</td>
<td style="text-align:center">DA</td>
<td style="text-align:center">21</td>
<td style="text-align:center">10</td>
<td style="text-align:center">FF</td>
<td style="text-align:center">F3</td>
<td style="text-align:center">D2</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">CD</td>
<td style="text-align:center">0C</td>
<td style="text-align:center">13</td>
<td style="text-align:center">EC</td>
<td style="text-align:center">5F</td>
<td style="text-align:center">97</td>
<td style="text-align:center">44</td>
<td style="text-align:center">17</td>
<td style="text-align:center">C4</td>
<td style="text-align:center">A7</td>
<td style="text-align:center">7E</td>
<td style="text-align:center">3D</td>
<td style="text-align:center">64</td>
<td style="text-align:center">5D</td>
<td style="text-align:center">19</td>
<td style="text-align:center">73</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">60</td>
<td style="text-align:center">81</td>
<td style="text-align:center">4F</td>
<td style="text-align:center">DC</td>
<td style="text-align:center">22</td>
<td style="text-align:center">2A</td>
<td style="text-align:center">90</td>
<td style="text-align:center">88</td>
<td style="text-align:center">46</td>
<td style="text-align:center">EE</td>
<td style="text-align:center">B8</td>
<td style="text-align:center">14</td>
<td style="text-align:center">DE</td>
<td style="text-align:center">5E</td>
<td style="text-align:center">0B</td>
<td style="text-align:center">DB</td>
</tr>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">E0</td>
<td style="text-align:center">32</td>
<td style="text-align:center">3A</td>
<td style="text-align:center">0A</td>
<td style="text-align:center">49</td>
<td style="text-align:center">06</td>
<td style="text-align:center">24</td>
<td style="text-align:center">5C</td>
<td style="text-align:center">C2</td>
<td style="text-align:center">D3</td>
<td style="text-align:center">AC</td>
<td style="text-align:center">62</td>
<td style="text-align:center">91</td>
<td style="text-align:center">95</td>
<td style="text-align:center">E4</td>
<td style="text-align:center">79</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">E7</td>
<td style="text-align:center">C8</td>
<td style="text-align:center">37</td>
<td style="text-align:center">6D</td>
<td style="text-align:center">8D</td>
<td style="text-align:center">D5</td>
<td style="text-align:center">4E</td>
<td style="text-align:center">A9</td>
<td style="text-align:center">6C</td>
<td style="text-align:center">56</td>
<td style="text-align:center">F4</td>
<td style="text-align:center">EA</td>
<td style="text-align:center">65</td>
<td style="text-align:center">7A</td>
<td style="text-align:center">AE</td>
<td style="text-align:center">08</td>
</tr>
<tr>
<td style="text-align:center">C</td>
<td style="text-align:center">BA</td>
<td style="text-align:center">78</td>
<td style="text-align:center">25</td>
<td style="text-align:center">2E</td>
<td style="text-align:center">1C</td>
<td style="text-align:center">A6</td>
<td style="text-align:center">B4</td>
<td style="text-align:center">C6</td>
<td style="text-align:center">E8</td>
<td style="text-align:center">DD</td>
<td style="text-align:center">74</td>
<td style="text-align:center">1F</td>
<td style="text-align:center">4B</td>
<td style="text-align:center">BD</td>
<td style="text-align:center">8B</td>
<td style="text-align:center">8A</td>
</tr>
<tr>
<td style="text-align:center">D</td>
<td style="text-align:center">70</td>
<td style="text-align:center">3E</td>
<td style="text-align:center">B5</td>
<td style="text-align:center">66</td>
<td style="text-align:center">48</td>
<td style="text-align:center">03</td>
<td style="text-align:center">F6</td>
<td style="text-align:center">0E</td>
<td style="text-align:center">61</td>
<td style="text-align:center">35</td>
<td style="text-align:center">57</td>
<td style="text-align:center">B9</td>
<td style="text-align:center">86</td>
<td style="text-align:center">C1</td>
<td style="text-align:center">1D</td>
<td style="text-align:center">9E</td>
</tr>
<tr>
<td style="text-align:center">E</td>
<td style="text-align:center">E1</td>
<td style="text-align:center">F8</td>
<td style="text-align:center">98</td>
<td style="text-align:center">11</td>
<td style="text-align:center">69</td>
<td style="text-align:center">D9</td>
<td style="text-align:center">8E</td>
<td style="text-align:center">94</td>
<td style="text-align:center">9B</td>
<td style="text-align:center">1E</td>
<td style="text-align:center">87</td>
<td style="text-align:center">E9</td>
<td style="text-align:center">CE</td>
<td style="text-align:center">55</td>
<td style="text-align:center">28</td>
<td style="text-align:center">DF</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">8C</td>
<td style="text-align:center">A1</td>
<td style="text-align:center">89</td>
<td style="text-align:center">0D</td>
<td style="text-align:center">BF</td>
<td style="text-align:center">E6</td>
<td style="text-align:center">42</td>
<td style="text-align:center">68</td>
<td style="text-align:center">41</td>
<td style="text-align:center">99</td>
<td style="text-align:center">2D</td>
<td style="text-align:center">0F</td>
<td style="text-align:center">B0</td>
<td style="text-align:center">54</td>
<td style="text-align:center">BB</td>
<td style="text-align:center">16</td>
</tr>
</tbody>
</table>
<p>另外，还有常量轮值表</p>
<table>
<thead>
<tr>
<th style="text-align:center">01</th>
<th style="text-align:center">02</th>
<th style="text-align:center">04</th>
<th style="text-align:center">08</th>
<th style="text-align:center">10</th>
<th style="text-align:center">20</th>
<th style="text-align:center">40</th>
<th style="text-align:center">80</th>
<th style="text-align:center">1B</th>
<th style="text-align:center">36</th>
<th style="text-align:center">6C</th>
<th style="text-align:center">db</th>
<th style="text-align:center">ab</th>
<th style="text-align:center">4d</th>
</tr>
</thead>
</table>
<h4 id="1411aes128">1.4.1.1AES128</h4>
<p>对于AES128而言，10轮循环，每轮循环正好对应一次常量轮值表中的元素</p>
<p>[当前列] % nk值 == 0，这里的nk值为4，所以就是04的倍数，总共扩展<code>16*16*10</code>的大小</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>04,08,0C,10,14,18,1C,20,24,28
</code></pre></div>

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_15.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_15.png" >
  
    </a>
  
  
</div>

<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln"> 1</span>第04列计算
<span class="ln"> 2</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln"> 3</span>0D			0E			AB			AB ⊕ 01 =AA	       01 = AB
<span class="ln"> 4</span>0E			0F			76			76				 	02 = 74
<span class="ln"> 5</span>0F			10			CA			CA					03 = C9
<span class="ln"> 6</span>10			0D			D7			D7					04 = D3
<span class="ln"> 7</span>第08列计算
<span class="ln"> 8</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln"> 9</span>AA			76			38			38 ⊕ 02 = 3A	   AB = 91
<span class="ln">10</span>76			CA			74			74					74 = 0
<span class="ln">11</span>CA			C7			C6			C6					C9 = 0F
<span class="ln">12</span>C7			AA			AC			AC					D3 = 7F
<span class="ln">13</span>第0C列计算
<span class="ln">14</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">15</span>32			7C			10			10 ⊕ 04 = 14	   91 = 85
<span class="ln">16</span>7C			CE			8B			8B					0 = 8B
<span class="ln">17</span>CE			B4			8D			8D					0F = 82
<span class="ln">18</span>B4			32			23			23					7F = 5C
<span class="ln">19</span>第10列计算
<span class="ln">20</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">21</span>10			8F			73			73 ⊕ 08 = 7B	   85 = FE
<span class="ln">22</span>8F			89			A7			A7					8B = 2C
<span class="ln">23</span>89			3F			75			75					82 = F7
<span class="ln">24</span>3F			10			CA			CA					5C = 96
<span class="ln">25</span>第14列计算
<span class="ln">26</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">27</span>76			A9			D3			D3 ⊕ 10 = C3	   FE = 3D
<span class="ln">28</span>A9			7A			DA			DA					2C = F6
<span class="ln">29</span>7A			DA			57			57					F7 = A0
<span class="ln">30</span>DA			76			38			38					96 = AE
<span class="ln">31</span>第18列计算
<span class="ln">32</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">33</span>69			AC			91			91 ⊕ 20 = B1	   3D = 8C
<span class="ln">34</span>AC			9D			5E			5E					F6 = A8
<span class="ln">35</span>9D			FF			16			16					A0 = B6
<span class="ln">36</span>FF			69			F9			F9					AE = 57
<span class="ln">37</span>第1C列计算
<span class="ln">38</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">39</span>83			22			93			93 ⊕ 40 = D3	   8C = 5F
<span class="ln">40</span>22			D8			61			61					A8 = C9
<span class="ln">41</span>D8			4D			E3			E3					B6 = 55
<span class="ln">42</span>4D			83			EC			EC					57 = BB
<span class="ln">43</span>第20列计算
<span class="ln">44</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">45</span>C3			EE			28			28 ⊕ 80 = A8	   5F = F7
<span class="ln">46</span>EE			6A			02			02					C9 = CB
<span class="ln">47</span>6A			D3			66			66					55 = 33
<span class="ln">48</span>D3			C3			2E			2E					BB = 95
<span class="ln">49</span>第24列计算
<span class="ln">50</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">51</span>DE			AB			62			62 ⊕ 1B = 79	   F7 = 8E
<span class="ln">52</span>AB			1C			9C			9C					CB = 57
<span class="ln">53</span>1C			F4			BF			BF					33 = 8C
<span class="ln">54</span>F4			DE			1D			1D					95 = 88
<span class="ln">55</span>第28列计算
<span class="ln">56</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">57</span>10			30			04			04 ⊕ 36 = 32	   8E = BC
<span class="ln">58</span>30			22			93			93					57 = C4
<span class="ln">59</span>22			E2			98			98					8C = 14
<span class="ln">60</span>E2			10			CA			CA					88 = 42
</code></pre></div><h4 id="1412aes256">1.4.1.2AES256</h4>
<p>同理，对于对于AES256而言，14轮循环，每轮循环正好对应一次常量轮值表中的元素</p>
<p>因为本身AES256就有<code>16*16*2</code>的大小，所以需要拓展<code>16*16*13</code>的大小</p>
<p>[当前列] % nk值 == 0，这里的nk值为8，所以就是08的倍数，这里扩展<code>16*16*7</code>的大小</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>08,10,18,20,28,30,38
</code></pre></div>

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_16.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_16.png" >
  
    </a>
  
  
</div>

<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln"> 1</span>第08列计算
<span class="ln"> 2</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln"> 3</span>1D			1E			72			72 ⊕ 01 = 73	   01 = 72
<span class="ln"> 4</span>1E			1F			C0			C0				 	02 = C2
<span class="ln"> 5</span>1F			20			B7			B7					03 = B4
<span class="ln"> 6</span>20			1D			A4			A4					04 = A0
<span class="ln"> 7</span>第10列计算
<span class="ln"> 8</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln"> 9</span>8F			BA			F4			F4 ⊕ 02 = F6	   72 = 84
<span class="ln">10</span>BA			A9			D3			D3					C2 = 11
<span class="ln">11</span>A9			BD			7A			7A					B4 = CE
<span class="ln">12</span>BD			8F			73			73					A0 = D3
<span class="ln">13</span>第18列计算
<span class="ln">14</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">15</span>B3			B1			C8			C8 ⊕ 04 = CC	   84 = 48
<span class="ln">16</span>B1			48			52			52					11 = 43
<span class="ln">17</span>48			47			A0			A0					CE = 6E
<span class="ln">18</span>47			B3			6D			6D					D3 = BE
<span class="ln">19</span>第20列计算
<span class="ln">20</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">21</span>EC			B5			D5			D5 ⊕ 08 = DD	   48 = 95
<span class="ln">22</span>B5			4D			E3			E3					43 = A0
<span class="ln">23</span>4D			9F			DB			DB					6E = B5
<span class="ln">24</span>9F			EC			CE			CE					BE = 70
<span class="ln">25</span>第28列计算
<span class="ln">26</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">27</span>6D			4B			B3			B3 ⊕ 10 = A3	   95 = 36
<span class="ln">28</span>4B			57			5B			5B					A0 = FB
<span class="ln">29</span>57			3D			27			27					B5 = 92
<span class="ln">30</span>3D			6D			3C			3C					70 = 4C
<span class="ln">31</span>第30列计算
<span class="ln">32</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">33</span>FF			AE			E4			E4 ⊕ 20 = C4	   36 = F2
<span class="ln">34</span>AE			C9			DD			DD					FB = 26
<span class="ln">35</span>C9			79			B6			B6					92 = 24
<span class="ln">36</span>79			FF			16			16					4C = 5A
<span class="ln">37</span>第38列计算
<span class="ln">38</span>当前列-1	列位移			字节代换	轮常量异或			异或当前列-nk
<span class="ln">39</span>33			DE			1D			1D ⊕ 40 = 5D	   F2 = AF
<span class="ln">40</span>DE			54			20			20					26 = 06
<span class="ln">41</span>54			B8			6C			6C					24 = 48
<span class="ln">42</span>B8			33			C3			C3					5A = 99
</code></pre></div><h3 id="142情况2">1.4.2情况2</h3>
<p>情况2比较特殊，只有在AES256存在。</p>
<p>情况2：在AES256中，[当前列]%nk值 != 0 &amp;&amp; [当前列]%4 == 0</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>公式：[当前列-nk值] ⊕ 字节代换([当前列-1])
</code></pre></div><p>[当前列]%nk值 != 0 &amp;&amp; [当前列]%4 == 0，这里的nk值为8，所以就是08的倍数，这里扩展<code>16*16*6</code>的大小</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>0C,14,1C,24,2C,34
</code></pre></div>

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_17.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_17.png" >
  
    </a>
  
  
</div>

<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln"> 1</span>第0C列计算
<span class="ln"> 2</span>当前列-1	字节代换	异或当前列-nk
<span class="ln"> 3</span>73			8F	   		11 = 9E
<span class="ln"> 4</span>C0			BA			12 = A8
<span class="ln"> 5</span>B7			A9			13 = BA
<span class="ln"> 6</span>B4			8D			14 = 99
<span class="ln"> 7</span>第14列计算
<span class="ln"> 8</span>当前列-1	字节代换	异或当前列-nk
<span class="ln"> 9</span>FE			BB	   		9E = 25
<span class="ln">10</span>DB			B9			A8 = 11
<span class="ln">11</span>72			40			BA = FA
<span class="ln">12</span>6B			7F			99 = E6
<span class="ln">13</span>第1C列计算
<span class="ln">14</span>当前列-1	字节代换	异或当前列-nk
<span class="ln">15</span>C8			E8	   		25 = CD
<span class="ln">16</span>56			B1			11 = A0
<span class="ln">17</span>A4			49			FA = B3
<span class="ln">18</span>71			A3			E6 = 45
<span class="ln">19</span>第24列计算
<span class="ln">20</span>当前列-1	字节代换	异或当前列-nk
<span class="ln">21</span>D0			70	   		CD = BD
<span class="ln">22</span>ED			55			A0 = F5
<span class="ln">23</span>D4			48			B3 = FB
<span class="ln">24</span>DE			1D			45 = 58
<span class="ln">25</span>第2C列计算
<span class="ln">26</span>当前列-1	字节代换	异或当前列-nk
<span class="ln">27</span>D0			70	   		BD = CD
<span class="ln">28</span>9B			14			F5 = E1
<span class="ln">29</span>90			60			FB = 9B
<span class="ln">30</span>88			C4			58 = 9C
<span class="ln">31</span>第34列计算
<span class="ln">32</span>当前列-1	字节代换	异或当前列-nk
<span class="ln">33</span>3A			80	   		CD = 4D
<span class="ln">34</span>06			6F			E1 = 8E
<span class="ln">35</span>C4			1C			9B = 87
<span class="ln">36</span>7D			FF			9C = 63
</code></pre></div><h3 id="143情况3">1.4.3情况3</h3>
<p>情况3，不属于情况1和情况2的其余情况</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>公式：[当前列-nk值] ⊕ [当前列-1]
</code></pre></div><h4 id="1431aes128">1.4.3.1AES128</h4>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_18.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_18.png" >
  
    </a>
  
  
</div>

<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">  1</span>第05列计算
<span class="ln">  2</span>当前列-1	异或当前列-nk
<span class="ln">  3</span>AB			05 = AE
<span class="ln">  4</span>74			06 = 72
<span class="ln">  5</span>C9			07 = CE
<span class="ln">  6</span>D3			08 = DB
<span class="ln">  7</span>第06列计算
<span class="ln">  8</span>当前列-1	异或当前列-nk
<span class="ln">  9</span>AE			09 = A7
<span class="ln"> 10</span>72			0A = 78
<span class="ln"> 11</span>CE			0B = C5
<span class="ln"> 12</span>DB			0C = D7
<span class="ln"> 13</span>第07列计算
<span class="ln"> 14</span>当前列-1	异或当前列-nk
<span class="ln"> 15</span>A7			0D = AA
<span class="ln"> 16</span>78			0E = 76
<span class="ln"> 17</span>C5			0F = CA
<span class="ln"> 18</span>D7			10 = C7
<span class="ln"> 19</span>
<span class="ln"> 20</span>第09列计算
<span class="ln"> 21</span>当前列-1	异或当前列-nk
<span class="ln"> 22</span>91			AE = 3F
<span class="ln"> 23</span>00			72 = 72
<span class="ln"> 24</span>0F			CE = C1
<span class="ln"> 25</span>7F			DB = A4
<span class="ln"> 26</span>第0A列计算
<span class="ln"> 27</span>当前列-1	异或当前列-nk
<span class="ln"> 28</span>3F			A7 = 98
<span class="ln"> 29</span>72			78 = 0A
<span class="ln"> 30</span>C1			C5 = 04
<span class="ln"> 31</span>A4			D7 = 73
<span class="ln"> 32</span>第0B列计算
<span class="ln"> 33</span>当前列-1	异或当前列-nk
<span class="ln"> 34</span>98			AA = 32
<span class="ln"> 35</span>0A			76 = 7C
<span class="ln"> 36</span>04			CA = CE
<span class="ln"> 37</span>73			C7 = 84
<span class="ln"> 38</span>
<span class="ln"> 39</span>第0D列计算
<span class="ln"> 40</span>当前列-1	异或当前列-nk
<span class="ln"> 41</span>85			3F = BA
<span class="ln"> 42</span>8B			72 = F9
<span class="ln"> 43</span>82			C1 = 43
<span class="ln"> 44</span>5C			A4 = F8
<span class="ln"> 45</span>第0E列计算
<span class="ln"> 46</span>当前列-1	异或当前列-nk
<span class="ln"> 47</span>BA			98 = 22
<span class="ln"> 48</span>F9			0A = F3
<span class="ln"> 49</span>43			04 = 47
<span class="ln"> 50</span>F8			73 = 8B
<span class="ln"> 51</span>第0F列计算
<span class="ln"> 52</span>当前列-1	异或当前列-nk
<span class="ln"> 53</span>22			32 = 10
<span class="ln"> 54</span>F3			7C = 8F
<span class="ln"> 55</span>47			CE = 89
<span class="ln"> 56</span>8B			B4 = 3F
<span class="ln"> 57</span>
<span class="ln"> 58</span>第11列计算
<span class="ln"> 59</span>当前列-1	异或当前列-nk
<span class="ln"> 60</span>FE			BA = 44
<span class="ln"> 61</span>2C			F9 = D5
<span class="ln"> 62</span>F7			43 = B4
<span class="ln"> 63</span>96			F8 = 6E
<span class="ln"> 64</span>第12列计算
<span class="ln"> 65</span>当前列-1	异或当前列-nk
<span class="ln"> 66</span>44			22 = 66
<span class="ln"> 67</span>D5			F3 = 26
<span class="ln"> 68</span>B4			47 = F3
<span class="ln"> 69</span>6E			8B = E5
<span class="ln"> 70</span>第13列计算
<span class="ln"> 71</span>当前列-1	异或当前列-nk
<span class="ln"> 72</span>66			10 = 76
<span class="ln"> 73</span>26			8F = A9
<span class="ln"> 74</span>F3			89 = 7A
<span class="ln"> 75</span>E5			3F = DA
<span class="ln"> 76</span>
<span class="ln"> 77</span>第15列计算
<span class="ln"> 78</span>当前列-1	异或当前列-nk
<span class="ln"> 79</span>3D			44 = 79
<span class="ln"> 80</span>F6			D5 = 23
<span class="ln"> 81</span>A0			B4 = 14
<span class="ln"> 82</span>AE			6E = C0
<span class="ln"> 83</span>第16列计算
<span class="ln"> 84</span>当前列-1	异或当前列-nk
<span class="ln"> 85</span>79			66 = 1F
<span class="ln"> 86</span>23			26 = 05
<span class="ln"> 87</span>14			F3 = E7
<span class="ln"> 88</span>C0			E5 = 25
<span class="ln"> 89</span>第17列计算
<span class="ln"> 90</span>当前列-1	异或当前列-nk
<span class="ln"> 91</span>1F			76 = 69
<span class="ln"> 92</span>05			A9 = AC
<span class="ln"> 93</span>E7			7A = 9D
<span class="ln"> 94</span>25			DA = FF
<span class="ln"> 95</span>
<span class="ln"> 96</span>第19列计算
<span class="ln"> 97</span>当前列-1	异或当前列-nk
<span class="ln"> 98</span>8C			79 = F5
<span class="ln"> 99</span>A8			23 = 8B
<span class="ln">100</span>B6			14 = A2
<span class="ln">101</span>57			C0 = 97
<span class="ln">102</span>第1A列计算
<span class="ln">103</span>当前列-1	异或当前列-nk
<span class="ln">104</span>F5			1F = EA
<span class="ln">105</span>8B			05 = 8E
<span class="ln">106</span>A2			E7 = 45
<span class="ln">107</span>97			25 = B2
<span class="ln">108</span>第1B列计算
<span class="ln">109</span>当前列-1	异或当前列-nk
<span class="ln">110</span>EA			69 = 83
<span class="ln">111</span>8E			AC = 22
<span class="ln">112</span>45			9D = D8
<span class="ln">113</span>B2			FF = 4D
<span class="ln">114</span>
<span class="ln">115</span>第1D列计算
<span class="ln">116</span>当前列-1	异或当前列-nk
<span class="ln">117</span>5F			F5 = AA
<span class="ln">118</span>C9			8B = 42
<span class="ln">119</span>55			A2 = F7
<span class="ln">120</span>BB			97 = 2C
<span class="ln">121</span>第1E列计算
<span class="ln">122</span>当前列-1	异或当前列-nk
<span class="ln">123</span>AA			EA = 40
<span class="ln">124</span>42			8E = CC
<span class="ln">125</span>F7			45 = B2
<span class="ln">126</span>2C			B2 = 9E
<span class="ln">127</span>第1F列计算
<span class="ln">128</span>当前列-1	异或当前列-nk
<span class="ln">129</span>40			83 = C3
<span class="ln">130</span>CC			22 = EE
<span class="ln">131</span>B2			D8 = 6A
<span class="ln">132</span>9E			4D = D3
<span class="ln">133</span>
<span class="ln">134</span>第21列计算
<span class="ln">135</span>当前列-1	异或当前列-nk
<span class="ln">136</span>F7			AA = 5D
<span class="ln">137</span>CB			42 = 89
<span class="ln">138</span>33			F7 = C4
<span class="ln">139</span>95			2C = B9
<span class="ln">140</span>第22列计算
<span class="ln">141</span>当前列-1	异或当前列-nk
<span class="ln">142</span>5D			40 = 1D
<span class="ln">143</span>89			CC = 45
<span class="ln">144</span>C4			B2 = 76
<span class="ln">145</span>B9			9E = 27
<span class="ln">146</span>第23列计算
<span class="ln">147</span>当前列-1	异或当前列-nk
<span class="ln">148</span>1D			C3 = DE
<span class="ln">149</span>45			EE = AB
<span class="ln">150</span>76			6A = 1C
<span class="ln">151</span>27			D3 = F4
<span class="ln">152</span>
<span class="ln">153</span>第25列计算
<span class="ln">154</span>当前列-1	异或当前列-nk
<span class="ln">155</span>8E			5D = D3
<span class="ln">156</span>57			89 = DE
<span class="ln">157</span>8C			C4 = 48
<span class="ln">158</span>88			B9 = 31
<span class="ln">159</span>第26列计算
<span class="ln">160</span>当前列-1	异或当前列-nk
<span class="ln">161</span>D3			1D = CE
<span class="ln">162</span>DE			45 = 9B
<span class="ln">163</span>48			76 = 3E
<span class="ln">164</span>31			27 = 16
<span class="ln">165</span>第27列计算
<span class="ln">166</span>当前列-1	异或当前列-nk
<span class="ln">167</span>CE			DE = 10
<span class="ln">168</span>9B			AB = 30
<span class="ln">169</span>3E			1C = 22
<span class="ln">170</span>16			F4 = E2
<span class="ln">171</span>
<span class="ln">172</span>第29列计算
<span class="ln">173</span>当前列-1	异或当前列-nk
<span class="ln">174</span>BC			D3 = 6F
<span class="ln">175</span>C4			DE = 1A
<span class="ln">176</span>14			48 = 5C
<span class="ln">177</span>42			31 = 73
<span class="ln">178</span>第2A列计算
<span class="ln">179</span>当前列-1	异或当前列-nk
<span class="ln">180</span>6F			CE = A1
<span class="ln">181</span>1A			9B = 81
<span class="ln">182</span>5C			3E = 62
<span class="ln">183</span>73			16 = 65
<span class="ln">184</span>第2B列计算
<span class="ln">185</span>当前列-1	异或当前列-nk
<span class="ln">186</span>A1			10 = B1
<span class="ln">187</span>81			30 = B1
<span class="ln">188</span>62			22 = 40
<span class="ln">189</span>65			E2 = 87
</code></pre></div><h4 id="1432aes256">1.4.3.2AES256</h4>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_19.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_19.png" >
  
    </a>
  
  
</div>

<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">  1</span>第09列计算
<span class="ln">  2</span>当前列-1	异或当前列-nk
<span class="ln">  3</span>72			05 = 77
<span class="ln">  4</span>C2			06 = C4
<span class="ln">  5</span>B4			07 = B3
<span class="ln">  6</span>A0			08 = A8
<span class="ln">  7</span>第0A列计算
<span class="ln">  8</span>当前列-1	异或当前列-nk
<span class="ln">  9</span>77			09 = 7E
<span class="ln"> 10</span>C4			0A = CE
<span class="ln"> 11</span>B3			0B = B8
<span class="ln"> 12</span>A8			0C = A4
<span class="ln"> 13</span>第0B列计算
<span class="ln"> 14</span>当前列-1	异或当前列-nk
<span class="ln"> 15</span>7E			0D = 73
<span class="ln"> 16</span>CE			0E = C0
<span class="ln"> 17</span>B8			0F = B7
<span class="ln"> 18</span>A4			10 = B4
<span class="ln"> 19</span>
<span class="ln"> 20</span>第0D列计算
<span class="ln"> 21</span>当前列-1	异或当前列-nk
<span class="ln"> 22</span>9E			15 = 8B
<span class="ln"> 23</span>A8			16 = 8E
<span class="ln"> 24</span>BA			17 = AD
<span class="ln"> 25</span>99			18 = 81
<span class="ln"> 26</span>第0E列计算
<span class="ln"> 27</span>当前列-1	异或当前列-nk
<span class="ln"> 28</span>8B			19 = 92
<span class="ln"> 29</span>8E			1A = A4
<span class="ln"> 30</span>AD			1B = B6
<span class="ln"> 31</span>81			1C = 9D
<span class="ln"> 32</span>第0F列计算
<span class="ln"> 33</span>当前列-1	异或当前列-nk
<span class="ln"> 34</span>92			1D = 8F
<span class="ln"> 35</span>A4			1E = BA
<span class="ln"> 36</span>B6			1F = A9
<span class="ln"> 37</span>9D			20 = BD
<span class="ln"> 38</span>
<span class="ln"> 39</span>第11列计算
<span class="ln"> 40</span>当前列-1	异或当前列-nk
<span class="ln"> 41</span>84			77 = F3
<span class="ln"> 42</span>11			C4 = D5
<span class="ln"> 43</span>CE			B3 = 7D
<span class="ln"> 44</span>D3			A8 = 7B
<span class="ln"> 45</span>第12列计算
<span class="ln"> 46</span>当前列-1	异或当前列-nk
<span class="ln"> 47</span>F3			7E = 8D
<span class="ln"> 48</span>D5			CE = 1B
<span class="ln"> 49</span>7D			B8 = C5
<span class="ln"> 50</span>7B			A4 = DF
<span class="ln"> 51</span>第13列计算
<span class="ln"> 52</span>当前列-1	异或当前列-nk
<span class="ln"> 53</span>8D			73 = FE
<span class="ln"> 54</span>1B			70 = DB
<span class="ln"> 55</span>C5			B7 = 72
<span class="ln"> 56</span>DF			B4 = 6B
<span class="ln"> 57</span>
<span class="ln"> 58</span>第15列计算
<span class="ln"> 59</span>当前列-1	异或当前列-nk
<span class="ln"> 60</span>25			8B = AE
<span class="ln"> 61</span>11			8E = AF
<span class="ln"> 62</span>FA			AD = 57
<span class="ln"> 63</span>E6			81 = 67
<span class="ln"> 64</span>第16列计算
<span class="ln"> 65</span>当前列-1	异或当前列-nk
<span class="ln"> 66</span>AE			92 = 3C
<span class="ln"> 67</span>AF			A4 = 0B
<span class="ln"> 68</span>57			B6 = E1
<span class="ln"> 69</span>67			9D = FA
<span class="ln"> 70</span>第17列计算
<span class="ln"> 71</span>当前列-1	异或当前列-nk
<span class="ln"> 72</span>3C			8F = B3
<span class="ln"> 73</span>0B			BA = B1
<span class="ln"> 74</span>E1			A9 = 48
<span class="ln"> 75</span>FA			BD = 47
<span class="ln"> 76</span>
<span class="ln"> 77</span>第19列计算
<span class="ln"> 78</span>当前列-1	异或当前列-nk
<span class="ln"> 79</span>48			F3 = BB
<span class="ln"> 80</span>43			D5 = 96
<span class="ln"> 81</span>6E			7D = 13
<span class="ln"> 82</span>BE			7B = C5
<span class="ln"> 83</span>第1A列计算
<span class="ln"> 84</span>当前列-1	异或当前列-nk
<span class="ln"> 85</span>BB			8D = 36
<span class="ln"> 86</span>96			1B = 8D
<span class="ln"> 87</span>13			C5 = D6
<span class="ln"> 88</span>C5			DF = 1A
<span class="ln"> 89</span>第1B列计算
<span class="ln"> 90</span>当前列-1	异或当前列-nk
<span class="ln"> 91</span>36			FE = C8
<span class="ln"> 92</span>8D			DB = 56
<span class="ln"> 93</span>D6			72 = A4
<span class="ln"> 94</span>1A			6B = 71
<span class="ln"> 95</span>
<span class="ln"> 96</span>第1D列计算
<span class="ln"> 97</span>当前列-1	异或当前列-nk
<span class="ln"> 98</span>CD			AE = 63
<span class="ln"> 99</span>A0			AF = 0F
<span class="ln">100</span>B3			57 = E4
<span class="ln">101</span>45			67 = 22
<span class="ln">102</span>第1E列计算
<span class="ln">103</span>当前列-1	异或当前列-nk
<span class="ln">104</span>63			3C = 5F
<span class="ln">105</span>0F			0B = 04
<span class="ln">106</span>E4			E1 = 05
<span class="ln">107</span>22			FA = D8
<span class="ln">108</span>第1F列计算
<span class="ln">109</span>当前列-1	异或当前列-nk
<span class="ln">110</span>5F			B3 = EC
<span class="ln">111</span>04			B1 = B5
<span class="ln">112</span>05			48 = 4D
<span class="ln">113</span>D8			47 = 9F
<span class="ln">114</span>
<span class="ln">115</span>第21列计算
<span class="ln">116</span>当前列-1	异或当前列-nk
<span class="ln">117</span>95			BB = 2E
<span class="ln">118</span>A0			96 = 36
<span class="ln">119</span>B5			13 = A6
<span class="ln">120</span>70			C5 = B5
<span class="ln">121</span>第22列计算
<span class="ln">122</span>当前列-1	异或当前列-nk
<span class="ln">123</span>2E			36 = 18
<span class="ln">124</span>36			8D = BB
<span class="ln">125</span>A6			D6 = 70
<span class="ln">126</span>B5			1A = AF
<span class="ln">127</span>第23列计算
<span class="ln">128</span>当前列-1	异或当前列-nk
<span class="ln">129</span>18			C8 = D0
<span class="ln">130</span>BB			56 = ED
<span class="ln">131</span>70			A4 = D4
<span class="ln">132</span>AF			71 = DE
<span class="ln">133</span>
<span class="ln">134</span>第25列计算
<span class="ln">135</span>当前列-1	异或当前列-nk
<span class="ln">136</span>BD			63 = DE
<span class="ln">137</span>F5			0F = FA
<span class="ln">138</span>FB			E4 = 1F
<span class="ln">139</span>58			22 = 7A
<span class="ln">140</span>第26列计算
<span class="ln">141</span>当前列-1	异或当前列-nk
<span class="ln">142</span>DE			5F = 81
<span class="ln">143</span>FA			04 = FE
<span class="ln">144</span>1F			05 = 1A
<span class="ln">145</span>7A			DB = A2
<span class="ln">146</span>第27列计算
<span class="ln">147</span>当前列-1	异或当前列-nk
<span class="ln">148</span>81			EC = 6D
<span class="ln">149</span>FE			B5 = 4B
<span class="ln">150</span>1A			4D = 57
<span class="ln">151</span>A2			9F = 3D
<span class="ln">152</span>
<span class="ln">153</span>第29列计算
<span class="ln">154</span>当前列-1	异或当前列-nk
<span class="ln">155</span>36			2E = 18
<span class="ln">156</span>FB			36 = CD
<span class="ln">157</span>92			A6 = 34
<span class="ln">158</span>4C			B5 = F9
<span class="ln">159</span>第2A列计算
<span class="ln">160</span>当前列-1	异或当前列-nk
<span class="ln">161</span>18			18 = 00
<span class="ln">162</span>CD			BB = 76
<span class="ln">163</span>34			70 = 44
<span class="ln">164</span>F9			AF = 56
<span class="ln">165</span>第2B列计算
<span class="ln">166</span>当前列-1	异或当前列-nk
<span class="ln">167</span>00			D0 = D0
<span class="ln">168</span>76			ED = 9B
<span class="ln">169</span>44			D4 = 90
<span class="ln">170</span>56			DE = 88
<span class="ln">171</span>
<span class="ln">172</span>第2D列计算
<span class="ln">173</span>当前列-1	异或当前列-nk
<span class="ln">174</span>CD			DE = 13
<span class="ln">175</span>E1			FA = 1B
<span class="ln">176</span>9B			1F = 84
<span class="ln">177</span>9C			7A = E6
<span class="ln">178</span>第2E列计算
<span class="ln">179</span>当前列-1	异或当前列-nk
<span class="ln">180</span>13			81 = 92
<span class="ln">181</span>1B			FE = E5
<span class="ln">182</span>84			1A = 9E
<span class="ln">183</span>E6			A2 = 44
<span class="ln">184</span>第2F列计算
<span class="ln">185</span>当前列-1	异或当前列-nk
<span class="ln">186</span>92			6D = FF
<span class="ln">187</span>E5			4B = AE
<span class="ln">188</span>9E			57 = C9
<span class="ln">189</span>44			3D = 79
<span class="ln">190</span>
<span class="ln">191</span>第31列计算
<span class="ln">192</span>当前列-1	异或当前列-nk
<span class="ln">193</span>F2			18 = EA
<span class="ln">194</span>26			CD = EB
<span class="ln">195</span>24			34 = 10
<span class="ln">196</span>5A			F9 = A3
<span class="ln">197</span>第32列计算
<span class="ln">198</span>当前列-1	异或当前列-nk
<span class="ln">199</span>EA			00 = EA
<span class="ln">200</span>EB			76 = 9D
<span class="ln">201</span>10			44 = 54
<span class="ln">202</span>A3			56 = F5
<span class="ln">203</span>第33列计算
<span class="ln">204</span>当前列-1	异或当前列-nk
<span class="ln">205</span>EA			D0 = 3A
<span class="ln">206</span>9D			9B = 06
<span class="ln">207</span>54			90 = C4
<span class="ln">208</span>F5			88 = 7D
<span class="ln">209</span>
<span class="ln">210</span>第35列计算
<span class="ln">211</span>当前列-1	异或当前列-nk
<span class="ln">212</span>4D			13 = 5E
<span class="ln">213</span>8E			1B = 95
<span class="ln">214</span>87			84 = 03
<span class="ln">215</span>63			E6 = 85
<span class="ln">216</span>第36列计算
<span class="ln">217</span>当前列-1	异或当前列-nk
<span class="ln">218</span>5E			92 = CC
<span class="ln">219</span>95			E5 = 70
<span class="ln">220</span>03			9E = 9D
<span class="ln">221</span>85			44 = C1
<span class="ln">222</span>第37列计算
<span class="ln">223</span>当前列-1	异或当前列-nk
<span class="ln">224</span>CC			FF = 33
<span class="ln">225</span>70			AE = DE
<span class="ln">226</span>9D			C9 = 54
<span class="ln">227</span>C1			79 = B8
<span class="ln">228</span>
<span class="ln">229</span>第39列计算
<span class="ln">230</span>当前列-1	异或当前列-nk
<span class="ln">231</span>AF			EA = 45
<span class="ln">232</span>06			EB = ED
<span class="ln">233</span>48			10 = 58
<span class="ln">234</span>99			A3 = 3A
<span class="ln">235</span>第3A列计算
<span class="ln">236</span>当前列-1	异或当前列-nk
<span class="ln">237</span>45			EA = AF
<span class="ln">238</span>ED			9D = 70
<span class="ln">239</span>58			54 = 0C
<span class="ln">240</span>3A			F5 = CF
<span class="ln">241</span>第3B列计算
<span class="ln">242</span>当前列-1	异或当前列-nk
<span class="ln">243</span>AF			3A = 95
<span class="ln">244</span>70			06 = 76
<span class="ln">245</span>0C			C4 = C8
<span class="ln">246</span>CF			7D = B2
</code></pre></div><h2 id="15轮密钥加">1.5轮密钥加</h2>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_9.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_9.png" >
  
    </a>
  
  
</div>

<p>轮秘钥加有两个参数，分别为<strong>明文</strong>和<strong>轮秘钥</strong></p>
<p>对输入数组（16个字节）和轮秘钥的其中16个字节进行<code>异或运算</code>。</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_20.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_20.png" >
  
    </a>
  
  
</div>

<h3 id="151aes128">1.5.1AES128</h3>
<p>对于AES128而言，正好需要11次轮密钥加跟上述的秘钥拓展对应上了。</p>
<p>对于轮秘钥的选择</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_21.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_21.png" >
  
    </a>
  
  
</div>

<h3 id="152aes256">1.5.2AES256</h3>
<p>对于AES256而言，正好需要15次轮密钥加跟上述的秘钥拓展对应上了。</p>
<p>对于轮秘钥的选择</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_22.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_22.png" >
  
    </a>
  
  
</div>

<h1 id="16字节代换">1.6字节代换</h1>
<p>字节代换就是通过字节代换表来替换其中的字符数字</p>
<p>下面为字节代换表</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
<th style="text-align:center">6</th>
<th style="text-align:center">7</th>
<th style="text-align:center">8</th>
<th style="text-align:center">9</th>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
<th style="text-align:center">E</th>
<th style="text-align:center">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">63</td>
<td style="text-align:center">7C</td>
<td style="text-align:center">77</td>
<td style="text-align:center">7B</td>
<td style="text-align:center">F2</td>
<td style="text-align:center">6B</td>
<td style="text-align:center">6F</td>
<td style="text-align:center">C5</td>
<td style="text-align:center">30</td>
<td style="text-align:center">01</td>
<td style="text-align:center">67</td>
<td style="text-align:center">2B</td>
<td style="text-align:center">FE</td>
<td style="text-align:center">D7</td>
<td style="text-align:center">AB</td>
<td style="text-align:center">76</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">CA</td>
<td style="text-align:center">82</td>
<td style="text-align:center">C9</td>
<td style="text-align:center">7D</td>
<td style="text-align:center">FA</td>
<td style="text-align:center">59</td>
<td style="text-align:center">47</td>
<td style="text-align:center">F0</td>
<td style="text-align:center">AD</td>
<td style="text-align:center">D4</td>
<td style="text-align:center">A2</td>
<td style="text-align:center">AF</td>
<td style="text-align:center">9C</td>
<td style="text-align:center">A4</td>
<td style="text-align:center">72</td>
<td style="text-align:center">C0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">B7</td>
<td style="text-align:center">FD</td>
<td style="text-align:center">93</td>
<td style="text-align:center">26</td>
<td style="text-align:center">36</td>
<td style="text-align:center">3F</td>
<td style="text-align:center">F7</td>
<td style="text-align:center">CC</td>
<td style="text-align:center">34</td>
<td style="text-align:center">A5</td>
<td style="text-align:center">E5</td>
<td style="text-align:center">F1</td>
<td style="text-align:center">71</td>
<td style="text-align:center">D8</td>
<td style="text-align:center">31</td>
<td style="text-align:center">15</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">04</td>
<td style="text-align:center">C7</td>
<td style="text-align:center">23</td>
<td style="text-align:center">C3</td>
<td style="text-align:center">01</td>
<td style="text-align:center">96</td>
<td style="text-align:center">05</td>
<td style="text-align:center">9A</td>
<td style="text-align:center">07</td>
<td style="text-align:center">12</td>
<td style="text-align:center">80</td>
<td style="text-align:center">E2</td>
<td style="text-align:center">EB</td>
<td style="text-align:center">27</td>
<td style="text-align:center">B2</td>
<td style="text-align:center">75</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">09</td>
<td style="text-align:center">83</td>
<td style="text-align:center">2C</td>
<td style="text-align:center">1A</td>
<td style="text-align:center">1B</td>
<td style="text-align:center">6E</td>
<td style="text-align:center">5A</td>
<td style="text-align:center">A0</td>
<td style="text-align:center">52</td>
<td style="text-align:center">3B</td>
<td style="text-align:center">D6</td>
<td style="text-align:center">B3</td>
<td style="text-align:center">29</td>
<td style="text-align:center">E3</td>
<td style="text-align:center">2F</td>
<td style="text-align:center">84</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">53</td>
<td style="text-align:center">D1</td>
<td style="text-align:center">00</td>
<td style="text-align:center">ED</td>
<td style="text-align:center">20</td>
<td style="text-align:center">FC</td>
<td style="text-align:center">B1</td>
<td style="text-align:center">5B</td>
<td style="text-align:center">6A</td>
<td style="text-align:center">CB</td>
<td style="text-align:center">BE</td>
<td style="text-align:center">39</td>
<td style="text-align:center">4A</td>
<td style="text-align:center">4C</td>
<td style="text-align:center">58</td>
<td style="text-align:center">CF</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">D0</td>
<td style="text-align:center">EF</td>
<td style="text-align:center">AA</td>
<td style="text-align:center">FB</td>
<td style="text-align:center">43</td>
<td style="text-align:center">4D</td>
<td style="text-align:center">33</td>
<td style="text-align:center">85</td>
<td style="text-align:center">45</td>
<td style="text-align:center">F9</td>
<td style="text-align:center">02</td>
<td style="text-align:center">7F</td>
<td style="text-align:center">50</td>
<td style="text-align:center">3C</td>
<td style="text-align:center">9F</td>
<td style="text-align:center">A8</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">51</td>
<td style="text-align:center">A3</td>
<td style="text-align:center">40</td>
<td style="text-align:center">8F</td>
<td style="text-align:center">92</td>
<td style="text-align:center">9D</td>
<td style="text-align:center">38</td>
<td style="text-align:center">F5</td>
<td style="text-align:center">BC</td>
<td style="text-align:center">B6</td>
<td style="text-align:center">DA</td>
<td style="text-align:center">21</td>
<td style="text-align:center">10</td>
<td style="text-align:center">FF</td>
<td style="text-align:center">F3</td>
<td style="text-align:center">D2</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">CD</td>
<td style="text-align:center">0C</td>
<td style="text-align:center">13</td>
<td style="text-align:center">EC</td>
<td style="text-align:center">5F</td>
<td style="text-align:center">97</td>
<td style="text-align:center">44</td>
<td style="text-align:center">17</td>
<td style="text-align:center">C4</td>
<td style="text-align:center">A7</td>
<td style="text-align:center">7E</td>
<td style="text-align:center">3D</td>
<td style="text-align:center">64</td>
<td style="text-align:center">5D</td>
<td style="text-align:center">19</td>
<td style="text-align:center">73</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">60</td>
<td style="text-align:center">81</td>
<td style="text-align:center">4F</td>
<td style="text-align:center">DC</td>
<td style="text-align:center">22</td>
<td style="text-align:center">2A</td>
<td style="text-align:center">90</td>
<td style="text-align:center">88</td>
<td style="text-align:center">46</td>
<td style="text-align:center">EE</td>
<td style="text-align:center">B8</td>
<td style="text-align:center">14</td>
<td style="text-align:center">DE</td>
<td style="text-align:center">5E</td>
<td style="text-align:center">0B</td>
<td style="text-align:center">DB</td>
</tr>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">E0</td>
<td style="text-align:center">32</td>
<td style="text-align:center">3A</td>
<td style="text-align:center">0A</td>
<td style="text-align:center">49</td>
<td style="text-align:center">06</td>
<td style="text-align:center">24</td>
<td style="text-align:center">5C</td>
<td style="text-align:center">C2</td>
<td style="text-align:center">D3</td>
<td style="text-align:center">AC</td>
<td style="text-align:center">62</td>
<td style="text-align:center">91</td>
<td style="text-align:center">95</td>
<td style="text-align:center">E4</td>
<td style="text-align:center">79</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">E7</td>
<td style="text-align:center">C8</td>
<td style="text-align:center">37</td>
<td style="text-align:center">6D</td>
<td style="text-align:center">8D</td>
<td style="text-align:center">D5</td>
<td style="text-align:center">4E</td>
<td style="text-align:center">A9</td>
<td style="text-align:center">6C</td>
<td style="text-align:center">56</td>
<td style="text-align:center">F4</td>
<td style="text-align:center">EA</td>
<td style="text-align:center">65</td>
<td style="text-align:center">7A</td>
<td style="text-align:center">AE</td>
<td style="text-align:center">08</td>
</tr>
<tr>
<td style="text-align:center">C</td>
<td style="text-align:center">BA</td>
<td style="text-align:center">78</td>
<td style="text-align:center">25</td>
<td style="text-align:center">2E</td>
<td style="text-align:center">1C</td>
<td style="text-align:center">A6</td>
<td style="text-align:center">B4</td>
<td style="text-align:center">C6</td>
<td style="text-align:center">E8</td>
<td style="text-align:center">DD</td>
<td style="text-align:center">74</td>
<td style="text-align:center">1F</td>
<td style="text-align:center">4B</td>
<td style="text-align:center">BD</td>
<td style="text-align:center">8B</td>
<td style="text-align:center">8A</td>
</tr>
<tr>
<td style="text-align:center">D</td>
<td style="text-align:center">70</td>
<td style="text-align:center">3E</td>
<td style="text-align:center">B5</td>
<td style="text-align:center">66</td>
<td style="text-align:center">48</td>
<td style="text-align:center">03</td>
<td style="text-align:center">F6</td>
<td style="text-align:center">0E</td>
<td style="text-align:center">61</td>
<td style="text-align:center">35</td>
<td style="text-align:center">57</td>
<td style="text-align:center">B9</td>
<td style="text-align:center">86</td>
<td style="text-align:center">C1</td>
<td style="text-align:center">1D</td>
<td style="text-align:center">9E</td>
</tr>
<tr>
<td style="text-align:center">E</td>
<td style="text-align:center">E1</td>
<td style="text-align:center">F8</td>
<td style="text-align:center">98</td>
<td style="text-align:center">11</td>
<td style="text-align:center">69</td>
<td style="text-align:center">D9</td>
<td style="text-align:center">8E</td>
<td style="text-align:center">94</td>
<td style="text-align:center">9B</td>
<td style="text-align:center">1E</td>
<td style="text-align:center">87</td>
<td style="text-align:center">E9</td>
<td style="text-align:center">CE</td>
<td style="text-align:center">55</td>
<td style="text-align:center">28</td>
<td style="text-align:center">DF</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">8C</td>
<td style="text-align:center">A1</td>
<td style="text-align:center">89</td>
<td style="text-align:center">0D</td>
<td style="text-align:center">BF</td>
<td style="text-align:center">E6</td>
<td style="text-align:center">42</td>
<td style="text-align:center">68</td>
<td style="text-align:center">41</td>
<td style="text-align:center">99</td>
<td style="text-align:center">2D</td>
<td style="text-align:center">0F</td>
<td style="text-align:center">B0</td>
<td style="text-align:center">54</td>
<td style="text-align:center">BB</td>
<td style="text-align:center">16</td>
</tr>
</tbody>
</table>
<p>举例说明</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_23.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_23.png" >
  
    </a>
  
  
</div>

<h2 id="17行位移">1.7行位移</h2>
<p>行位移规则</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>第一行不变
<span class="ln">2</span>第二行向左循环移动1字节
<span class="ln">3</span>第三行向做循环移动2字节
<span class="ln">4</span>第四行向左循环移动3字节
</code></pre></div><p>举例说明</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_24.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_24.png" >
  
    </a>
  
  
</div>

<h2 id="18列混淆">1.8列混淆</h2>
<p>列混淆是加密过程中最复杂的一块</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>公式：使用GF(2^8)对[列混淆左乘矩阵的行]与[当前字节的列]进行矩阵乘法
</code></pre></div><p>举例说明</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_25.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_25.png" >
  
    </a>
  
  
</div>

<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>上述计算
<span class="ln">2</span>[x1,y1] = 0x02 × [x1,y1] ⊕ 0x03 × [x2,y1] ⊕ 0x01 × [x3,y1] ⊕ 0x01 × [x4,y1]
<span class="ln">3</span>[x2,y1] = 0x01 × [x1,y1] ⊕ 0x02 × [x2,y1] ⊕ 0x03 × [x3,y1] ⊕ 0x01 × [x4,y1]
<span class="ln">4</span>[x3,y3] = 0x01 × [x1,y3] ⊕ 0x01 × [x2,y3] ⊕ 0x02 × [x3,y3] ⊕ 0x03 × [x4,y3]
<span class="ln">5</span>[x1,y1] = 0x01 × [x1,y4] ⊕ 0x01 × [x2,y4] ⊕ 0x02 × [x3,y4] ⊕ 0x03 × [x4,y4]
</code></pre></div><blockquote>
<p>在GF(2^8)中<strong>加法和乘法</strong>是不一样的</p>
<p>1.加法操作</p>
<p>直接改成<strong>异或操作</strong>，a+b 等效为 a ⊕ b</p>
<p>2.乘法操作</p>
<p>2.1.定义一个函数f(a)</p>
<p>​	如果a小于0x80，则返回2*a</p>
<p>​	否则返货((2*a)mod 0x100) ⊕ 0x1B</p>
<p>2.2乘法操作中的其中一个数值是2的N次方，则可以套用以下公式</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="ln">1</span><span class="mh">0x01</span> <span class="err">×</span> <span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
<span class="ln">2</span><span class="mh">0x02</span> <span class="err">×</span> <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="ln">3</span><span class="mh">0x04</span> <span class="err">×</span> <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mh">0x02</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span>
<span class="ln">4</span><span class="mh">0x08</span> <span class="err">×</span> <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mh">0x04</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span>
<span class="ln">5</span><span class="mh">0x10</span> <span class="err">×</span> <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mh">0x08</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span>
<span class="ln">6</span><span class="p">...</span>
</code></pre></div><p>2.3.非2的次方可以拆分后相加（这里的相加操作依然为异或操作）</p>
<p>例子</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="ln">1</span><span class="mh">0x0D</span> <span class="err">×</span> <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0x08</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span> <span class="err">⊕</span> <span class="p">(</span><span class="mh">0x04</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span> <span class="err">⊕</span> <span class="p">(</span><span class="mh">0x01</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mh">0x04</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span><span class="err">⊕</span> <span class="n">f</span><span class="p">(</span><span class="mh">0x02</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span><span class="err">⊕</span> <span class="n">a</span>
<span class="ln">2</span><span class="mh">0x0D</span> <span class="err">×</span> <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0x08</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span> <span class="err">⊕</span> <span class="p">(</span><span class="mh">0x04</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span> <span class="err">⊕</span> <span class="p">(</span><span class="mh">0x02</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mh">0x04</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span><span class="err">⊕</span> <span class="n">f</span><span class="p">(</span><span class="mh">0x02</span> <span class="err">×</span> <span class="n">a</span><span class="p">)</span><span class="err">⊕</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</code></pre></div></blockquote>
<p>直接计算实际例子</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln"> 1</span>以前面例子中的[x3,y1]为例
<span class="ln"> 2</span>[x3,y1] = 0x01 × [x1,y1] ⊕ 0x01 × [x2,y1] ⊕ 0x02 × [x3,y1] ⊕ 0x03 × [x4,y1]
<span class="ln"> 3</span>= 0x01 × 0x3B ⊕ 0x01 × 0xF7 ⊕ 0x02 × 0xA8 ⊕ 0x03 × 0xB7
<span class="ln"> 4</span>0x01 × 0x3B = 0x3B
<span class="ln"> 5</span>0x01 × 0xF7 = 0xF7
<span class="ln"> 6</span>0x02 × 0xA8 = f(0xA8) = ((2*0xA8)mod 0x100) ⊕ 0x1B = 0x50 ⊕ 0x1B = 0x4B
<span class="ln"> 7</span>0x03 × 0xB7 = f(0xB7) ⊕ 0xB7 = ((2*0xB7)mod 0x100) ⊕ 0x1B ⊕ 0xB7 = 0x75 ⊕ 0xB7 = 0xC2
<span class="ln"> 8</span>[x3,y1] = 0x3B ⊕ 0xF7 ⊕ 0x4B ⊕ 0xC2 = 0x45
<span class="ln"> 9</span>再举例[x2,y4]
<span class="ln">10</span>[x2,y4] = 0x01 × [x1,y4] ⊕ 0x02 × [x2,y4] ⊕ 0x03 × [x3,y4] ⊕ 0x01 × [x4,y4]
<span class="ln">11</span>= 0x01 × 0x27 ⊕ 0x02 × 0x85 ⊕ 0x03 × 0x53 ⊕ 0x01 × 0xD8
<span class="ln">12</span>0x01 × 0x27 = 0x27
<span class="ln">13</span>0x02 × 0x85 = f(0x85) = ((2*0x85)mod 0x100) ⊕ 0x1B = A ⊕ 0x1B = 0x11
<span class="ln">14</span>0x03 × 0x53 = f(0x53) ⊕ 0x53 = (2*0x53) ⊕ 0x53 = A6 ⊕ 0x53 = 0xF5
<span class="ln">15</span>0x01 × 0xD8 = 0xD8
<span class="ln">16</span>[x2,y4] = 0x27 ⊕ 0x11 ⊕ 0xF5 ⊕ 0xD8 = 1B
</code></pre></div><h2 id="19加密演示">1.9加密演示</h2>
<p>在线AES加减密链接(<a href="https://the-x.cn/cryptography/Aes.aspx">https://the-x.cn/cryptography/Aes.aspx</a>)</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_3.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_3.png" >
  
    </a>
  
  
</div>

<p>这里的明文是Hello World!，补充为0</p>
<p>密文是Password，补充为0</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_2.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_2.png" >
  
    </a>
  
  
</div>

<h3 id="191秘钥扩展">1.9.1秘钥扩展</h3>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_26.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_26.png" >
  
    </a>
  
  
</div>

<h3 id="192加密">1.9.2加密</h3>
<h4 id="1921第0轮">1.9.2.1第0轮</h4>
<p>第0轮只有轮密钥加</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_32.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_32.png" >
  
    </a>
  
  
</div>

<p>第一轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_33.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_33.png" >
  
    </a>
  
  
</div>

<p>第二轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_34.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_34.png" >
  
    </a>
  
  
</div>

<p>第三轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_35.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_35.png" >
  
    </a>
  
  
</div>

<p>第四轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_36.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_36.png" >
  
    </a>
  
  
</div>

<p>第五轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_37.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_37.png" >
  
    </a>
  
  
</div>

<p>第六轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_38.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_38.png" >
  
    </a>
  
  
</div>

<p>第七轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_39.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_39.png" >
  
    </a>
  
  
</div>

<p>第八轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_40.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_40.png" >
  
    </a>
  
  
</div>

<p>第九轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_41.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_41.png" >
  
    </a>
  
  
</div>

<p>第十轮（没有列混淆）</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_42.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_42.png" >
  
    </a>
  
  
</div>

<h1 id="2解密">2解密</h1>
<p>解密和加密的区别只在于</p>
<ul>
<li>执行顺序相反</li>
<li>字节代换的表不一样</li>
<li>行位移由加密的向左移动改成解密的向右移动</li>
<li>列混淆的左乘数组不一样</li>
</ul>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_27.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_27.png" >
  
    </a>
  
  
</div>

<p>里面的解密器流程如下</p>
<p>和加密的流程正好相反</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_28.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_28.png" >
  
    </a>
  
  
</div>

<h2 id="21解密的字节代换表">2.1解密的字节代换表</h2>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
<th style="text-align:center">6</th>
<th style="text-align:center">7</th>
<th style="text-align:center">8</th>
<th style="text-align:center">9</th>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
<th style="text-align:center">E</th>
<th style="text-align:center">F</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">52</td>
<td style="text-align:center">09</td>
<td style="text-align:center">6A</td>
<td style="text-align:center">D5</td>
<td style="text-align:center">30</td>
<td style="text-align:center">36</td>
<td style="text-align:center">A5</td>
<td style="text-align:center">38</td>
<td style="text-align:center">BF</td>
<td style="text-align:center">40</td>
<td style="text-align:center">A3</td>
<td style="text-align:center">9E</td>
<td style="text-align:center">81</td>
<td style="text-align:center">F3</td>
<td style="text-align:center">D7</td>
<td style="text-align:center">FB</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">7C</td>
<td style="text-align:center">E3</td>
<td style="text-align:center">39</td>
<td style="text-align:center">82</td>
<td style="text-align:center">9B</td>
<td style="text-align:center">2F</td>
<td style="text-align:center">FF</td>
<td style="text-align:center">87</td>
<td style="text-align:center">34</td>
<td style="text-align:center">8E</td>
<td style="text-align:center">43</td>
<td style="text-align:center">44</td>
<td style="text-align:center">C4</td>
<td style="text-align:center">DE</td>
<td style="text-align:center">E9</td>
<td style="text-align:center">CB</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">54</td>
<td style="text-align:center">7B</td>
<td style="text-align:center">94</td>
<td style="text-align:center">32</td>
<td style="text-align:center">A6</td>
<td style="text-align:center">C2</td>
<td style="text-align:center">23</td>
<td style="text-align:center">3D</td>
<td style="text-align:center">EE</td>
<td style="text-align:center">4C</td>
<td style="text-align:center">95</td>
<td style="text-align:center">0B</td>
<td style="text-align:center">42</td>
<td style="text-align:center">FA</td>
<td style="text-align:center">C3</td>
<td style="text-align:center">4E</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">08</td>
<td style="text-align:center">2E</td>
<td style="text-align:center">A1</td>
<td style="text-align:center">66</td>
<td style="text-align:center">28</td>
<td style="text-align:center">D9</td>
<td style="text-align:center">24</td>
<td style="text-align:center">B2</td>
<td style="text-align:center">76</td>
<td style="text-align:center">5B</td>
<td style="text-align:center">A2</td>
<td style="text-align:center">49</td>
<td style="text-align:center">6D</td>
<td style="text-align:center">8B</td>
<td style="text-align:center">D1</td>
<td style="text-align:center">25</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">72</td>
<td style="text-align:center">F8</td>
<td style="text-align:center">F6</td>
<td style="text-align:center">64</td>
<td style="text-align:center">86</td>
<td style="text-align:center">68</td>
<td style="text-align:center">98</td>
<td style="text-align:center">16</td>
<td style="text-align:center">D4</td>
<td style="text-align:center">A4</td>
<td style="text-align:center">5C</td>
<td style="text-align:center">CC</td>
<td style="text-align:center">5D</td>
<td style="text-align:center">65</td>
<td style="text-align:center">B6</td>
<td style="text-align:center">92</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">6C</td>
<td style="text-align:center">70</td>
<td style="text-align:center">48</td>
<td style="text-align:center">50</td>
<td style="text-align:center">FD</td>
<td style="text-align:center">ED</td>
<td style="text-align:center">B9</td>
<td style="text-align:center">DA</td>
<td style="text-align:center">5E</td>
<td style="text-align:center">15</td>
<td style="text-align:center">46</td>
<td style="text-align:center">57</td>
<td style="text-align:center">A7</td>
<td style="text-align:center">8D</td>
<td style="text-align:center">9D</td>
<td style="text-align:center">84</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">90</td>
<td style="text-align:center">D8</td>
<td style="text-align:center">AB</td>
<td style="text-align:center">00</td>
<td style="text-align:center">8C</td>
<td style="text-align:center">BC</td>
<td style="text-align:center">D3</td>
<td style="text-align:center">0A</td>
<td style="text-align:center">F7</td>
<td style="text-align:center">E4</td>
<td style="text-align:center">58</td>
<td style="text-align:center">05</td>
<td style="text-align:center">B8</td>
<td style="text-align:center">B3</td>
<td style="text-align:center">45</td>
<td style="text-align:center">06</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">D0</td>
<td style="text-align:center">2C</td>
<td style="text-align:center">1E</td>
<td style="text-align:center">8F</td>
<td style="text-align:center">CA</td>
<td style="text-align:center">3F</td>
<td style="text-align:center">0F</td>
<td style="text-align:center">02</td>
<td style="text-align:center">C1</td>
<td style="text-align:center">AF</td>
<td style="text-align:center">BD</td>
<td style="text-align:center">03</td>
<td style="text-align:center">01</td>
<td style="text-align:center">13</td>
<td style="text-align:center">8A</td>
<td style="text-align:center">6B</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">3A</td>
<td style="text-align:center">91</td>
<td style="text-align:center">11</td>
<td style="text-align:center">41</td>
<td style="text-align:center">4F</td>
<td style="text-align:center">67</td>
<td style="text-align:center">DC</td>
<td style="text-align:center">EA</td>
<td style="text-align:center">97</td>
<td style="text-align:center">F2</td>
<td style="text-align:center">CF</td>
<td style="text-align:center">CE</td>
<td style="text-align:center">F0</td>
<td style="text-align:center">B4</td>
<td style="text-align:center">E6</td>
<td style="text-align:center">73</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">96</td>
<td style="text-align:center">AC</td>
<td style="text-align:center">74</td>
<td style="text-align:center">22</td>
<td style="text-align:center">E7</td>
<td style="text-align:center">AD</td>
<td style="text-align:center">35</td>
<td style="text-align:center">85</td>
<td style="text-align:center">E2</td>
<td style="text-align:center">F9</td>
<td style="text-align:center">37</td>
<td style="text-align:center">E8</td>
<td style="text-align:center">1C</td>
<td style="text-align:center">75</td>
<td style="text-align:center">DF</td>
<td style="text-align:center">6E</td>
</tr>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">47</td>
<td style="text-align:center">F1</td>
<td style="text-align:center">1A</td>
<td style="text-align:center">71</td>
<td style="text-align:center">1D</td>
<td style="text-align:center">29</td>
<td style="text-align:center">C5</td>
<td style="text-align:center">89</td>
<td style="text-align:center">6F</td>
<td style="text-align:center">B7</td>
<td style="text-align:center">62</td>
<td style="text-align:center">0E</td>
<td style="text-align:center">AA</td>
<td style="text-align:center">18</td>
<td style="text-align:center">BE</td>
<td style="text-align:center">1B</td>
</tr>
<tr>
<td style="text-align:center">B</td>
<td style="text-align:center">FC</td>
<td style="text-align:center">56</td>
<td style="text-align:center">3E</td>
<td style="text-align:center">4B</td>
<td style="text-align:center">C6</td>
<td style="text-align:center">D2</td>
<td style="text-align:center">79</td>
<td style="text-align:center">20</td>
<td style="text-align:center">9A</td>
<td style="text-align:center">DB</td>
<td style="text-align:center">C0</td>
<td style="text-align:center">FE</td>
<td style="text-align:center">78</td>
<td style="text-align:center">CD</td>
<td style="text-align:center">5A</td>
<td style="text-align:center">F4</td>
</tr>
<tr>
<td style="text-align:center">C</td>
<td style="text-align:center">1F</td>
<td style="text-align:center">DD</td>
<td style="text-align:center">A8</td>
<td style="text-align:center">33</td>
<td style="text-align:center">88</td>
<td style="text-align:center">07</td>
<td style="text-align:center">C7</td>
<td style="text-align:center">31</td>
<td style="text-align:center">B1</td>
<td style="text-align:center">12</td>
<td style="text-align:center">10</td>
<td style="text-align:center">59</td>
<td style="text-align:center">27</td>
<td style="text-align:center">80</td>
<td style="text-align:center">EC</td>
<td style="text-align:center">5F</td>
</tr>
<tr>
<td style="text-align:center">D</td>
<td style="text-align:center">60</td>
<td style="text-align:center">51</td>
<td style="text-align:center">7F</td>
<td style="text-align:center">A9</td>
<td style="text-align:center">19</td>
<td style="text-align:center">B5</td>
<td style="text-align:center">4A</td>
<td style="text-align:center">0D</td>
<td style="text-align:center">2D</td>
<td style="text-align:center">E5</td>
<td style="text-align:center">7A</td>
<td style="text-align:center">9F</td>
<td style="text-align:center">93</td>
<td style="text-align:center">C9</td>
<td style="text-align:center">9C</td>
<td style="text-align:center">EF</td>
</tr>
<tr>
<td style="text-align:center">E</td>
<td style="text-align:center">A0</td>
<td style="text-align:center">E0</td>
<td style="text-align:center">3B</td>
<td style="text-align:center">4D</td>
<td style="text-align:center">AE</td>
<td style="text-align:center">2A</td>
<td style="text-align:center">F5</td>
<td style="text-align:center">B0</td>
<td style="text-align:center">C8</td>
<td style="text-align:center">EB</td>
<td style="text-align:center">BB</td>
<td style="text-align:center">3C</td>
<td style="text-align:center">83</td>
<td style="text-align:center">53</td>
<td style="text-align:center">99</td>
<td style="text-align:center">61</td>
</tr>
<tr>
<td style="text-align:center">F</td>
<td style="text-align:center">17</td>
<td style="text-align:center">2B</td>
<td style="text-align:center">04</td>
<td style="text-align:center">7E</td>
<td style="text-align:center">BA</td>
<td style="text-align:center">77</td>
<td style="text-align:center">D6</td>
<td style="text-align:center">26</td>
<td style="text-align:center">E1</td>
<td style="text-align:center">69</td>
<td style="text-align:center">14</td>
<td style="text-align:center">63</td>
<td style="text-align:center">55</td>
<td style="text-align:center">21</td>
<td style="text-align:center">0C</td>
<td style="text-align:center">7D</td>
</tr>
</tbody>
</table>
<h2 id="22解密逆行位移">2.2解密逆行位移</h2>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>流程说明
<span class="ln">2</span>第一行不变
<span class="ln">3</span>第二行向右循环移动1字节
<span class="ln">4</span>第三行向右循环移动2字节
<span class="ln">5</span>第四行向右循环移动3字节
</code></pre></div><p>举例说明</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_29.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_29.png" >
  
    </a>
  
  
</div>

<h2 id="23解密列混淆左乘矩阵">2.3解密列混淆左乘矩阵</h2>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_30.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_30.png" >
  
    </a>
  
  
</div>

<h2 id="24具体步骤">2.4具体步骤</h2>
<p>这里的轮秘钥的顺序跟解密是相反的，解密第一轮的轮秘钥正好对应加密过程的最后一次的轮秘钥。</p>
<p>第一轮（<strong>没有逆列混淆</strong>）</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_43.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_43.png" >
  
    </a>
  
  
</div>

<p>第二轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_44.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_44.png" >
  
    </a>
  
  
</div>

<p>第三轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_45.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_45.png" >
  
    </a>
  
  
</div>

<p>第四轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_46.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_46.png" >
  
    </a>
  
  
</div>

<p>第五轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_47.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_47.png" >
  
    </a>
  
  
</div>

<p>第六轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_48.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_48.png" >
  
    </a>
  
  
</div>

<p>第七轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_49.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_49.png" >
  
    </a>
  
  
</div>

<p>第八轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_50.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_50.png" >
  
    </a>
  
  
</div>

<p>第九轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_51.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_51.png" >
  
    </a>
  
  
</div>

<p>第十轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_52.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_52.png" >
  
    </a>
  
  
</div>

<p>第0轮</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_53.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_53.png" >
  
    </a>
  
  
</div>

<h1 id="3补充说明">3补充说明</h1>
<p>总的来说，上面的例子说加密模式为ecb、填充模式为数字0（0x30）的AES128，对16字节的明文字符串通过秘钥是16个字节进行加密和解密操作流程。</p>
<p>除了上述的ecb模式，还有cbc加密模式。</p>
<h2 id="31cbc加密模式">3.1CBC加密模式</h2>
<p>cbc模式多一个16字节<strong>初始向量</strong>(<code>iv</code>)参数</p>
<p>加密流程</p>
<ul>
<li>第一次进入加密器之前，先试用iv对明文分组1进行异或运算</li>
<li>字后进入加密器之前，使用上一次加密的密文分组对明文分组进行异或运算</li>
</ul>
<p>举例说明</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>iv   ⊕ 明文分组1 -&gt; 加密器 -&gt; 密文1
<span class="ln">2</span>密文1 ⊕ 明文分组2 -&gt; 加密器 -&gt; 密文2
<span class="ln">3</span>密文2 ⊕ 明文分组3 -&gt; 加密器 -&gt; 密文3
</code></pre></div><p>解密流程</p>
<ul>
<li>第一次进入解密器之后，先试用当前密文组的前面那块密文组队当前密文组进行异或运算</li>
<li>最后一次进入解密器之后用iv对当前密文组进行异或运算</li>
</ul>
<p>举例说明</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln">1</span>密文3 -&gt; 解密器 -&gt; ⊕ 密文2 -&gt; 明文3
<span class="ln">2</span>密文2 -&gt; 解密器 -&gt; ⊕ 密文1 -&gt; 明文2
<span class="ln">3</span>密文1 -&gt; 解密器 -&gt; ⊕ iv   -&gt; 明文1
</code></pre></div>

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_31.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_31.png" >
  
    </a>
  
  
</div>

<h2 id="32base64编码解码">3.2base64编码解码</h2>
<p>Base64算法生成的字符串可以安全地在任何实现了Base64算法的计算机之间传输。Base64典型的用途是给二进制数据（例如：图片文件）进行编码的，我们为了简化，就不用二进制，而是使用一段ASCII文本字符串来作为例子进行讲解。Base64编码出来的数据只会包含最多64种不同的ASCII字符，因此，使用Base64算法，我们就能避免数据在部分系统传输过程中发生改变。</p>
<h3 id="321生成base64索引表">3.2.1生成Base64索引表</h3>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_54.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_54.png" >
  
    </a>
  
  
</div>

<h3 id="322加密方式">3.2.2加密方式</h3>
<p>首先，我们发现字符串<code>“Man”</code>的Base64编码是<code>“TWFu”</code>，那么这是怎么转换过来的呢？不急，我们一个一个字符来分析，首先对于<code>“M”</code>来说，<code>&quot;M&quot;</code>对应的ASCII编码是<code>77</code>，二进制形式即<code>01001101</code>；同理，字符<code>“a”</code>对应的ASCII编码是<code>97</code>，二进制表现形式为<code>01100001</code>；<code>“n”</code>的ASCII编码为<code>110</code>，二进制形式为：<code>01101110</code>。（ASCII编码表可参考：ASCII码对照表）这三个字符的二进制位组合在一起就变成了一个24位的字符串<code>“010011010110000101101110”</code>，接下来，我们从左至右，每次抽取6位作为1组（因为6位一共有2^6=64种不同的组合），因此每一组的6位又代表一个数字（0~63），接下来，我们查看索引表，找到这个数字对应的字符，就是我们最后的结果，是不是很简单呢？</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_57.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_57.png" >
  
    </a>
  
  
</div>

<h3 id="323举例说明">3.2.3举例说明</h3>
<p>上面的AES128的时候，有BASE64的字符串<code>62uCg0QGx/SVxr1iML8iig==</code>，使用BASE64解码</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_55.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_55.png" >
  
    </a>
  
  
</div>

<p>发现这些解码出来的正好拼接成4*4的AES128加密后的原始的矩阵</p>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/cryptography/aes/aes_56.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/cryptography/aes/aes_56.png" >
  
    </a>
  
  
</div>

<h1 id="4程序demo">4程序demo</h1>
<p>另外对于AES而言，代码层面也有对应的写法，这里不具体列出只列出对应的算法demo</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="ln"> 1</span><span class="c1">//aes.h
</span><span class="ln"> 2</span><span class="c1"></span><span class="cp">#ifndef AES_H
</span><span class="ln"> 3</span><span class="cp">#define AES_H
</span><span class="ln"> 4</span><span class="cp"></span>
<span class="ln"> 5</span><span class="cm">/**
</span><span class="ln"> 6</span><span class="cm"> * 参数 p: 明文的字符串数组。
</span><span class="ln"> 7</span><span class="cm"> * 参数 plen: 明文的长度,长度必须为16的倍数。
</span><span class="ln"> 8</span><span class="cm"> * 参数 key: 密钥的字符串数组。
</span><span class="ln"> 9</span><span class="cm"> */</span>
<span class="ln">10</span><span class="kt">void</span> <span class="nf">aes</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">plen</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="ln">11</span>
<span class="ln">12</span><span class="cm">/**
</span><span class="ln">13</span><span class="cm"> * 参数 c: 密文的字符串数组。
</span><span class="ln">14</span><span class="cm"> * 参数 clen: 密文的长度,长度必须为16的倍数。
</span><span class="ln">15</span><span class="cm"> * 参数 key: 密钥的字符串数组。
</span><span class="ln">16</span><span class="cm"> */</span>
<span class="ln">17</span><span class="kt">void</span> <span class="nf">deAes</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">clen</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="ln">18</span>
<span class="ln">19</span><span class="cp">#endif
</span></code></pre></div><p>具体实现</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="ln">  1</span><span class="c1">//aes.c
</span><span class="ln">  2</span><span class="c1"></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="ln">  3</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="ln">  4</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="ln">  5</span><span class="cp">#include</span> <span class="cpf">&#34;aes.h&#34;</span><span class="cp">
</span><span class="ln">  6</span><span class="cp"></span>
<span class="ln">  7</span><span class="cm">/**
</span><span class="ln">  8</span><span class="cm"> * S盒
</span><span class="ln">  9</span><span class="cm"> */</span>
<span class="ln"> 10</span><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">S</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> 
<span class="ln"> 11</span>    <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x7c</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span>
<span class="ln"> 12</span>	<span class="mh">0xca</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0xa2</span><span class="p">,</span> <span class="mh">0xaf</span><span class="p">,</span> <span class="mh">0x9c</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span>
<span class="ln"> 13</span>	<span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span>
<span class="ln"> 14</span>	<span class="mh">0x04</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span>
<span class="ln"> 15</span>	<span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span>
<span class="ln"> 16</span>	<span class="mh">0x53</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x4a</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span>
<span class="ln"> 17</span>	<span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0xfb</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span>
<span class="ln"> 18</span>	<span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x9d</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span>
<span class="ln"> 19</span>	<span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0xa7</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span>
<span class="ln"> 20</span>	<span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x4f</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span>
<span class="ln"> 21</span>	<span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0xc2</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span>
<span class="ln"> 22</span>	<span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
<span class="ln"> 23</span>	<span class="mh">0xba</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span>
<span class="ln"> 24</span>	<span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span>
<span class="ln"> 25</span>	<span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x9b</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span>
<span class="ln"> 26</span>	<span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0x16</span> 
<span class="ln"> 27</span><span class="p">};</span>
<span class="ln"> 28</span>
<span class="ln"> 29</span><span class="cm">/**
</span><span class="ln"> 30</span><span class="cm"> * 逆S盒
</span><span class="ln"> 31</span><span class="cm"> */</span>
<span class="ln"> 32</span><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">S2</span><span class="p">[</span><span class="mi">16</span><span class="p">][</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> 
<span class="ln"> 33</span>    <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xfb</span><span class="p">,</span>
<span class="ln"> 34</span>	<span class="mh">0x7c</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x9b</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span>
<span class="ln"> 35</span>	<span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">,</span> <span class="mh">0xc2</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span>
<span class="ln"> 36</span>	<span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0xa2</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span>
<span class="ln"> 37</span>	<span class="mh">0x72</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span>
<span class="ln"> 38</span>	<span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xa7</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0x9d</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span>
<span class="ln"> 39</span>	<span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span>
<span class="ln"> 40</span>	<span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xca</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0xaf</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span>
<span class="ln"> 41</span>	<span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x4f</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span>
<span class="ln"> 42</span>	<span class="mh">0x96</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span>
<span class="ln"> 43</span>	<span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span>
<span class="ln"> 44</span>	<span class="mh">0xfc</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span>
<span class="ln"> 45</span>	<span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span>
<span class="ln"> 46</span>	<span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0x4a</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x9c</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span>
<span class="ln"> 47</span>	<span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span>
<span class="ln"> 48</span>	<span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x7d</span> 
<span class="ln"> 49</span><span class="p">};</span>
<span class="ln"> 50</span>
<span class="ln"> 51</span><span class="cm">/**
</span><span class="ln"> 52</span><span class="cm"> * 获取整形数据的低8位的左4个位
</span><span class="ln"> 53</span><span class="cm"> */</span>
<span class="ln"> 54</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">getLeft4Bit</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 55</span>	<span class="kt">int</span> <span class="n">left</span> <span class="o">=</span> <span class="n">num</span> <span class="o">&amp;</span> <span class="mh">0x000000f0</span><span class="p">;</span>
<span class="ln"> 56</span>	<span class="k">return</span> <span class="n">left</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">;</span>
<span class="ln"> 57</span><span class="p">}</span>
<span class="ln"> 58</span>
<span class="ln"> 59</span><span class="cm">/**
</span><span class="ln"> 60</span><span class="cm"> * 获取整形数据的低8位的右4个位
</span><span class="ln"> 61</span><span class="cm"> */</span>
<span class="ln"> 62</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">getRight4Bit</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 63</span>	<span class="k">return</span> <span class="n">num</span> <span class="o">&amp;</span> <span class="mh">0x0000000f</span><span class="p">;</span>
<span class="ln"> 64</span><span class="p">}</span>
<span class="ln"> 65</span><span class="cm">/**
</span><span class="ln"> 66</span><span class="cm"> * 根据索引，从S盒中获得元素
</span><span class="ln"> 67</span><span class="cm"> */</span>
<span class="ln"> 68</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">getNumFromSBox</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 69</span>	<span class="kt">int</span> <span class="n">row</span> <span class="o">=</span> <span class="n">getLeft4Bit</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="ln"> 70</span>	<span class="kt">int</span> <span class="n">col</span> <span class="o">=</span> <span class="n">getRight4Bit</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="ln"> 71</span>	<span class="k">return</span> <span class="n">S</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">];</span>
<span class="ln"> 72</span><span class="p">}</span>
<span class="ln"> 73</span>
<span class="ln"> 74</span><span class="cm">/**
</span><span class="ln"> 75</span><span class="cm"> * 把一个字符转变成整型
</span><span class="ln"> 76</span><span class="cm"> */</span>
<span class="ln"> 77</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">getIntFromChar</span><span class="p">(</span><span class="kt">char</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 78</span>	<span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">c</span><span class="p">;</span>
<span class="ln"> 79</span>	<span class="k">return</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">;</span>
<span class="ln"> 80</span><span class="p">}</span>
<span class="ln"> 81</span>
<span class="ln"> 82</span><span class="cm">/**
</span><span class="ln"> 83</span><span class="cm"> * 把16个字符转变成4X4的数组，
</span><span class="ln"> 84</span><span class="cm"> * 该矩阵中字节的排列顺序为从上到下，
</span><span class="ln"> 85</span><span class="cm"> * 从左到右依次排列。
</span><span class="ln"> 86</span><span class="cm"> */</span>
<span class="ln"> 87</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">convertToIntArray</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pa</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln"> 88</span>	<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="ln"> 89</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln"> 90</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 91</span>			<span class="n">pa</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">getIntFromChar</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
<span class="ln"> 92</span>			<span class="n">k</span><span class="o">++</span><span class="p">;</span>
<span class="ln"> 93</span>		<span class="p">}</span>
<span class="ln"> 94</span><span class="p">}</span>
<span class="ln"> 95</span>
<span class="ln"> 96</span><span class="cm">/**
</span><span class="ln"> 97</span><span class="cm"> * 打印4X4的数组
</span><span class="ln"> 98</span><span class="cm"> */</span>
<span class="ln"> 99</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">printArray</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">100</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="ln">101</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="ln">102</span>			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;a[%d][%d] = 0x%x &#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
<span class="ln">103</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">104</span>	<span class="p">}</span>
<span class="ln">105</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">106</span><span class="p">}</span>
<span class="ln">107</span>
<span class="ln">108</span><span class="cm">/**
</span><span class="ln">109</span><span class="cm"> * 打印字符串的ASSCI，
</span><span class="ln">110</span><span class="cm"> * 以十六进制显示。
</span><span class="ln">111</span><span class="cm"> */</span>
<span class="ln">112</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">printASSCI</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">113</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">114</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;0x%x &#34;</span><span class="p">,</span> <span class="n">getIntFromChar</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
<span class="ln">115</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">116</span><span class="p">}</span>
<span class="ln">117</span>
<span class="ln">118</span><span class="cm">/**
</span><span class="ln">119</span><span class="cm"> * 把连续的4个字符合并成一个4字节的整型
</span><span class="ln">120</span><span class="cm"> */</span>
<span class="ln">121</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">getWordFromStr</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">122</span>	<span class="kt">int</span> <span class="n">one</span> <span class="o">=</span> <span class="n">getIntFromChar</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="ln">123</span>	<span class="n">one</span> <span class="o">=</span> <span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">;</span>
<span class="ln">124</span>	<span class="kt">int</span> <span class="n">two</span> <span class="o">=</span> <span class="n">getIntFromChar</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="ln">125</span>	<span class="n">two</span> <span class="o">=</span> <span class="n">two</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">;</span>
<span class="ln">126</span>	<span class="kt">int</span> <span class="n">three</span> <span class="o">=</span> <span class="n">getIntFromChar</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
<span class="ln">127</span>	<span class="n">three</span> <span class="o">=</span> <span class="n">three</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">;</span>
<span class="ln">128</span>	<span class="kt">int</span> <span class="n">four</span> <span class="o">=</span> <span class="n">getIntFromChar</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
<span class="ln">129</span>	<span class="k">return</span> <span class="n">one</span> <span class="o">|</span> <span class="n">two</span> <span class="o">|</span> <span class="n">three</span> <span class="o">|</span> <span class="n">four</span><span class="p">;</span>
<span class="ln">130</span><span class="p">}</span>
<span class="ln">131</span>
<span class="ln">132</span><span class="cm">/**
</span><span class="ln">133</span><span class="cm"> * 把一个4字节的数的第一、二、三、四个字节取出，
</span><span class="ln">134</span><span class="cm"> * 入进一个4个元素的整型数组里面。
</span><span class="ln">135</span><span class="cm"> */</span>
<span class="ln">136</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">splitIntToArray</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">137</span>	<span class="kt">int</span> <span class="n">one</span> <span class="o">=</span> <span class="n">num</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">;</span>
<span class="ln">138</span>	<span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">;</span>
<span class="ln">139</span>	<span class="kt">int</span> <span class="n">two</span> <span class="o">=</span> <span class="n">num</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">;</span>
<span class="ln">140</span>	<span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">two</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">;</span>
<span class="ln">141</span>	<span class="kt">int</span> <span class="n">three</span> <span class="o">=</span> <span class="n">num</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">;</span>
<span class="ln">142</span>	<span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">three</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">;</span>
<span class="ln">143</span>	<span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">;</span>
<span class="ln">144</span><span class="p">}</span>
<span class="ln">145</span>
<span class="ln">146</span><span class="cm">/**
</span><span class="ln">147</span><span class="cm"> * 将数组中的元素循环左移step位
</span><span class="ln">148</span><span class="cm"> */</span>
<span class="ln">149</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">leftLoop4int</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="kt">int</span> <span class="n">step</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">150</span>	<span class="kt">int</span> <span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">151</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">152</span>		<span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">153</span>
<span class="ln">154</span>	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">4</span><span class="p">;</span>
<span class="ln">155</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="ln">156</span>		<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="ln">157</span>		<span class="n">index</span><span class="o">++</span><span class="p">;</span>
<span class="ln">158</span>		<span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">%</span> <span class="mi">4</span><span class="p">;</span>
<span class="ln">159</span>	<span class="p">}</span>
<span class="ln">160</span><span class="p">}</span>
<span class="ln">161</span>
<span class="ln">162</span><span class="cm">/**
</span><span class="ln">163</span><span class="cm"> * 把数组中的第一、二、三和四元素分别作为
</span><span class="ln">164</span><span class="cm"> * 4字节整型的第一、二、三和四字节，合并成一个4字节整型
</span><span class="ln">165</span><span class="cm"> */</span>
<span class="ln">166</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">mergeArrayToInt</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">167</span>	<span class="kt">int</span> <span class="n">one</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">;</span>
<span class="ln">168</span>	<span class="kt">int</span> <span class="n">two</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">;</span>
<span class="ln">169</span>	<span class="kt">int</span> <span class="n">three</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">;</span>
<span class="ln">170</span>	<span class="kt">int</span> <span class="n">four</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="ln">171</span>	<span class="k">return</span> <span class="n">one</span> <span class="o">|</span> <span class="n">two</span> <span class="o">|</span> <span class="n">three</span> <span class="o">|</span> <span class="n">four</span><span class="p">;</span>
<span class="ln">172</span><span class="p">}</span>
<span class="ln">173</span>
<span class="ln">174</span><span class="cm">/**
</span><span class="ln">175</span><span class="cm"> * 常量轮值表
</span><span class="ln">176</span><span class="cm"> */</span>
<span class="ln">177</span><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">Rcon</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> 
<span class="ln">178</span>    <span class="mh">0x01000000</span><span class="p">,</span> <span class="mh">0x02000000</span><span class="p">,</span>
<span class="ln">179</span>	<span class="mh">0x04000000</span><span class="p">,</span> <span class="mh">0x08000000</span><span class="p">,</span>
<span class="ln">180</span>	<span class="mh">0x10000000</span><span class="p">,</span> <span class="mh">0x20000000</span><span class="p">,</span>
<span class="ln">181</span>	<span class="mh">0x40000000</span><span class="p">,</span> <span class="mh">0x80000000</span><span class="p">,</span>
<span class="ln">182</span>	<span class="mh">0x1b000000</span><span class="p">,</span> <span class="mh">0x36000000</span> 
<span class="ln">183</span><span class="p">};</span>
<span class="ln">184</span><span class="cm">/**
</span><span class="ln">185</span><span class="cm"> * 密钥扩展中的T函数
</span><span class="ln">186</span><span class="cm"> */</span>
<span class="ln">187</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">T</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="kt">int</span> <span class="n">round</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">188</span>	<span class="kt">int</span> <span class="n">numArray</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">189</span>	<span class="n">splitIntToArray</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">numArray</span><span class="p">);</span>
<span class="ln">190</span>	<span class="n">leftLoop4int</span><span class="p">(</span><span class="n">numArray</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span><span class="c1">//字循环
</span><span class="ln">191</span><span class="c1"></span>
<span class="ln">192</span>	<span class="c1">//字节代换
</span><span class="ln">193</span><span class="c1"></span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">194</span>		<span class="n">numArray</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">getNumFromSBox</span><span class="p">(</span><span class="n">numArray</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="ln">195</span>
<span class="ln">196</span>	<span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">mergeArrayToInt</span><span class="p">(</span><span class="n">numArray</span><span class="p">);</span>
<span class="ln">197</span>	<span class="k">return</span> <span class="n">result</span> <span class="o">^</span> <span class="n">Rcon</span><span class="p">[</span><span class="n">round</span><span class="p">];</span>
<span class="ln">198</span><span class="p">}</span>
<span class="ln">199</span>
<span class="ln">200</span><span class="c1">//密钥对应的扩展数组
</span><span class="ln">201</span><span class="c1"></span><span class="k">static</span> <span class="kt">int</span> <span class="n">w</span><span class="p">[</span><span class="mi">44</span><span class="p">];</span>
<span class="ln">202</span>
<span class="ln">203</span><span class="cm">/**
</span><span class="ln">204</span><span class="cm"> * 扩展密钥，结果是把w[44]中的每个元素初始化
</span><span class="ln">205</span><span class="cm"> */</span>
<span class="ln">206</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">extendKey</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">207</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">208</span>		<span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">getWordFromStr</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span>
<span class="ln">209</span>
<span class="ln">210</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">44</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">211</span>		<span class="k">if</span><span class="p">(</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">212</span>			<span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">T</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">j</span><span class="p">);</span>
<span class="ln">213</span>			<span class="n">j</span><span class="o">++</span><span class="p">;</span><span class="c1">//下一轮
</span><span class="ln">214</span><span class="c1"></span>		<span class="p">}</span><span class="k">else</span> <span class="p">{</span>
<span class="ln">215</span>			<span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
<span class="ln">216</span>		<span class="p">}</span>
<span class="ln">217</span>	<span class="p">}</span>
<span class="ln">218</span>
<span class="ln">219</span><span class="p">}</span>
<span class="ln">220</span>
<span class="ln">221</span><span class="cm">/**
</span><span class="ln">222</span><span class="cm"> * 轮密钥加
</span><span class="ln">223</span><span class="cm"> */</span>
<span class="ln">224</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">addRoundKey</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="kt">int</span> <span class="n">round</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">225</span>	<span class="kt">int</span> <span class="n">warray</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">226</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">227</span>
<span class="ln">228</span>		<span class="n">splitIntToArray</span><span class="p">(</span><span class="n">w</span><span class="p">[</span> <span class="n">round</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">i</span><span class="p">],</span> <span class="n">warray</span><span class="p">);</span>
<span class="ln">229</span>
<span class="ln">230</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">231</span>			<span class="n">array</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">warray</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="ln">232</span>		<span class="p">}</span>
<span class="ln">233</span>	<span class="p">}</span>
<span class="ln">234</span><span class="p">}</span>
<span class="ln">235</span>
<span class="ln">236</span><span class="cm">/**
</span><span class="ln">237</span><span class="cm"> * 字节代换
</span><span class="ln">238</span><span class="cm"> */</span>
<span class="ln">239</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">subBytes</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]){</span>
<span class="ln">240</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">241</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="ln">242</span>			<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">getNumFromSBox</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
<span class="ln">243</span><span class="p">}</span>
<span class="ln">244</span>
<span class="ln">245</span><span class="cm">/**
</span><span class="ln">246</span><span class="cm"> * 行移位
</span><span class="ln">247</span><span class="cm"> */</span>
<span class="ln">248</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">shiftRows</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">249</span>	<span class="kt">int</span> <span class="n">rowTwo</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">rowThree</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">rowFour</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">250</span>	<span class="c1">//复制状态矩阵的第2,3,4行
</span><span class="ln">251</span><span class="c1"></span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">252</span>		<span class="n">rowTwo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="ln">253</span>		<span class="n">rowThree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="ln">254</span>		<span class="n">rowFour</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="ln">255</span>	<span class="p">}</span>
<span class="ln">256</span>	<span class="c1">//循环左移相应的位数
</span><span class="ln">257</span><span class="c1"></span>	<span class="n">leftLoop4int</span><span class="p">(</span><span class="n">rowTwo</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="ln">258</span>	<span class="n">leftLoop4int</span><span class="p">(</span><span class="n">rowThree</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="ln">259</span>	<span class="n">leftLoop4int</span><span class="p">(</span><span class="n">rowFour</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="ln">260</span>
<span class="ln">261</span>	<span class="c1">//把左移后的行复制回状态矩阵中
</span><span class="ln">262</span><span class="c1"></span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">263</span>		<span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rowTwo</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">264</span>		<span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rowThree</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">265</span>		<span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rowFour</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">266</span>	<span class="p">}</span>
<span class="ln">267</span><span class="p">}</span>
<span class="ln">268</span>
<span class="ln">269</span><span class="cm">/**
</span><span class="ln">270</span><span class="cm"> * 列混合要用到的矩阵
</span><span class="ln">271</span><span class="cm"> */</span>
<span class="ln">272</span><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">colM</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="ln">273</span>	<span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="ln">274</span>	<span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
<span class="ln">275</span>	<span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">};</span>
<span class="ln">276</span>
<span class="ln">277</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul2</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">278</span>	<span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
<span class="ln">279</span>	<span class="kt">int</span> <span class="n">a7</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="mh">0x00000100</span><span class="p">;</span>
<span class="ln">280</span>
<span class="ln">281</span>	<span class="k">if</span><span class="p">(</span><span class="n">a7</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">282</span>		<span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">;</span>
<span class="ln">283</span>		<span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">^</span> <span class="mh">0x1b</span><span class="p">;</span>
<span class="ln">284</span>	<span class="p">}</span>
<span class="ln">285</span>
<span class="ln">286</span>	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="ln">287</span><span class="p">}</span>
<span class="ln">288</span>
<span class="ln">289</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul3</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">290</span>	<span class="k">return</span> <span class="n">GFMul2</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">^</span> <span class="n">s</span><span class="p">;</span>
<span class="ln">291</span><span class="p">}</span>
<span class="ln">292</span>
<span class="ln">293</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul4</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">294</span>	<span class="k">return</span> <span class="n">GFMul2</span><span class="p">(</span><span class="n">GFMul2</span><span class="p">(</span><span class="n">s</span><span class="p">));</span>
<span class="ln">295</span><span class="p">}</span>
<span class="ln">296</span>
<span class="ln">297</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul8</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">298</span>	<span class="k">return</span> <span class="n">GFMul2</span><span class="p">(</span><span class="n">GFMul4</span><span class="p">(</span><span class="n">s</span><span class="p">));</span>
<span class="ln">299</span><span class="p">}</span>
<span class="ln">300</span>
<span class="ln">301</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul9</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">302</span>	<span class="k">return</span> <span class="n">GFMul8</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">^</span> <span class="n">s</span><span class="p">;</span>
<span class="ln">303</span><span class="p">}</span>
<span class="ln">304</span>
<span class="ln">305</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul11</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">306</span>	<span class="k">return</span> <span class="n">GFMul9</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">^</span> <span class="n">GFMul2</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">307</span><span class="p">}</span>
<span class="ln">308</span>
<span class="ln">309</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul12</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">310</span>	<span class="k">return</span> <span class="n">GFMul8</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">^</span> <span class="n">GFMul4</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">311</span><span class="p">}</span>
<span class="ln">312</span>
<span class="ln">313</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul13</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">314</span>	<span class="k">return</span> <span class="n">GFMul12</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">^</span> <span class="n">s</span><span class="p">;</span>
<span class="ln">315</span><span class="p">}</span>
<span class="ln">316</span>
<span class="ln">317</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul14</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">318</span>	<span class="k">return</span> <span class="n">GFMul12</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">^</span> <span class="n">GFMul2</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">319</span><span class="p">}</span>
<span class="ln">320</span>
<span class="ln">321</span><span class="cm">/**
</span><span class="ln">322</span><span class="cm"> * GF上的二元运算
</span><span class="ln">323</span><span class="cm"> */</span>
<span class="ln">324</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">GFMul</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">325</span>	<span class="kt">int</span> <span class="n">result</span><span class="p">;</span>
<span class="ln">326</span>
<span class="ln">327</span>	<span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="ln">328</span>		<span class="n">result</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span>
<span class="ln">329</span>	<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
<span class="ln">330</span>		<span class="n">result</span> <span class="o">=</span> <span class="n">GFMul2</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">331</span>	<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
<span class="ln">332</span>		<span class="n">result</span> <span class="o">=</span> <span class="n">GFMul3</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">333</span>	<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mh">0x9</span><span class="p">)</span>
<span class="ln">334</span>		<span class="n">result</span> <span class="o">=</span> <span class="n">GFMul9</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">335</span>	<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mh">0xb</span><span class="p">)</span><span class="c1">//11
</span><span class="ln">336</span><span class="c1"></span>		<span class="n">result</span> <span class="o">=</span> <span class="n">GFMul11</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">337</span>	<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mh">0xd</span><span class="p">)</span><span class="c1">//13
</span><span class="ln">338</span><span class="c1"></span>		<span class="n">result</span> <span class="o">=</span> <span class="n">GFMul13</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">339</span>	<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mh">0xe</span><span class="p">)</span><span class="c1">//14
</span><span class="ln">340</span><span class="c1"></span>		<span class="n">result</span> <span class="o">=</span> <span class="n">GFMul14</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="ln">341</span>
<span class="ln">342</span>	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="ln">343</span><span class="p">}</span>
<span class="ln">344</span><span class="cm">/**
</span><span class="ln">345</span><span class="cm"> * 列混合
</span><span class="ln">346</span><span class="cm"> */</span>
<span class="ln">347</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">mixColumns</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">348</span>
<span class="ln">349</span>	<span class="kt">int</span> <span class="n">tempArray</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">350</span>
<span class="ln">351</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">352</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="ln">353</span>			<span class="n">tempArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="ln">354</span>
<span class="ln">355</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">356</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
<span class="ln">357</span>			<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">GFMul</span><span class="p">(</span><span class="n">colM</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">tempArray</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">^</span> <span class="n">GFMul</span><span class="p">(</span><span class="n">colM</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tempArray</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> 
<span class="ln">358</span>				<span class="o">^</span> <span class="n">GFMul</span><span class="p">(</span><span class="n">colM</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="n">tempArray</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">^</span> <span class="n">GFMul</span><span class="p">(</span><span class="n">colM</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">tempArray</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
<span class="ln">359</span>		<span class="p">}</span>
<span class="ln">360</span><span class="p">}</span>
<span class="ln">361</span><span class="cm">/**
</span><span class="ln">362</span><span class="cm"> * 把4X4数组转回字符串
</span><span class="ln">363</span><span class="cm"> */</span>
<span class="ln">364</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">convertArrayToStr</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">365</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">366</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="ln">367</span>			<span class="o">*</span><span class="n">str</span><span class="o">++</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">array</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>	
<span class="ln">368</span><span class="p">}</span>
<span class="ln">369</span><span class="cm">/**
</span><span class="ln">370</span><span class="cm"> * 检查密钥长度
</span><span class="ln">371</span><span class="cm"> */</span>
<span class="ln">372</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">checkKeyLen</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">373</span>	<span class="k">if</span><span class="p">(</span><span class="n">len</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span>
<span class="ln">374</span>		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="ln">375</span>	<span class="k">else</span>
<span class="ln">376</span>		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="ln">377</span><span class="p">}</span>
<span class="ln">378</span>
<span class="ln">379</span><span class="cm">/**
</span><span class="ln">380</span><span class="cm"> * 参数 p: 明文的字符串数组。
</span><span class="ln">381</span><span class="cm"> * 参数 plen: 明文的长度。
</span><span class="ln">382</span><span class="cm"> * 参数 key: 密钥的字符串数组。
</span><span class="ln">383</span><span class="cm"> */</span>
<span class="ln">384</span><span class="kt">void</span> <span class="nf">aes</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">plen</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">){</span>
<span class="ln">385</span>
<span class="ln">386</span>	<span class="kt">int</span> <span class="n">keylen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="ln">387</span>	<span class="k">if</span><span class="p">(</span><span class="n">plen</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">plen</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">388</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;明文字符长度必须为16的倍数！</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">389</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="ln">390</span>	<span class="p">}</span>
<span class="ln">391</span>
<span class="ln">392</span>	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">checkKeyLen</span><span class="p">(</span><span class="n">keylen</span><span class="p">))</span> <span class="p">{</span>
<span class="ln">393</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;密钥字符长度错误！长度必须为16、24和32。当前长度为%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">keylen</span><span class="p">);</span>
<span class="ln">394</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="ln">395</span>	<span class="p">}</span>
<span class="ln">396</span>
<span class="ln">397</span>	<span class="n">extendKey</span><span class="p">(</span><span class="n">key</span><span class="p">);</span><span class="c1">//扩展密钥
</span><span class="ln">398</span><span class="c1"></span>	<span class="kt">int</span> <span class="n">pArray</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">399</span>
<span class="ln">400</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">plen</span><span class="p">;</span> <span class="n">k</span> <span class="o">+=</span> <span class="mi">16</span><span class="p">)</span> <span class="p">{</span>	
<span class="ln">401</span>		<span class="n">convertToIntArray</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">pArray</span><span class="p">);</span>
<span class="ln">402</span>
<span class="ln">403</span>		<span class="n">addRoundKey</span><span class="p">(</span><span class="n">pArray</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span><span class="c1">//一开始的轮密钥加
</span><span class="ln">404</span><span class="c1"></span>
<span class="ln">405</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="c1">//前9轮
</span><span class="ln">406</span><span class="c1"></span>
<span class="ln">407</span>			<span class="n">subBytes</span><span class="p">(</span><span class="n">pArray</span><span class="p">);</span><span class="c1">//字节代换
</span><span class="ln">408</span><span class="c1"></span>
<span class="ln">409</span>			<span class="n">shiftRows</span><span class="p">(</span><span class="n">pArray</span><span class="p">);</span><span class="c1">//行移位
</span><span class="ln">410</span><span class="c1"></span>
<span class="ln">411</span>			<span class="n">mixColumns</span><span class="p">(</span><span class="n">pArray</span><span class="p">);</span><span class="c1">//列混合
</span><span class="ln">412</span><span class="c1"></span>
<span class="ln">413</span>			<span class="n">addRoundKey</span><span class="p">(</span><span class="n">pArray</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
<span class="ln">414</span>
<span class="ln">415</span>		<span class="p">}</span>
<span class="ln">416</span>
<span class="ln">417</span>		<span class="c1">//第10轮
</span><span class="ln">418</span><span class="c1"></span>		<span class="n">subBytes</span><span class="p">(</span><span class="n">pArray</span><span class="p">);</span><span class="c1">//字节代换
</span><span class="ln">419</span><span class="c1"></span>
<span class="ln">420</span>		<span class="n">shiftRows</span><span class="p">(</span><span class="n">pArray</span><span class="p">);</span><span class="c1">//行移位
</span><span class="ln">421</span><span class="c1"></span>
<span class="ln">422</span>		<span class="n">addRoundKey</span><span class="p">(</span><span class="n">pArray</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="ln">423</span>
<span class="ln">424</span>		<span class="n">convertArrayToStr</span><span class="p">(</span><span class="n">pArray</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="n">k</span><span class="p">);</span>
<span class="ln">425</span>	<span class="p">}</span>
<span class="ln">426</span><span class="p">}</span>
<span class="ln">427</span><span class="cm">/**
</span><span class="ln">428</span><span class="cm"> * 根据索引从逆S盒中获取值
</span><span class="ln">429</span><span class="cm"> */</span>
<span class="ln">430</span><span class="k">static</span> <span class="kt">int</span> <span class="nf">getNumFromS1Box</span><span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">431</span>	<span class="kt">int</span> <span class="n">row</span> <span class="o">=</span> <span class="n">getLeft4Bit</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="ln">432</span>	<span class="kt">int</span> <span class="n">col</span> <span class="o">=</span> <span class="n">getRight4Bit</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="ln">433</span>	<span class="k">return</span> <span class="n">S2</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">];</span>
<span class="ln">434</span><span class="p">}</span>
<span class="ln">435</span><span class="cm">/**
</span><span class="ln">436</span><span class="cm"> * 逆字节变换
</span><span class="ln">437</span><span class="cm"> */</span>
<span class="ln">438</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">deSubBytes</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">439</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">440</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="ln">441</span>			<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">getNumFromS1Box</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
<span class="ln">442</span><span class="p">}</span>
<span class="ln">443</span><span class="cm">/**
</span><span class="ln">444</span><span class="cm"> * 把4个元素的数组循环右移step位
</span><span class="ln">445</span><span class="cm"> */</span>
<span class="ln">446</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">rightLoop4int</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="kt">int</span> <span class="n">step</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">447</span>	<span class="kt">int</span> <span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">448</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">449</span>		<span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">450</span>
<span class="ln">451</span>	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">4</span><span class="p">;</span>
<span class="ln">452</span>	<span class="n">index</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">index</span><span class="p">;</span>
<span class="ln">453</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">454</span>		<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
<span class="ln">455</span>		<span class="n">index</span><span class="o">--</span><span class="p">;</span>
<span class="ln">456</span>		<span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="mi">3</span> <span class="o">:</span> <span class="n">index</span><span class="p">;</span>
<span class="ln">457</span>	<span class="p">}</span>
<span class="ln">458</span><span class="p">}</span>
<span class="ln">459</span>
<span class="ln">460</span><span class="cm">/**
</span><span class="ln">461</span><span class="cm"> * 逆行移位
</span><span class="ln">462</span><span class="cm"> */</span>
<span class="ln">463</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">deShiftRows</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">464</span>	<span class="kt">int</span> <span class="n">rowTwo</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">rowThree</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">rowFour</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">465</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">466</span>		<span class="n">rowTwo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="ln">467</span>		<span class="n">rowThree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="ln">468</span>		<span class="n">rowFour</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
<span class="ln">469</span>	<span class="p">}</span>
<span class="ln">470</span>
<span class="ln">471</span>	<span class="n">rightLoop4int</span><span class="p">(</span><span class="n">rowTwo</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="ln">472</span>	<span class="n">rightLoop4int</span><span class="p">(</span><span class="n">rowThree</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="ln">473</span>	<span class="n">rightLoop4int</span><span class="p">(</span><span class="n">rowFour</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="ln">474</span>
<span class="ln">475</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">476</span>		<span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rowTwo</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">477</span>		<span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rowThree</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">478</span>		<span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rowFour</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">479</span>	<span class="p">}</span>
<span class="ln">480</span><span class="p">}</span>
<span class="ln">481</span><span class="cm">/**
</span><span class="ln">482</span><span class="cm"> * 逆列混合用到的矩阵
</span><span class="ln">483</span><span class="cm"> */</span>
<span class="ln">484</span><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">deColM</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0xe</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span>
<span class="ln">485</span>	<span class="mh">0x9</span><span class="p">,</span> <span class="mh">0xe</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">,</span>
<span class="ln">486</span>	<span class="mh">0xd</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0xe</span><span class="p">,</span> <span class="mh">0xb</span><span class="p">,</span>
<span class="ln">487</span>	<span class="mh">0xb</span><span class="p">,</span> <span class="mh">0xd</span><span class="p">,</span> <span class="mh">0x9</span><span class="p">,</span> <span class="mh">0xe</span> <span class="p">};</span>
<span class="ln">488</span>
<span class="ln">489</span><span class="cm">/**
</span><span class="ln">490</span><span class="cm"> * 逆列混合
</span><span class="ln">491</span><span class="cm"> */</span>
<span class="ln">492</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">deMixColumns</span><span class="p">(</span><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">493</span>	<span class="kt">int</span> <span class="n">tempArray</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">494</span>
<span class="ln">495</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">496</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="ln">497</span>			<span class="n">tempArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="ln">498</span>
<span class="ln">499</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">500</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
<span class="ln">501</span>			<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">GFMul</span><span class="p">(</span><span class="n">deColM</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">tempArray</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">^</span> <span class="n">GFMul</span><span class="p">(</span><span class="n">deColM</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tempArray</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> 
<span class="ln">502</span>				<span class="o">^</span> <span class="n">GFMul</span><span class="p">(</span><span class="n">deColM</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="n">tempArray</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="o">^</span> <span class="n">GFMul</span><span class="p">(</span><span class="n">deColM</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">tempArray</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
<span class="ln">503</span>		<span class="p">}</span>
<span class="ln">504</span><span class="p">}</span>
<span class="ln">505</span><span class="cm">/**
</span><span class="ln">506</span><span class="cm"> * 把两个4X4数组进行异或
</span><span class="ln">507</span><span class="cm"> */</span>
<span class="ln">508</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">addRoundTowArray</span><span class="p">(</span><span class="kt">int</span> <span class="n">aArray</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span><span class="kt">int</span> <span class="n">bArray</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">509</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln">510</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="ln">511</span>			<span class="n">aArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">aArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="n">bArray</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="ln">512</span><span class="p">}</span>
<span class="ln">513</span><span class="cm">/**
</span><span class="ln">514</span><span class="cm"> * 从4个32位的密钥字中获得4X4数组，
</span><span class="ln">515</span><span class="cm"> * 用于进行逆列混合
</span><span class="ln">516</span><span class="cm"> */</span>
<span class="ln">517</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">getArrayFrom4W</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="p">{</span>
<span class="ln">518</span>	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span>
<span class="ln">519</span>	<span class="kt">int</span> <span class="n">colOne</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">colTwo</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">colThree</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">colFour</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">520</span>	<span class="n">splitIntToArray</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">colOne</span><span class="p">);</span>
<span class="ln">521</span>	<span class="n">splitIntToArray</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">colTwo</span><span class="p">);</span>
<span class="ln">522</span>	<span class="n">splitIntToArray</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="n">colThree</span><span class="p">);</span>
<span class="ln">523</span>	<span class="n">splitIntToArray</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">3</span><span class="p">],</span> <span class="n">colFour</span><span class="p">);</span>
<span class="ln">524</span>
<span class="ln">525</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">526</span>		<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">colOne</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">527</span>		<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">colTwo</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">528</span>		<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">colThree</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">529</span>		<span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">colFour</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="ln">530</span>	<span class="p">}</span>
<span class="ln">531</span>
<span class="ln">532</span><span class="p">}</span>
<span class="ln">533</span>
<span class="ln">534</span><span class="cm">/**
</span><span class="ln">535</span><span class="cm"> * 参数 c: 密文的字符串数组。
</span><span class="ln">536</span><span class="cm"> * 参数 clen: 密文的长度。
</span><span class="ln">537</span><span class="cm"> * 参数 key: 密钥的字符串数组。
</span><span class="ln">538</span><span class="cm"> */</span>
<span class="ln">539</span><span class="kt">void</span> <span class="nf">deAes</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">clen</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">540</span>
<span class="ln">541</span>	<span class="kt">int</span> <span class="n">keylen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="ln">542</span>	<span class="k">if</span><span class="p">(</span><span class="n">clen</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">clen</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">543</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;密文字符长度必须为16的倍数！现在的长度为%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">clen</span><span class="p">);</span>
<span class="ln">544</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="ln">545</span>	<span class="p">}</span>
<span class="ln">546</span>
<span class="ln">547</span>	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">checkKeyLen</span><span class="p">(</span><span class="n">keylen</span><span class="p">))</span> <span class="p">{</span>
<span class="ln">548</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;密钥字符长度错误！长度必须为16、24和32。当前长度为%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">keylen</span><span class="p">);</span>
<span class="ln">549</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="ln">550</span>	<span class="p">}</span>
<span class="ln">551</span>
<span class="ln">552</span>	<span class="n">extendKey</span><span class="p">(</span><span class="n">key</span><span class="p">);</span><span class="c1">//扩展密钥
</span><span class="ln">553</span><span class="c1"></span>	<span class="kt">int</span> <span class="n">cArray</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">554</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">clen</span><span class="p">;</span> <span class="n">k</span> <span class="o">+=</span> <span class="mi">16</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">555</span>		<span class="n">convertToIntArray</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="n">cArray</span><span class="p">);</span>
<span class="ln">556</span>
<span class="ln">557</span>
<span class="ln">558</span>		<span class="n">addRoundKey</span><span class="p">(</span><span class="n">cArray</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="ln">559</span>
<span class="ln">560</span>		<span class="kt">int</span> <span class="n">wArray</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
<span class="ln">561</span>		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">562</span>			<span class="n">deSubBytes</span><span class="p">(</span><span class="n">cArray</span><span class="p">);</span>
<span class="ln">563</span>
<span class="ln">564</span>			<span class="n">deShiftRows</span><span class="p">(</span><span class="n">cArray</span><span class="p">);</span>
<span class="ln">565</span>
<span class="ln">566</span>			<span class="n">deMixColumns</span><span class="p">(</span><span class="n">cArray</span><span class="p">);</span>
<span class="ln">567</span>			<span class="n">getArrayFrom4W</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">wArray</span><span class="p">);</span>
<span class="ln">568</span>			<span class="n">deMixColumns</span><span class="p">(</span><span class="n">wArray</span><span class="p">);</span>
<span class="ln">569</span>
<span class="ln">570</span>			<span class="n">addRoundTowArray</span><span class="p">(</span><span class="n">cArray</span><span class="p">,</span> <span class="n">wArray</span><span class="p">);</span>
<span class="ln">571</span>		<span class="p">}</span>
<span class="ln">572</span>
<span class="ln">573</span>		<span class="n">deSubBytes</span><span class="p">(</span><span class="n">cArray</span><span class="p">);</span>
<span class="ln">574</span>
<span class="ln">575</span>		<span class="n">deShiftRows</span><span class="p">(</span><span class="n">cArray</span><span class="p">);</span>
<span class="ln">576</span>
<span class="ln">577</span>		<span class="n">addRoundKey</span><span class="p">(</span><span class="n">cArray</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="ln">578</span>
<span class="ln">579</span>		<span class="n">convertArrayToStr</span><span class="p">(</span><span class="n">cArray</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="n">k</span><span class="p">);</span>
<span class="ln">580</span>
<span class="ln">581</span>	<span class="p">}</span>
<span class="ln">582</span><span class="p">}</span>
</code></pre></div><p><code>main.c</code></p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="ln">  1</span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="ln">  2</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="ln">  3</span><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span><span class="ln">  4</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="ln">  5</span><span class="cp"></span>
<span class="ln">  6</span><span class="cp">#include</span> <span class="cpf">&#34;aes.h&#34;</span><span class="cp">
</span><span class="ln">  7</span><span class="cp"></span>
<span class="ln">  8</span><span class="cp">#define MAXLEN 1024
</span><span class="ln">  9</span><span class="cp"></span>
<span class="ln"> 10</span><span class="kt">void</span> <span class="nf">getString</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">){</span>
<span class="ln"> 11</span>
<span class="ln"> 12</span>	<span class="kt">int</span> <span class="n">slen</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
<span class="ln"> 13</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">slen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="n">str</span><span class="o">++</span><span class="p">){</span>
<span class="ln"> 14</span>		<span class="k">if</span><span class="p">(</span><span class="o">*</span><span class="n">str</span> <span class="o">==</span> <span class="sc">&#39;\n&#39;</span><span class="p">){</span>
<span class="ln"> 15</span>			<span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<span class="ln"> 16</span>			<span class="k">break</span><span class="p">;</span>
<span class="ln"> 17</span>		<span class="p">}</span>
<span class="ln"> 18</span>	<span class="p">}</span>
<span class="ln"> 19</span><span class="p">}</span>
<span class="ln"> 20</span>
<span class="ln"> 21</span><span class="kt">void</span> <span class="nf">printASCCI</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 22</span>	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
<span class="ln"> 23</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 24</span>		<span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="n">str</span><span class="o">++</span><span class="p">;</span>
<span class="ln"> 25</span>		<span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">;</span>
<span class="ln"> 26</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;0x%x &#34;</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
<span class="ln"> 27</span>	<span class="p">}</span>
<span class="ln"> 28</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln"> 29</span><span class="p">}</span>
<span class="ln"> 30</span>
<span class="ln"> 31</span><span class="cm">/**
</span><span class="ln"> 32</span><span class="cm"> * 从标准输入中读取用户输入的字符串
</span><span class="ln"> 33</span><span class="cm"> */</span>
<span class="ln"> 34</span><span class="kt">void</span> <span class="nf">readPlainText</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">len</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 35</span>	<span class="kt">int</span> <span class="n">plen</span><span class="p">;</span>
<span class="ln"> 36</span>	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 37</span>		<span class="n">getString</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">MAXLEN</span><span class="p">);</span>
<span class="ln"> 38</span>		<span class="n">plen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="ln"> 39</span>		<span class="k">if</span><span class="p">(</span><span class="n">plen</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">plen</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 40</span>			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;你输入的明文为：%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
<span class="ln"> 41</span>			<span class="k">break</span><span class="p">;</span>
<span class="ln"> 42</span>		<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="ln"> 43</span>			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;明文字符长度必须为16的倍数,现在的长度为%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">plen</span><span class="p">);</span>
<span class="ln"> 44</span>		<span class="p">}</span>
<span class="ln"> 45</span>	<span class="p">}</span>
<span class="ln"> 46</span>	<span class="o">*</span><span class="n">len</span> <span class="o">=</span> <span class="n">plen</span><span class="p">;</span>
<span class="ln"> 47</span><span class="p">}</span>
<span class="ln"> 48</span><span class="cm">/**
</span><span class="ln"> 49</span><span class="cm"> * 把字符串写进文件
</span><span class="ln"> 50</span><span class="cm"> */</span>
<span class="ln"> 51</span><span class="kt">void</span> <span class="nf">writeStrToFile</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fileName</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 52</span>	<span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">;</span>
<span class="ln"> 53</span>	<span class="n">fp</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="s">&#34;wb&#34;</span><span class="p">);</span>
<span class="ln"> 54</span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="ln"> 55</span>		<span class="n">putc</span><span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fp</span><span class="p">);</span>
<span class="ln"> 56</span>	<span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="ln"> 57</span><span class="p">}</span>
<span class="ln"> 58</span>
<span class="ln"> 59</span>
<span class="ln"> 60</span><span class="kt">void</span> <span class="nf">aesStrToFile</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 61</span>
<span class="ln"> 62</span>	<span class="kt">char</span> <span class="n">p</span><span class="p">[</span><span class="n">MAXLEN</span><span class="p">];</span>
<span class="ln"> 63</span>	<span class="kt">int</span> <span class="n">plen</span><span class="p">;</span>
<span class="ln"> 64</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入你的明文，明文字符长度必须为16的倍数</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln"> 65</span>	<span class="n">readPlainText</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="o">&amp;</span><span class="n">plen</span><span class="p">);</span>
<span class="ln"> 66</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;进行AES加密..................</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln"> 67</span>
<span class="ln"> 68</span>	<span class="n">aes</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">plen</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span><span class="c1">//AES加密
</span><span class="ln"> 69</span><span class="c1"></span>
<span class="ln"> 70</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;加密完后的明文的ASCCI为：</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln"> 71</span>	<span class="n">printASCCI</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">plen</span><span class="p">);</span>
<span class="ln"> 72</span>	<span class="kt">char</span> <span class="n">fileName</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="ln"> 73</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入你想要写进的文件名，比如&#39;test.txt&#39;:</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln"> 74</span>	<span class="k">if</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">fileName</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>	
<span class="ln"> 75</span>		<span class="n">writeStrToFile</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">plen</span><span class="p">,</span> <span class="n">fileName</span><span class="p">);</span>
<span class="ln"> 76</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;已经将密文写进%s中了,可以在运行该程序的当前目录中找到它。</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">fileName</span><span class="p">);</span>
<span class="ln"> 77</span>	<span class="p">}</span>
<span class="ln"> 78</span><span class="p">}</span>
<span class="ln"> 79</span><span class="cm">/**
</span><span class="ln"> 80</span><span class="cm"> * 从文件中读取字符串
</span><span class="ln"> 81</span><span class="cm"> */</span>
<span class="ln"> 82</span><span class="kt">int</span> <span class="nf">readStrFromFile</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">fileName</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 83</span>	<span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="s">&#34;rb&#34;</span><span class="p">);</span>
<span class="ln"> 84</span>	<span class="k">if</span><span class="p">(</span><span class="n">fp</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 85</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;打开文件出错，请确认文件存在当前目录下！</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln"> 86</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="ln"> 87</span>	<span class="p">}</span>
<span class="ln"> 88</span>
<span class="ln"> 89</span>	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="ln"> 90</span>	<span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAXLEN</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">getc</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">);</span>
<span class="ln"> 91</span>
<span class="ln"> 92</span>	<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">MAXLEN</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 93</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;解密文件过大！</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln"> 94</span>		<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="ln"> 95</span>	<span class="p">}</span>
<span class="ln"> 96</span>
<span class="ln"> 97</span>	<span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<span class="ln"> 98</span>	<span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="ln"> 99</span>	<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
<span class="ln">100</span><span class="p">}</span>
<span class="ln">101</span>
<span class="ln">102</span>
<span class="ln">103</span><span class="kt">void</span> <span class="nf">deAesFile</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">104</span>	<span class="kt">char</span> <span class="n">fileName</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="ln">105</span>	<span class="kt">char</span> <span class="n">c</span><span class="p">[</span><span class="n">MAXLEN</span><span class="p">];</span><span class="c1">//密文字符串
</span><span class="ln">106</span><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入要解密的文件名，该文件必须和本程序在同一个目录</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">107</span>	<span class="k">if</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">fileName</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">108</span>		<span class="kt">int</span> <span class="n">clen</span> <span class="o">=</span> <span class="n">readStrFromFile</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
<span class="ln">109</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;开始解密.........</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">110</span>		<span class="n">deAes</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">clen</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span>
<span class="ln">111</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;解密后的明文ASCII为：</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">112</span>		<span class="n">printASCCI</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">clen</span><span class="p">);</span>
<span class="ln">113</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;明文为：%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span>
<span class="ln">114</span>		<span class="n">writeStrToFile</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">clen</span><span class="p">,</span><span class="n">fileName</span><span class="p">);</span>
<span class="ln">115</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;现在可以打开%s来查看解密后的密文了！</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">fileName</span><span class="p">);</span>
<span class="ln">116</span>	<span class="p">}</span>
<span class="ln">117</span><span class="p">}</span>
<span class="ln">118</span>
<span class="ln">119</span><span class="kt">void</span> <span class="nf">aesFile</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">120</span>	<span class="kt">char</span> <span class="n">fileName</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="ln">121</span>	<span class="kt">char</span> <span class="n">fileP</span><span class="p">[</span><span class="n">MAXLEN</span><span class="p">];</span>
<span class="ln">122</span>
<span class="ln">123</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入要加密的文件名，该文件必须和本程序在同一个目录</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">124</span>	<span class="k">if</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">fileName</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">125</span>		<span class="n">readStrFromFile</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">fileP</span><span class="p">);</span>
<span class="ln">126</span>		<span class="kt">int</span> <span class="n">plen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">fileP</span><span class="p">);</span>
<span class="ln">127</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;开始加密.........</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">128</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;加密前文件中字符的ASCII为：</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">129</span>		<span class="n">printASCCI</span><span class="p">(</span><span class="n">fileP</span><span class="p">,</span> <span class="n">plen</span><span class="p">);</span>
<span class="ln">130</span>
<span class="ln">131</span>		<span class="n">aes</span><span class="p">(</span><span class="n">fileP</span><span class="p">,</span> <span class="n">plen</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span><span class="c1">//开始加密
</span><span class="ln">132</span><span class="c1"></span>
<span class="ln">133</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;加密后的密文ASCII为：</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">134</span>		<span class="n">printASCCI</span><span class="p">(</span><span class="n">fileP</span><span class="p">,</span> <span class="n">plen</span><span class="p">);</span>
<span class="ln">135</span>		<span class="n">writeStrToFile</span><span class="p">(</span><span class="n">fileP</span><span class="p">,</span><span class="n">plen</span><span class="p">,</span><span class="n">fileName</span><span class="p">);</span>
<span class="ln">136</span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;已经将加密后的密文写进%s中了</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">fileName</span><span class="p">);</span>
<span class="ln">137</span>	<span class="p">}</span>
<span class="ln">138</span><span class="p">}</span>
<span class="ln">139</span>
<span class="ln">140</span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="k">const</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
<span class="ln">141</span>
<span class="ln">142</span>	<span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
<span class="ln">143</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入16个字符的密钥：</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">144</span>	<span class="kt">int</span> <span class="n">klen</span><span class="p">;</span>
<span class="ln">145</span>	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
<span class="ln">146</span>		<span class="n">getString</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="mi">17</span><span class="p">);</span>
<span class="ln">147</span>		<span class="n">klen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="ln">148</span>		<span class="k">if</span><span class="p">(</span><span class="n">klen</span> <span class="o">!=</span> <span class="mi">16</span><span class="p">){</span>
<span class="ln">149</span>			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入16个字符的密钥,当前密钥的长度为%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">klen</span><span class="p">);</span>
<span class="ln">150</span>		<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="ln">151</span>			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;你输入的密钥为：%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">key</span><span class="p">);</span>
<span class="ln">152</span>			<span class="k">break</span><span class="p">;</span>
<span class="ln">153</span>		<span class="p">}</span>
<span class="ln">154</span>	<span class="p">}</span>
<span class="ln">155</span>
<span class="ln">156</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;输入&#39;s&#39;表示要加密输入的字符串,并将加密后的内容写入到文件</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">157</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入要功能选项并按回车，输入&#39;f&#39;表示要加密文件</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">158</span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;输入&#39;p&#39;表示要解密文件</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">159</span>	<span class="kt">char</span> <span class="n">c</span><span class="p">;</span>
<span class="ln">160</span>	<span class="k">if</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">161</span>		<span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;s&#39;</span><span class="p">)</span>
<span class="ln">162</span>			<span class="n">aesStrToFile</span><span class="p">(</span><span class="n">key</span><span class="p">);</span><span class="c1">//用AES加密字符串，并将字符串写进文件中
</span><span class="ln">163</span><span class="c1"></span>		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;p&#39;</span><span class="p">)</span>
<span class="ln">164</span>			<span class="n">deAesFile</span><span class="p">(</span><span class="n">key</span><span class="p">);</span><span class="c1">//把文件中的密文解密，并写回文件中
</span><span class="ln">165</span><span class="c1"></span>		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="sc">&#39;f&#39;</span><span class="p">)</span><span class="c1">//用AES加密文件
</span><span class="ln">166</span><span class="c1"></span>			<span class="n">aesFile</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="ln">167</span>	<span class="p">}</span>
<span class="ln">168</span>	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="ln">169</span><span class="p">}</span>
</code></pre></div><p>通过下面的gcc命令来编译运行：</p>
<div class="highlight"><pre class="chroma"><code class="language-shell" data-lang="shell"><span class="ln">1</span>gcc -o aes aes.c main.c
</code></pre></div><h1 id="5总结">5总结</h1>
<p><a href="https://so.csdn.net/so/search?q=%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86&amp;spm=1001.2101.3001.7020">高级加密标准</a>(AES,Advanced Encryption Standard)为最常见的对称加密算法(微信小程序加密传输就是用这个加密算法的)。对称加密算法也就是加密和解密用相同的密钥。总的来说介绍了最基本的AES的ecb的加密模式，另外还有具体的demo可以作为学习参考，不过除此之外AES还会跟<code>base64</code>相结合。</p>
<h1 id="参考">参考</h1>
<p><a href="https://blog.csdn.net/qq_28205153/article/details/55798628">[1] TimeShatter, AES加密算法原理的详细介绍与实现, 2023.</a></p>
<p><a href="https://blog.csdn.net/qq_19782019/article/details/88117150">[2] 刘扬俊, 什么是Base64算法？——全网最详细讲解, 2023.</a></p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">标签</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/%E5%8A%A0%E5%AF%86/">加密</a>

  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/%E8%A7%A3%E5%AF%86/">解密</a>

  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/base64/">BASE64</a>

  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/aes128/">AES128</a>

  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/aes192/">AES192</a>

  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/aes256/">AES256</a>

  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/%E8%BD%AE%E5%AF%86%E9%92%A5%E5%8A%A0/">轮密钥加</a>

  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/%E5%88%97%E6%B7%B7%E6%B7%86/">列混淆</a>

  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/%E5%AD%97%E8%8A%82%E4%BB%A3%E6%8D%A2/">字节代换</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yangyang48.github.io/2023/11/%E5%A3%B0%E5%AD%A6%E7%9B%B8%E5%85%B3/" data-tooltip="声学相关">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">下一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yangyang48.github.io/2023/08/selectpollepoll%E8%BF%99%E4%B8%89%E7%A7%8D%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E7%9A%84%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86/" data-tooltip="select、poll、epoll这三种多路复用的技术原理">
              
                  <span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
		
		<div class="post-comment main-content-wrap">
		
  
  <div id="vcomments"></div>
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <script type="text/javascript">
    new Valine({
        el: '#vcomments' ,
        appId: 'mwl8M1aQzLnRE6JIpIY3sgE5-9Nh9j0Va',
        appKey: 'mPGr6GMC0BuzAKkxinnd0IAr',
        notify:  true , 
        verify:  false , 
        avatar:'retro', 
        placeholder: '欢迎各位宝宝留言~',
        visitor:  true 
    });
  </script>

		</div>
        <footer id="footer" class="main-content-wrap">
  
  
  
  <span class="copyrights">
    &copy; 2023 Yang Ju. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yangyang48.github.io/2023/11/%E5%A3%B0%E5%AD%A6%E7%9B%B8%E5%85%B3/" data-tooltip="声学相关">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">下一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yangyang48.github.io/2023/08/selectpollepoll%E8%BF%99%E4%B8%89%E7%A7%8D%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E7%9A%84%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86/" data-tooltip="select、poll、epoll这三种多路复用的技术原理">
              
                  <span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fyangyang48.github.io%2F2023%2F10%2Faes%25E5%258A%25A0%25E5%25AF%2586%25E5%2592%258C%25E8%25A7%25A3%25E5%25AF%2586%25E6%25B5%2581%25E7%25A8%258B%2F">
          <i class="fa fa-facebook-official"></i><span>分享到 Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fyangyang48.github.io%2F2023%2F10%2Faes%25E5%258A%25A0%25E5%25AF%2586%25E5%2592%258C%25E8%25A7%25A3%25E5%25AF%2586%25E6%25B5%2581%25E7%25A8%258B%2F">
          <i class="fa fa-twitter"></i><span>分享到 Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3A%2F%2Fyangyang48.github.io%2F2023%2F10%2Faes%25E5%258A%25A0%25E5%25AF%2586%25E5%2592%258C%25E8%25A7%25A3%25E5%25AF%2586%25E6%25B5%2581%25E7%25A8%258B%2F">
          <i class="fa fa-google-plus"></i><span>分享到 Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://yangyang48.github.io/thumb/20210711204627625.jpg" alt="作者的图片" />
    
    <h4 id="about-card-name">Yang Ju</h4>
    
      <div id="about-card-bio">Nanjing University of Science and Technology</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Software Development Engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        NanJing,China
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://yangyang48.github.io/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://yangyang48.github.io/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


  
    <script src="https://yangyang48.github.io/js/copy-to-clipboard.js"></script>
  

<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'https:\/\/yangyang48.github.io\/2023\/10\/aes%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86%E6%B5%81%E7%A8%8B\/';
          
            this.page.identifier = '\/2023\/10\/aes%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86%E6%B5%81%E7%A8%8B\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'hugo-tranquilpeak-theme';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

