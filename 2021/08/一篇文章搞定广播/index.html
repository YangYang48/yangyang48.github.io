<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.85.0 with theme Tranquilpeak 0.4.8-BETA">
<meta name="author" content="Yang Ju">
<meta name="keywords" content="">
<meta name="description" content="BroadcastReceiver，Android四大组件之一。
用于响应来自其他应用程序或者系统的广播消息。这些消息有时被称为事件或者意图。">


<meta property="og:description" content="BroadcastReceiver，Android四大组件之一。
用于响应来自其他应用程序或者系统的广播消息。这些消息有时被称为事件或者意图。">
<meta property="og:type" content="article">
<meta property="og:title" content="一篇文章搞定广播">
<meta name="twitter:title" content="一篇文章搞定广播">
<meta property="og:url" content="https://yangyang48.github.io/2021/08/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E5%AE%9A%E5%B9%BF%E6%92%AD/">
<meta property="twitter:url" content="https://yangyang48.github.io/2021/08/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E5%AE%9A%E5%B9%BF%E6%92%AD/">
<meta property="og:site_name" content="欢迎来到我的博客~">
<meta property="og:description" content="BroadcastReceiver，Android四大组件之一。
用于响应来自其他应用程序或者系统的广播消息。这些消息有时被称为事件或者意图。">
<meta name="twitter:description" content="BroadcastReceiver，Android四大组件之一。
用于响应来自其他应用程序或者系统的广播消息。这些消息有时被称为事件或者意图。">
<meta property="og:locale" content="zh-cn">

  
    <meta property="article:published_time" content="2021-08-14T00:00:00">
  
  
    <meta property="article:modified_time" content="2021-08-14T00:00:00">
  
  
  
    
      <meta property="article:section" content="BroadcastReceiver">
    
      <meta property="article:section" content="2021">
    
      <meta property="article:section" content="August">
    
  
  
    
      <meta property="article:tag" content="Android">
    
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://yangyang48.github.io/broadcast/receiver_thumb.png">
  <meta property="twitter:image" content="https://yangyang48.github.io/broadcast/receiver_thumb.png">


  <meta property="og:image" content="https://yangyang48.github.io/broadcast/receiver_cover_2.jpg">
  <meta property="twitter:image" content="https://yangyang48.github.io/broadcast/receiver_cover_2.jpg">




  <meta property="og:image" content="https://img-blog.csdnimg.cn/20210711204627625.jpg">
  <meta property="twitter:image" content="https://img-blog.csdnimg.cn/20210711204627625.jpg">


    <title>一篇文章搞定广播</title>

    <link rel="icon" href="https://yangyang48.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://yangyang48.github.io/2021/08/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E5%AE%9A%E5%B9%BF%E6%92%AD/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://yangyang48.github.io/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://yangyang48.github.io/css/copy-to-clipboard.css">
      
    

    
      
    
    

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://yangyang48.github.io/">欢迎来到我的博客~</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://yangyang48.github.io/#about">
    
    
    
      
        <img class="header-picture" src="https://img-blog.csdnimg.cn/20210711204627625.jpg" alt="作者的图片" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://yangyang48.github.io/#about">
          <img class="sidebar-profile-picture" src="https://img-blog.csdnimg.cn/20210711204627625.jpg" alt="作者的图片" />
        </a>
        <h4 class="sidebar-profile-name">Yang Ju</h4>
        
          <h5 class="sidebar-profile-bio">Nanjing University of Science and Technology</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">首页</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">分类</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">标签</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">归档</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yangyang48.github.io/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">关于</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/YangYang48" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://blog.csdn.net/yangju147532896" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-chain"></i>
      
      <span class="sidebar-button-desc">CSDN</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              "
       style="background-image:url('/broadcast/receiver_cover_2.jpg')"
       data-behavior="4">
    
  </div>


      <div id="main" data-behavior="4"
        class="hasCover
               hasCoverMetaOut
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      一篇文章搞定广播
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2021-08-14T00:00:00Z">
        
  八月 14, 2021

      </time>
    
    
  
  
    <span>发布在</span>
    
      <a class="category-link" href="https://yangyang48.github.io/categories/broadcastreceiver">BroadcastReceiver</a>, 
    
      <a class="category-link" href="https://yangyang48.github.io/categories/2021">2021</a>, 
    
      <a class="category-link" href="https://yangyang48.github.io/categories/august">August</a>
    
  

  </div>

</div>
          
		  
		  <h5 id="wc" style="font-size: 1rem;text-align: center;">2200 Words|Read in about 10 Min|本文总阅读量<span id="busuanzi_value_page_pv"></span>次</h5>
		  
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>BroadcastReceiver，Android四大组件之一。
用于响应来自其他应用程序或者系统的广播消息。这些消息有时被称为事件或者意图。</p>
<h1 id="开篇问题">开篇问题</h1>
<p><strong>1.广播的用途</strong></p>
<p><strong>2.有序广播是全局广播吗</strong></p>
<p><strong>3.如何adb手动发送广播</strong></p>
<h1 id="广播和广播接收器">广播和广播接收器</h1>
<p>笔者在10年的时候去了上海世博会，非常壮观。有各种各样的人，外国人也很多。但是问题来了，由于当天旅客很多，小孩子东跑来西跑去，很容易走丢。这个时候经常会听到广播，寻人启事，家长找不到孩子xx，请听到广播的xx，速到广播中心。那么抽象到android，寻人启事得广播就是广播中心的人发出去的，然后在世博会中所有的旅客都能接收到广播，但只有xx小朋友接收到广播后才有去广播中心的行动。</p>
<h2 id="广播的两种注册方式">广播的两种注册方式</h2>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/broadcast/broadcast2.png" title="广播的两种注册方式" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/broadcast/broadcast2.png"  alt="广播的两种注册方式">
  
    </a>
  
   
    <span class="caption">广播的两种注册方式</span>
  
</div>

<h2 id="广播的两种类型">广播的两种类型</h2>


 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://yangyang48.github.io/broadcast/broadcast1.png" title="广播的两种类型" data-fancybox-group="">
  
    <img class="fig-img" src="https://yangyang48.github.io/broadcast/broadcast1.png"  alt="广播的两种类型">
  
    </a>
  
   
    <span class="caption">广播的两种类型</span>
  
</div>

<h1 id="动态注册">动态注册</h1>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="ln"> 1</span><span class="c1">//动态注册
</span><span class="ln"> 2</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">AppCompatActivity</span> <span class="o">{</span>
<span class="ln"> 3</span>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">&#34;MainActivity&#34;</span><span class="o">;</span>
<span class="ln"> 4</span>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">MY_DYNAMIC_BROADCAST</span> <span class="o">=</span> <span class="s">&#34;android.intent.action.dynamicBroadcast&#34;</span><span class="o">;</span>
<span class="ln"> 5</span>
<span class="ln"> 6</span>    <span class="nd">@Override</span>
<span class="ln"> 7</span>    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
<span class="ln"> 8</span>        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
<span class="ln"> 9</span>        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
<span class="ln">10</span>
<span class="ln">11</span>        <span class="n">initBroadcast</span><span class="o">();</span>
<span class="ln">12</span>    <span class="o">}</span>
<span class="ln">13</span>
<span class="ln">14</span>    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initBroadcast</span><span class="o">()</span>
<span class="ln">15</span>    <span class="o">{</span>
<span class="ln">16</span>        <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span> <span class="o">,</span><span class="s">&#34;-&gt;initBroadcast&#34;</span><span class="o">);</span>
<span class="ln">17</span>        <span class="n">IntentFilter</span> <span class="n">itFilter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntentFilter</span><span class="o">();</span>
<span class="ln">18</span>        <span class="n">itFilter</span><span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="n">MY_DYNAMIC_BROADCAST</span><span class="o">);</span>
<span class="ln">19</span>        <span class="n">registerReceiver</span><span class="o">(</span><span class="n">dynamicBroadcast</span><span class="o">,</span> <span class="n">itFilter</span><span class="o">);</span>
<span class="ln">20</span>    <span class="o">}</span>
<span class="ln">21</span>
<span class="ln">22</span>    <span class="c1">//别忘了将广播取消掉哦~
</span><span class="ln">23</span><span class="c1"></span>    <span class="nd">@Override</span>
<span class="ln">24</span>    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onDestroy</span><span class="o">()</span> <span class="o">{</span>
<span class="ln">25</span>        <span class="kd">super</span><span class="o">.</span><span class="na">onDestroy</span><span class="o">();</span>
<span class="ln">26</span>        <span class="n">unregisterReceiver</span><span class="o">(</span><span class="n">dynamicBroadcast</span><span class="o">);</span>
<span class="ln">27</span>    <span class="o">}</span>
<span class="ln">28</span>
<span class="ln">29</span>    <span class="cm">/**
</span><span class="ln">30</span><span class="cm">     * 匿名内部类
</span><span class="ln">31</span><span class="cm">     * adb发送给广播
</span><span class="ln">32</span><span class="cm">     * adb shell am broadcast -a android.intent.action.dynamicBroadcast --es &#34;myString&#34; &#34;dynamicBroadcast successed&#34;
</span><span class="ln">33</span><span class="cm">     */</span>
<span class="ln">34</span>    <span class="kd">private</span> <span class="n">BroadcastReceiver</span> <span class="n">dynamicBroadcast</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BroadcastReceiver</span><span class="o">()</span> <span class="o">{</span>
<span class="ln">35</span>        <span class="nd">@Override</span>
<span class="ln">36</span>        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">37</span>            <span class="k">if</span> <span class="o">(</span><span class="n">MY_DYNAMIC_BROADCAST</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">()))</span>
<span class="ln">38</span>            <span class="o">{</span>
<span class="ln">39</span>                <span class="n">String</span> <span class="n">myString</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getStringExtra</span><span class="o">(</span><span class="s">&#34;myString&#34;</span><span class="o">);</span>
<span class="ln">40</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;dynamicBroadcast receiver has receive, mystring is &#34;</span><span class="o">+</span><span class="n">myString</span><span class="o">);</span>
<span class="ln">41</span>                <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">&#34;-&gt;dynamicBroadcast receiver has receive, mystring is &#34;</span><span class="o">+</span><span class="n">myString</span><span class="o">,</span><span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
<span class="ln">42</span>            <span class="o">}</span>
<span class="ln">43</span>        <span class="o">}</span>
<span class="ln">44</span>    <span class="o">};</span>
<span class="ln">45</span><span class="o">}</span>
</code></pre></div><p>有一个动态注册的特例，即在app内部的广播，<strong>本地广播</strong>。</p>
<h2 id="本地广播">本地广播</h2>
<p><strong>本地广播无法通过静态注册方式来接受</strong>，该机制发出的广播只会在APP内部传播，而且 广播接收者也只能收到本应用发出的广播，但是androidx已经废弃，目前还是使用动态广播通过参数指定组件名，即可替代原本的本地广播。</p>
<h1 id="静态注册">静态注册</h1>
<p>8.0版本之后的，非系统广播仅在清单中声明接收器是不行的。</p>
<p>如果需要自定义广播，还需要使用动态广播。</p>
<p>通常用于监听系统广播，比如开机广播</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="ln"> 1</span><span class="c">&lt;!--注册静态广播--&gt;</span>
<span class="ln"> 2</span>        <span class="nt">&lt;receiver</span> <span class="na">android:name=</span><span class="s">&#34;.MyBootReceiver&#34;</span>
<span class="ln"> 3</span>            <span class="na">android:enabled=</span><span class="s">&#34;true&#34;</span>
<span class="ln"> 4</span>            <span class="na">android:exported=</span><span class="s">&#34;true&#34;</span><span class="nt">&gt;</span>
<span class="ln"> 5</span>            <span class="nt">&lt;intent-filter&gt;</span>
<span class="ln"> 6</span>                <span class="nt">&lt;action</span> <span class="na">android:name =</span> <span class="s">&#34;android.intent.action.BOOT_COMPLETED&#34;</span><span class="nt">/&gt;</span>
<span class="ln"> 7</span>            <span class="nt">&lt;/intent-filter&gt;</span>
<span class="ln"> 8</span>            <span class="c">&lt;!--装载SD卡--&gt;</span>
<span class="ln"> 9</span>            <span class="nt">&lt;intent-filter&gt;</span>
<span class="ln">10</span>                <span class="c">&lt;!-- SD卡已经成功挂载   --&gt;</span>
<span class="ln">11</span>                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.MEDIA_MOUNTED&#34;</span> <span class="nt">/&gt;</span>
<span class="ln">12</span>                <span class="c">&lt;!-- sd卡存在，但还没有挂载   --&gt;</span>
<span class="ln">13</span>                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.MEDIA_UNMOUNTED&#34;</span> <span class="nt">/&gt;</span>
<span class="ln">14</span>
<span class="ln">15</span>                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.MEDIA_EJECT&#34;</span> <span class="nt">/&gt;</span>
<span class="ln">16</span>                <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">&#34;file&#34;</span> <span class="nt">/&gt;</span>
<span class="ln">17</span>            <span class="nt">&lt;/intent-filter&gt;</span>
<span class="ln">18</span>        <span class="nt">&lt;/receiver&gt;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="ln"> 1</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBootReceiver</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
<span class="ln"> 2</span>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">&#34;MyBootReceiver&#34;</span><span class="o">;</span>
<span class="ln"> 3</span>    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">ACTION_BOOT</span> <span class="o">=</span> <span class="s">&#34;android.intent.action.BOOT_COMPLETED&#34;</span><span class="o">;</span>
<span class="ln"> 4</span>
<span class="ln"> 5</span>
<span class="ln"> 6</span>    <span class="nd">@Override</span>
<span class="ln"> 7</span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln"> 8</span>        <span class="k">if</span> <span class="o">(</span><span class="n">ACTION_BOOT</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">()))</span>
<span class="ln"> 9</span>        <span class="o">{</span>
<span class="ln">10</span>            <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;boot receiver get&#34;</span><span class="o">+</span><span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_BOOT_COMPLETED</span><span class="o">);</span>
<span class="ln">11</span>            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">&#34;开机完毕~&#34;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
<span class="ln">12</span>        <span class="o">}</span>
<span class="ln">13</span>    <span class="o">}</span>
<span class="ln">14</span><span class="o">}</span>
</code></pre></div><h1 id="标准广播">标准广播</h1>
<p>这里添加了两个地方，一个是AndroidManifest.xml注册，且在主activity里动态注册</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="ln">1</span><span class="c">&lt;!--七夕广播注册--&gt;</span>
<span class="ln">2</span>        <span class="nt">&lt;receiver</span> <span class="na">android:name=</span><span class="s">&#34;.MyTanabataReceiver&#34;</span>
<span class="ln">3</span>            <span class="na">android:enabled=</span><span class="s">&#34;true&#34;</span>
<span class="ln">4</span>            <span class="na">android:exported=</span><span class="s">&#34;true&#34;</span><span class="nt">&gt;</span>
<span class="ln">5</span>            <span class="nt">&lt;intent-filter&gt;</span>
<span class="ln">6</span>                <span class="nt">&lt;action</span> <span class="na">android:name =</span> <span class="s">&#34;android.intent.action.SENDLOVE&#34;</span><span class="nt">/&gt;</span>
<span class="ln">7</span>            <span class="nt">&lt;/intent-filter&gt;</span>
<span class="ln">8</span>        <span class="nt">&lt;/receiver&gt;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="ln">1</span><span class="c1">//七夕动态注册
</span><span class="ln">2</span><span class="c1"></span><span class="n">myTanabataReceiver</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyTanabataReceiver</span><span class="o">();</span>
<span class="ln">3</span><span class="n">IntentFilter</span> <span class="n">intentFilter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntentFilter</span><span class="o">();</span>
<span class="ln">4</span><span class="n">intentFilter</span><span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="n">MyTanabataReceiver</span><span class="o">.</span><span class="na">ACTION_SENDLOVE</span><span class="o">);</span>
<span class="ln">5</span><span class="n">registerReceiver</span><span class="o">(</span><span class="n">myTanabataReceiver</span><span class="o">,</span> <span class="n">intentFilter</span><span class="o">);</span>
</code></pre></div><p>实现七夕的广播接收器</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="ln"> 1</span><span class="c1">//七夕节广播
</span><span class="ln"> 2</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyTanabataReceiver</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
<span class="ln"> 3</span>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">&#34;MyTanabataReceiver&#34;</span><span class="o">;</span>
<span class="ln"> 4</span>    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">ACTION_SENDLOVE</span> <span class="o">=</span> <span class="s">&#34;android.intent.action.SENDLOVE&#34;</span><span class="o">;</span>
<span class="ln"> 5</span>
<span class="ln"> 6</span>    <span class="nd">@Override</span>
<span class="ln"> 7</span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln"> 8</span>        <span class="k">if</span> <span class="o">(</span><span class="n">ACTION_SENDLOVE</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">()))</span> <span class="o">{</span>
<span class="ln"> 9</span>            <span class="c1">//adb 发广播
</span><span class="ln">10</span><span class="c1"></span>            <span class="c1">//adb shell am broadcast -a android.intent.action.SENDLOVE -n com.example.broadcast/.MyTanabataReceiver
</span><span class="ln">11</span><span class="c1"></span>            <span class="c1">// --es &#34;love&#34; &#34;爱你&#34; --ei &#34;days&#34; 10000
</span><span class="ln">12</span><span class="c1"></span>            <span class="n">String</span> <span class="n">myloveString</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getStringExtra</span><span class="o">(</span><span class="s">&#34;love&#34;</span><span class="o">);</span>
<span class="ln">13</span>            <span class="kt">int</span> <span class="n">myloveInt</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getIntExtra</span><span class="o">(</span><span class="s">&#34;days&#34;</span><span class="o">,</span> <span class="o">-</span><span class="n">1</span><span class="o">);</span>
<span class="ln">14</span>            <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;myloveString = &#34;</span> <span class="o">+</span> <span class="n">myloveString</span> <span class="o">+</span> <span class="s">&#34; myloveInt = &#34;</span> <span class="o">+</span> <span class="n">myloveInt</span><span class="o">);</span>
<span class="ln">15</span>            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">&#34;播放黄老板的【perfect】\n\t&#34;</span> <span class="o">+</span> <span class="n">myloveString</span> <span class="o">+</span> <span class="n">myloveInt</span> <span class="o">+</span> <span class="s">&#34;年&#34;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
<span class="ln">16</span>        <span class="o">}</span>
<span class="ln">17</span>    <span class="o">}</span>
<span class="ln">18</span><span class="o">}</span>
</code></pre></div><h1 id="有序广播">有序广播</h1>
<p>跟设计模式中的责任链模式类似。<strong>静态注册接收有序广播（Android8.0后不支持）</strong>，因此下面罗列的都是动态注册的有序广播。有序广播必须按照广播优先级来按顺序依次发送，且发送过程中接收到的广播接收器可以选择中断发送广播，也可以继续发送并且修改数据。</p>
<p>动态注册，并设置优先级</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="ln"> 1</span><span class="c1">//动态注册有序广播
</span><span class="ln"> 2</span><span class="c1">//有序广播需要设置优先级-1000-1000，值越大优先级越高
</span><span class="ln"> 3</span><span class="c1"></span><span class="n">orderedReceiver1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrderedReceiver1</span><span class="o">();</span>
<span class="ln"> 4</span><span class="n">IntentFilter</span> <span class="n">orderedfilter1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntentFilter</span><span class="o">();</span>
<span class="ln"> 5</span><span class="n">orderedfilter1</span><span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="n">MY_ORDERED_BROADCAST</span><span class="o">);</span>
<span class="ln"> 6</span><span class="n">orderedfilter1</span><span class="o">.</span><span class="na">setPriority</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>
<span class="ln"> 7</span><span class="k">this</span><span class="o">.</span><span class="na">registerReceiver</span><span class="o">(</span><span class="n">orderedReceiver1</span><span class="o">,</span> <span class="n">orderedfilter1</span><span class="o">);</span>
<span class="ln"> 8</span>
<span class="ln"> 9</span><span class="n">orderedReceiver2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrderedReceiver2</span><span class="o">();</span>
<span class="ln">10</span><span class="n">IntentFilter</span> <span class="n">orderedfilter2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntentFilter</span><span class="o">();</span>
<span class="ln">11</span><span class="n">orderedfilter2</span><span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="n">MY_ORDERED_BROADCAST</span><span class="o">);</span>
<span class="ln">12</span><span class="n">orderedfilter2</span><span class="o">.</span><span class="na">setPriority</span><span class="o">(</span><span class="n">999</span><span class="o">);</span>
<span class="ln">13</span><span class="k">this</span><span class="o">.</span><span class="na">registerReceiver</span><span class="o">(</span><span class="n">orderedReceiver2</span><span class="o">,</span> <span class="n">orderedfilter2</span><span class="o">);</span>
<span class="ln">14</span>
<span class="ln">15</span><span class="n">orderedReceiver3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrderedReceiver3</span><span class="o">();</span>
<span class="ln">16</span><span class="n">IntentFilter</span> <span class="n">orderedfilter3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntentFilter</span><span class="o">();</span>
<span class="ln">17</span><span class="n">orderedfilter3</span><span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="n">MY_ORDERED_BROADCAST</span><span class="o">);</span>
<span class="ln">18</span><span class="n">orderedfilter3</span><span class="o">.</span><span class="na">setPriority</span><span class="o">(</span><span class="n">998</span><span class="o">);</span>
<span class="ln">19</span><span class="k">this</span><span class="o">.</span><span class="na">registerReceiver</span><span class="o">(</span><span class="n">orderedReceiver3</span><span class="o">,</span> <span class="n">orderedfilter3</span><span class="o">);</span>
</code></pre></div><p>自定义三个有序广播接收器</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="ln"> 1</span><span class="cm">/**
</span><span class="ln"> 2</span><span class="cm">* 有序广播接收1，优先级1000
</span><span class="ln"> 3</span><span class="cm">*/</span>
<span class="ln"> 4</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderedReceiver1</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
<span class="ln"> 5</span>    <span class="nd">@Override</span>
<span class="ln"> 6</span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln"> 7</span>        <span class="k">if</span> <span class="o">(</span><span class="n">MY_ORDERED_BROADCAST</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">()))</span>
<span class="ln"> 8</span>        <span class="o">{</span>
<span class="ln"> 9</span>            <span class="kt">boolean</span> <span class="n">orderedBroadcast</span> <span class="o">=</span> <span class="n">isOrderedBroadcast</span><span class="o">();</span>
<span class="ln">10</span>            <span class="k">if</span> <span class="o">(</span><span class="n">orderedBroadcast</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">11</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;Priority 1000 is orderedBroadcast&#34;</span><span class="o">);</span>
<span class="ln">12</span>            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<span class="ln">13</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;Priority 1000 is not orderedBroadcast&#34;</span><span class="o">);</span>
<span class="ln">14</span>                <span class="n">abortBroadcast</span><span class="o">();</span>
<span class="ln">15</span>            <span class="o">}</span>
<span class="ln">16</span>            <span class="n">String</span> <span class="n">resultData</span> <span class="o">=</span> <span class="n">getResultData</span><span class="o">();</span>
<span class="ln">17</span>            <span class="k">if</span> <span class="o">(</span><span class="kc">null</span> <span class="o">!=</span> <span class="n">resultData</span><span class="o">)</span>
<span class="ln">18</span>            <span class="o">{</span>
<span class="ln">19</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;OrderedReceiver1|resultData = &#34;</span><span class="o">+</span><span class="n">resultData</span><span class="o">);</span>
<span class="ln">20</span>                <span class="c1">//有序广播里终止广播
</span><span class="ln">21</span><span class="c1"></span>                <span class="c1">//abortBroadcast();
</span><span class="ln">22</span><span class="c1"></span>                <span class="n">setResultData</span><span class="o">(</span><span class="s">&#34;有序广播1收到，传达给有序广播2&#34;</span><span class="o">);</span>
<span class="ln">23</span>                <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">&#34;有序广播接收1的内容：&#34;</span><span class="o">+</span><span class="n">resultData</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
<span class="ln">24</span>            <span class="o">}</span><span class="k">else</span>
<span class="ln">25</span>            <span class="o">{</span>
<span class="ln">26</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;OrderedReceiver1&#34;</span><span class="o">);</span>
<span class="ln">27</span>                <span class="c1">//有序广播里终止广播
</span><span class="ln">28</span><span class="c1"></span>                <span class="c1">//abortBroadcast();
</span><span class="ln">29</span><span class="c1"></span>                <span class="n">setResultData</span><span class="o">(</span><span class="s">&#34;有序广播1收到，传达给有序广播2&#34;</span><span class="o">);</span>
<span class="ln">30</span>                <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">&#34;有序广播接收1的内容：&#34;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
<span class="ln">31</span>            <span class="o">}</span>
<span class="ln">32</span>
<span class="ln">33</span>        <span class="o">}</span>
<span class="ln">34</span>    <span class="o">}</span>
<span class="ln">35</span><span class="o">}</span>
<span class="ln">36</span>
<span class="ln">37</span><span class="cm">/**
</span><span class="ln">38</span><span class="cm">* 有序广播接收2，优先级999
</span><span class="ln">39</span><span class="cm">*/</span>
<span class="ln">40</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderedReceiver2</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
<span class="ln">41</span>    <span class="nd">@Override</span>
<span class="ln">42</span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">43</span>        <span class="k">if</span> <span class="o">(</span><span class="n">MY_ORDERED_BROADCAST</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">()))</span>
<span class="ln">44</span>        <span class="o">{</span>
<span class="ln">45</span>            <span class="kt">boolean</span> <span class="n">orderedBroadcast</span> <span class="o">=</span> <span class="n">isOrderedBroadcast</span><span class="o">();</span>
<span class="ln">46</span>            <span class="k">if</span> <span class="o">(</span><span class="n">orderedBroadcast</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">47</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;Priority 999 is orderedBroadcast&#34;</span><span class="o">);</span>
<span class="ln">48</span>            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<span class="ln">49</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;Priority 999 is not orderedBroadcast&#34;</span><span class="o">);</span>
<span class="ln">50</span>                <span class="n">abortBroadcast</span><span class="o">();</span>
<span class="ln">51</span>            <span class="o">}</span>
<span class="ln">52</span>            <span class="n">String</span> <span class="n">resultData</span> <span class="o">=</span> <span class="n">getResultData</span><span class="o">();</span>
<span class="ln">53</span>            <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;OrderedReceiver2|resultData = &#34;</span><span class="o">+</span><span class="n">resultData</span><span class="o">);</span>
<span class="ln">54</span>            <span class="c1">//有序广播里终止广播
</span><span class="ln">55</span><span class="c1"></span>            <span class="c1">//abortBroadcast();
</span><span class="ln">56</span><span class="c1"></span>            <span class="n">setResultData</span><span class="o">(</span><span class="s">&#34;有序广播2收到，传达给有序广播3&#34;</span><span class="o">);</span>
<span class="ln">57</span>            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">&#34;有序广播接收2的内容：&#34;</span><span class="o">+</span><span class="n">resultData</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
<span class="ln">58</span>        <span class="o">}</span>
<span class="ln">59</span>    <span class="o">}</span>
<span class="ln">60</span><span class="o">}</span>
<span class="ln">61</span>
<span class="ln">62</span><span class="cm">/**
</span><span class="ln">63</span><span class="cm">* 有序广播接收3，优先级998
</span><span class="ln">64</span><span class="cm">*/</span>
<span class="ln">65</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderedReceiver3</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="o">{</span>
<span class="ln">66</span>    <span class="nd">@Override</span>
<span class="ln">67</span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">68</span>        <span class="k">if</span> <span class="o">(</span><span class="n">MY_ORDERED_BROADCAST</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">()))</span>
<span class="ln">69</span>        <span class="o">{</span>
<span class="ln">70</span>            <span class="kt">boolean</span> <span class="n">orderedBroadcast</span> <span class="o">=</span> <span class="n">isOrderedBroadcast</span><span class="o">();</span>
<span class="ln">71</span>            <span class="k">if</span> <span class="o">(</span><span class="n">orderedBroadcast</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">72</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;Priority 998 is orderedBroadcast&#34;</span><span class="o">);</span>
<span class="ln">73</span>            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<span class="ln">74</span>                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;Priority 998 is not orderedBroadcast&#34;</span><span class="o">);</span>
<span class="ln">75</span>                <span class="n">abortBroadcast</span><span class="o">();</span>
<span class="ln">76</span>            <span class="o">}</span>
<span class="ln">77</span>            <span class="n">String</span> <span class="n">resultData</span> <span class="o">=</span> <span class="n">getResultData</span><span class="o">();</span>
<span class="ln">78</span>            <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&#34;-&gt;OrderedReceiver3|resultData = &#34;</span><span class="o">+</span><span class="n">resultData</span><span class="o">);</span>
<span class="ln">79</span>            <span class="c1">//有序广播里终止广播
</span><span class="ln">80</span><span class="c1"></span>            <span class="c1">//abortBroadcast();
</span><span class="ln">81</span><span class="c1"></span>            <span class="n">setResultData</span><span class="o">(</span><span class="s">&#34;有序广播3收到，继续传递&#34;</span><span class="o">);</span>
<span class="ln">82</span>            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="s">&#34;有序广播接收3的内容：&#34;</span><span class="o">+</span><span class="n">resultData</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
<span class="ln">83</span>        <span class="o">}</span>
<span class="ln">84</span>    <span class="o">}</span>
<span class="ln">85</span><span class="o">}</span>
</code></pre></div><p>发送有序广播</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="ln">1</span><span class="c1">//发送有序广播
</span><span class="ln">2</span><span class="c1"></span><span class="n">Intent</span> <span class="n">OrderedIntent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MY_ORDERED_BROADCAST</span><span class="o">);</span>
<span class="ln">3</span>                <span class="n">sendOrderedBroadcast</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">OrderedReceiver3</span><span class="o">(),</span> <span class="kc">null</span><span class="o">,</span>
<span class="ln">4</span>                        <span class="n">Activity</span><span class="o">.</span><span class="na">RESULT_OK</span><span class="o">,</span> <span class="s">&#34;现在发送有序广播给有序广播1&#34;</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</code></pre></div><p>有序广播发送参数</p>
<blockquote>
<p>Parameters
intent The Intent to broadcast; all receivers matching this Intent will receive the broadcast.
receiverPermission String naming a permissions that a receiver must hold in order to receive your broadcast. If null, no permission is required.
resultReceiver Your own BroadcastReceiver to treat as the final receiver of the broadcast.
scheduler  A custom Handler with which to schedule the resultReceiver callback; if null it will be scheduled in the Context&rsquo;s main thread.
initialCode    An initial value for the result code. Often Activity.RESULT_OK.
initialData    An initial value for the result data. Often null.
initialExtras  An initial value for the result extras. Often null.</p>
<p>翻译一下</p>
<p><strong>intent</strong>：不多说指定intent，所有广播接收者的匹配规则</p>
<p><strong>receiverPermission</strong>：指定广播接收器的权限，一般自定义，不常用，可传null。</p>
<p><strong>resultReceiver</strong>：指定一个最终的广播接收器</p>
<p><strong>scheduler</strong>：调度器，一般传null。</p>
<p><strong>initialCode</strong>：指定一个code，一般传Activity.RESULT_OK。</p>
<p><strong>initialData</strong>：传一个字符串数据。对应的在BroadcastReceiver中通过getResultData()取得数据</p>
<p><strong>initialExtras</strong>：传一个Bundle对象，也就是可以传多种类型的数据。对应的在BroadcastReceiver中通过Bundle bundle = getResultExtras(false)取得Bundle对象</p>
</blockquote>
<h1 id="broadcastreceiver变体">BroadcastReceiver变体</h1>
<p><a href="https://github.com/iFLYOS-OPEN/ShowCore-Open">iflyos</a>开发者们还集成了kotlin的方式，使得BroadcastReceiver使用更为方便</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="ln"> 1</span><span class="k">abstract</span> <span class="k">class</span> <span class="nc">SelfBroadcastReceiver</span><span class="p">(</span><span class="k">vararg</span> <span class="n">actions</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">:</span> <span class="n">BroadcastReceiver</span><span class="p">()</span> <span class="p">{</span>
<span class="ln"> 2</span>
<span class="ln"> 3</span>    <span class="k">private</span> <span class="k">val</span> <span class="py">filter</span> <span class="p">=</span> <span class="n">IntentFilter</span><span class="p">()</span>
<span class="ln"> 4</span>
<span class="ln"> 5</span>    <span class="k">private</span> <span class="k">var</span> <span class="py">registered</span> <span class="p">=</span> <span class="k">false</span>
<span class="ln"> 6</span>
<span class="ln"> 7</span>    <span class="k">init</span> <span class="p">{</span>
<span class="ln"> 8</span>        <span class="k">for</span> <span class="p">(</span><span class="n">action</span> <span class="k">in</span> <span class="n">actions</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 9</span>            <span class="n">filter</span><span class="p">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="ln">10</span>        <span class="p">}</span>
<span class="ln">11</span>    <span class="p">}</span>
<span class="ln">12</span>
<span class="ln">13</span>    <span class="k">protected</span> <span class="k">abstract</span> <span class="k">fun</span> <span class="nf">onReceiveAction</span><span class="p">(</span><span class="n">action</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="n">intent</span><span class="p">:</span> <span class="n">Intent</span><span class="p">)</span>
<span class="ln">14</span>
<span class="ln">15</span>    <span class="k">fun</span> <span class="nf">getFilter</span><span class="p">()</span> <span class="p">=</span> <span class="n">filter</span>
<span class="ln">16</span>
<span class="ln">17</span>    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onReceive</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">intent</span><span class="p">:</span> <span class="n">Intent</span><span class="p">?)</span> <span class="p">{</span>
<span class="ln">18</span>        <span class="n">intent</span> <span class="o">?:</span> <span class="k">return</span>
<span class="ln">19</span>        <span class="k">val</span> <span class="py">action</span> <span class="p">=</span> <span class="n">intent</span><span class="p">.</span><span class="n">action</span>
<span class="ln">20</span>        <span class="k">if</span> <span class="p">(!</span><span class="n">action</span><span class="p">.</span><span class="n">isNullOrEmpty</span><span class="p">())</span> <span class="p">{</span>
<span class="ln">21</span>            <span class="n">onReceiveAction</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">intent</span><span class="p">)</span>
<span class="ln">22</span>        <span class="p">}</span>
<span class="ln">23</span>    <span class="p">}</span>
<span class="ln">24</span>
<span class="ln">25</span>    <span class="k">fun</span> <span class="nf">register</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">?)</span> <span class="p">{</span>
<span class="ln">26</span>        <span class="k">if</span> <span class="p">(!</span><span class="n">registered</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">27</span>            <span class="n">context</span><span class="o">?.</span><span class="n">registerReceiver</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">filter</span><span class="p">)</span>
<span class="ln">28</span>            <span class="n">registered</span> <span class="p">=</span> <span class="k">true</span>
<span class="ln">29</span>        <span class="p">}</span>
<span class="ln">30</span>    <span class="p">}</span>
<span class="ln">31</span>
<span class="ln">32</span>    <span class="k">fun</span> <span class="nf">unregister</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">?)</span> <span class="p">{</span>
<span class="ln">33</span>        <span class="k">if</span> <span class="p">(</span><span class="n">registered</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">34</span>            <span class="n">registered</span> <span class="p">=</span> <span class="k">false</span>
<span class="ln">35</span>            <span class="n">context</span><span class="o">?.</span><span class="n">unregisterReceiver</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
<span class="ln">36</span>        <span class="p">}</span>
<span class="ln">37</span>    <span class="p">}</span>
<span class="ln">38</span>
<span class="ln">39</span><span class="p">}</span>
</code></pre></div><p>具体监听方式</p>
<div class="highlight"><pre class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="ln"> 1</span><span class="k">private</span> <span class="k">val</span> <span class="py">batteryReceiver</span> <span class="p">=</span> <span class="k">object</span> <span class="err">: </span><span class="nc">SelfBroadcastReceiver</span><span class="p">(</span>
<span class="ln"> 2</span>        <span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_BATTERY_CHANGED</span><span class="p">,</span>
<span class="ln"> 3</span>        <span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_BATTERY_LOW</span><span class="p">,</span>
<span class="ln"> 4</span>        <span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_BATTERY_OKAY</span><span class="p">,</span>
<span class="ln"> 5</span>        <span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_POWER_CONNECTED</span><span class="p">,</span>
<span class="ln"> 6</span>        <span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_POWER_DISCONNECTED</span>
<span class="ln"> 7</span>    <span class="p">)</span> <span class="p">{</span>
<span class="ln"> 8</span>        <span class="k">override</span> <span class="k">fun</span> <span class="nf">onReceiveAction</span><span class="p">(</span><span class="n">action</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="n">intent</span><span class="p">:</span> <span class="n">Intent</span><span class="p">)</span> <span class="p">{</span>
<span class="ln"> 9</span>            <span class="k">when</span> <span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">10</span>                <span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_BATTERY_CHANGED</span> <span class="o">-&gt;</span> <span class="p">{</span>
<span class="ln">11</span>                    <span class="n">updateBattery</span><span class="p">(</span><span class="n">intent</span><span class="p">)</span>
<span class="ln">12</span>                <span class="p">}</span>
<span class="ln">13</span>                <span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_BATTERY_LOW</span> <span class="o">-&gt;</span> <span class="p">{</span>
<span class="ln">14</span>
<span class="ln">15</span>                <span class="p">}</span>
<span class="ln">16</span>                <span class="n">Intent</span><span class="p">.</span><span class="n">ACTION_BATTERY_OKAY</span> <span class="o">-&gt;</span> <span class="p">{</span>
<span class="ln">17</span>
<span class="ln">18</span>                <span class="p">}</span>
<span class="ln">19</span>            <span class="p">}</span>
<span class="ln">20</span>        <span class="p">}</span>
<span class="ln">21</span>    <span class="p">}</span>
</code></pre></div><h1 id="问题回答">问题回答</h1>
<p>1.广播的用途</p>
<p>1）通过设置广播接收器监听广播，并做出程序逻辑的处理</p>
<p>2）可以进行android组件的通信，线程通讯，进程通讯，app内通讯，app之间通讯等</p>
<p>2.广播按注册来分动态和静态注册，广播按类型分为标准和有序，显然8.0之后非系统广播只能是动态注册，所以有序也是需要动态注册的。具体可以看本文上述demo。</p>
<p>3.根据下面的例子简单说明</p>
<blockquote>
<p>adb shell am broadcast -a android.intent.action.SENDLOVE -n com.example.broadcast/.MyTanabataReceiver &ndash;es &ldquo;love&rdquo; &ldquo;爱你&rdquo; &ndash;ei &ldquo;days&rdquo; 10000 &ndash;ez “reality” true</p>
</blockquote>
<p>参数说明</p>
<p>例如-a指定action，-d指定uri，-p指定包名，-n指定组件名，-es指定{key,value}</p>
<p>&ndash;es 表示使用字符串类型参数 &ndash;ei 表示int类型参数 &ndash;ez 表示boolean类型</p>
<blockquote>
<p>[-a <!-- raw HTML omitted -->]
[-d &lt;DATA_URI&gt;]
[-t &lt;MIME_TYPE&gt;] 
[-c <!-- raw HTML omitted --> [-c <!-- raw HTML omitted -->] &hellip;] 
[-e|&ndash;es &lt;EXTRA_KEY&gt; &lt;EXTRA_STRING_VALUE&gt; &hellip;] 
[&ndash;ez &lt;EXTRA_KEY&gt; &lt;EXTRA_BOOLEAN_VALUE&gt; &hellip;] 
[-e|&ndash;ei &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt; &hellip;] 
[-n <!-- raw HTML omitted -->]
[-f <!-- raw HTML omitted -->] [<!-- raw HTML omitted -->]</p>
</blockquote>
<p>当然广播的参数也可以自定义，广播参数最终调用的是Intent.java中parseCommandArgs方法，这是一个对外隐藏的方法，当然有了源码之后可以自定义参数去发广播指令，具体自定义参数广播可以看<a href="https://blog.csdn.net/qq_25201379/article/details/94765398">散尽万千浮华</a></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="ln">  1</span><span class="cm">/** @hide */</span>
<span class="ln">  2</span><span class="kd">public</span> <span class="kd">static</span> <span class="n">Intent</span> <span class="nf">parseCommandArgs</span><span class="o">(</span><span class="n">ShellCommand</span> <span class="n">cmd</span><span class="o">,</span> <span class="n">CommandOptionHandler</span> <span class="n">optionHandler</span><span class="o">)</span>
<span class="ln">  3</span>    <span class="o">...</span>
<span class="ln">  4</span>    <span class="k">while</span> <span class="o">((</span><span class="n">opt</span><span class="o">=</span><span class="n">cmd</span><span class="o">.</span><span class="na">getNextOption</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">  5</span>        <span class="k">switch</span> <span class="o">(</span><span class="n">opt</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">  6</span>            <span class="c1">//指定action    
</span><span class="ln">  7</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;-a&#34;</span><span class="o">:</span>
<span class="ln">  8</span>                <span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">());</span>
<span class="ln">  9</span>                <span class="k">if</span> <span class="o">(</span><span class="n">intent</span> <span class="o">==</span> <span class="n">baseIntent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln"> 10</span>                    <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln"> 11</span>                <span class="o">}</span>
<span class="ln"> 12</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 13</span>            <span class="c1">//指定Uri
</span><span class="ln"> 14</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;-d&#34;</span><span class="o">:</span>
<span class="ln"> 15</span>                <span class="n">data</span> <span class="o">=</span> <span class="n">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">());</span>
<span class="ln"> 16</span>                <span class="k">if</span> <span class="o">(</span><span class="n">intent</span> <span class="o">==</span> <span class="n">baseIntent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln"> 17</span>                    <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln"> 18</span>                <span class="o">}</span>
<span class="ln"> 19</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 20</span>            <span class="k">case</span> <span class="s">&#34;-t&#34;</span><span class="o">:</span>
<span class="ln"> 21</span>                <span class="n">type</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 22</span>                <span class="k">if</span> <span class="o">(</span><span class="n">intent</span> <span class="o">==</span> <span class="n">baseIntent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln"> 23</span>                    <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln"> 24</span>                <span class="o">}</span>
<span class="ln"> 25</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 26</span>            <span class="k">case</span> <span class="s">&#34;-c&#34;</span><span class="o">:</span>
<span class="ln"> 27</span>                <span class="n">intent</span><span class="o">.</span><span class="na">addCategory</span><span class="o">(</span><span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">());</span>
<span class="ln"> 28</span>                <span class="k">if</span> <span class="o">(</span><span class="n">intent</span> <span class="o">==</span> <span class="n">baseIntent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln"> 29</span>                    <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln"> 30</span>                <span class="o">}</span>
<span class="ln"> 31</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 32</span>            <span class="c1">//使用字符串类型的键值对{key, value}    
</span><span class="ln"> 33</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;-e&#34;</span><span class="o">:</span>
<span class="ln"> 34</span>            <span class="k">case</span> <span class="s">&#34;--es&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln"> 35</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 36</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 37</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
<span class="ln"> 38</span>            <span class="o">}</span>
<span class="ln"> 39</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 40</span>            <span class="k">case</span> <span class="s">&#34;--esn&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln"> 41</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 42</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="kc">null</span><span class="o">);</span>
<span class="ln"> 43</span>            <span class="o">}</span>
<span class="ln"> 44</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 45</span>            <span class="c1">//使用整数类型的键值对{key, value}    
</span><span class="ln"> 46</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;--ei&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln"> 47</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 48</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 49</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
<span class="ln"> 50</span>            <span class="o">}</span>
<span class="ln"> 51</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 52</span>            <span class="c1">//使用Uri类型的键值对{key, value}    
</span><span class="ln"> 53</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;--eu&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln"> 54</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 55</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 56</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
<span class="ln"> 57</span>            <span class="o">}</span>
<span class="ln"> 58</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 59</span>            <span class="k">case</span> <span class="s">&#34;--ecn&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln"> 60</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 61</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 62</span>                <span class="n">ComponentName</span> <span class="n">cn</span> <span class="o">=</span> <span class="n">ComponentName</span><span class="o">.</span><span class="na">unflattenFromString</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
<span class="ln"> 63</span>                <span class="k">if</span> <span class="o">(</span><span class="n">cn</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
<span class="ln"> 64</span>                    <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&#34;Bad component name: &#34;</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>
<span class="ln"> 65</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">cn</span><span class="o">);</span>
<span class="ln"> 66</span>            <span class="o">}</span>
<span class="ln"> 67</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 68</span>            <span class="c1">//使用字符串类型的键值对{key, value}，且value使用，隔开的list    
</span><span class="ln"> 69</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;--eia&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln"> 70</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 71</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 72</span>                <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">);</span>
<span class="ln"> 73</span>                <span class="kt">int</span><span class="o">[]</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
<span class="ln"> 74</span>                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="ln"> 75</span>                    <span class="n">list</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
<span class="ln"> 76</span>                <span class="o">}</span>
<span class="ln"> 77</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">list</span><span class="o">);</span>
<span class="ln"> 78</span>            <span class="o">}</span>
<span class="ln"> 79</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 80</span>            <span class="c1">//使用整数类型的键值对{key, value}，且value使用，隔开的list    
</span><span class="ln"> 81</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;--eial&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln"> 82</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 83</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 84</span>                <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">);</span>
<span class="ln"> 85</span>                <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
<span class="ln"> 86</span>                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="ln"> 87</span>                    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">]));</span>
<span class="ln"> 88</span>                <span class="o">}</span>
<span class="ln"> 89</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">list</span><span class="o">);</span>
<span class="ln"> 90</span>            <span class="o">}</span>
<span class="ln"> 91</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 92</span>            <span class="c1">//使用Long类型的键值对{key, value}    
</span><span class="ln"> 93</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;--el&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln"> 94</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 95</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln"> 96</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">Long</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
<span class="ln"> 97</span>            <span class="o">}</span>
<span class="ln"> 98</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln"> 99</span>            <span class="c1">//使用Long类型的键值对{key, value}，且value使用，隔开的list    
</span><span class="ln">100</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;--ela&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">101</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">102</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">103</span>                <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">);</span>
<span class="ln">104</span>                <span class="kt">long</span><span class="o">[]</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">long</span><span class="o">[</span><span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
<span class="ln">105</span>                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="ln">106</span>                    <span class="n">list</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
<span class="ln">107</span>                <span class="o">}</span>
<span class="ln">108</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">list</span><span class="o">);</span>
<span class="ln">109</span>                <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">110</span>            <span class="o">}</span>
<span class="ln">111</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">112</span>            <span class="k">case</span> <span class="s">&#34;--elal&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">113</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">114</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">115</span>                <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">);</span>
<span class="ln">116</span>                <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
<span class="ln">117</span>                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="ln">118</span>                    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Long</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">]));</span>
<span class="ln">119</span>                <span class="o">}</span>
<span class="ln">120</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">list</span><span class="o">);</span>
<span class="ln">121</span>                <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">122</span>            <span class="o">}</span>
<span class="ln">123</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">124</span>            <span class="c1">//使用Float类型的键值对{key, value}    
</span><span class="ln">125</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;--ef&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">126</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">127</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">128</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">Float</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
<span class="ln">129</span>                <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">130</span>            <span class="o">}</span>
<span class="ln">131</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">132</span>            <span class="k">case</span> <span class="s">&#34;--efa&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">133</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">134</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">135</span>                <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">);</span>
<span class="ln">136</span>                <span class="kt">float</span><span class="o">[]</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">float</span><span class="o">[</span><span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
<span class="ln">137</span>                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="ln">138</span>                    <span class="n">list</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
<span class="ln">139</span>                <span class="o">}</span>
<span class="ln">140</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">list</span><span class="o">);</span>
<span class="ln">141</span>                <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">142</span>            <span class="o">}</span>
<span class="ln">143</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">144</span>            <span class="k">case</span> <span class="s">&#34;--efal&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">145</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">146</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">147</span>                <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;,&#34;</span><span class="o">);</span>
<span class="ln">148</span>                <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
<span class="ln">149</span>                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="ln">150</span>                    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Float</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">]));</span>
<span class="ln">151</span>                <span class="o">}</span>
<span class="ln">152</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">list</span><span class="o">);</span>
<span class="ln">153</span>                <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">154</span>            <span class="o">}</span>
<span class="ln">155</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">156</span>            <span class="k">case</span> <span class="s">&#34;--esa&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">157</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">158</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">159</span>                <span class="c1">// Split on commas unless they are preceeded by an escape.
</span><span class="ln">160</span><span class="c1"></span>                <span class="c1">// The escape character must be escaped for the string and
</span><span class="ln">161</span><span class="c1"></span>                <span class="c1">// again for the regex, thus four escape characters become one.
</span><span class="ln">162</span><span class="c1"></span>                <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;(?&lt;!\\\\),&#34;</span><span class="o">);</span>
<span class="ln">163</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">strings</span><span class="o">);</span>
<span class="ln">164</span>                <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">165</span>            <span class="o">}</span>
<span class="ln">166</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">167</span>            <span class="k">case</span> <span class="s">&#34;--esal&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">168</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">169</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">170</span>                <span class="c1">// Split on commas unless they are preceeded by an escape.
</span><span class="ln">171</span><span class="c1"></span>                <span class="c1">// The escape character must be escaped for the string and
</span><span class="ln">172</span><span class="c1"></span>                <span class="c1">// again for the regex, thus four escape characters become one.
</span><span class="ln">173</span><span class="c1"></span>                <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;(?&lt;!\\\\),&#34;</span><span class="o">);</span>
<span class="ln">174</span>                <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
<span class="ln">175</span>                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strings</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="ln">176</span>                    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">strings</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
<span class="ln">177</span>                <span class="o">}</span>
<span class="ln">178</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">list</span><span class="o">);</span>
<span class="ln">179</span>                <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">180</span>            <span class="o">}</span>
<span class="ln">181</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">182</span>            <span class="c1">//使用boolean类型的键值对{key, value}    
</span><span class="ln">183</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;--ez&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">184</span>                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">185</span>                <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span>
<span class="ln">186</span>                <span class="c1">// Boolean.valueOf() results in false for anything that is not &#34;true&#34;, which is
</span><span class="ln">187</span><span class="c1"></span>                <span class="c1">// error-prone in shell commands
</span><span class="ln">188</span><span class="c1"></span>                <span class="kt">boolean</span> <span class="n">arg</span><span class="o">;</span>
<span class="ln">189</span>                <span class="k">if</span> <span class="o">(</span><span class="s">&#34;true&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="o">||</span> <span class="s">&#34;t&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">value</span><span class="o">))</span> <span class="o">{</span>
<span class="ln">190</span>                    <span class="n">arg</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">191</span>                <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="s">&#34;false&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="o">||</span> <span class="s">&#34;f&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">value</span><span class="o">))</span> <span class="o">{</span>
<span class="ln">192</span>                    <span class="n">arg</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="ln">193</span>                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<span class="ln">194</span>                    <span class="k">try</span> <span class="o">{</span>
<span class="ln">195</span>                        <span class="n">arg</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="o">!=</span> <span class="n">0</span><span class="o">;</span>
<span class="ln">196</span>                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NumberFormatException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">197</span>                        <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&#34;Invalid boolean value: &#34;</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>
<span class="ln">198</span>                    <span class="o">}</span>
<span class="ln">199</span>                <span class="o">}</span>
<span class="ln">200</span>
<span class="ln">201</span>                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">arg</span><span class="o">);</span>
<span class="ln">202</span>            <span class="o">}</span>
<span class="ln">203</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">204</span>            <span class="c1">//指定包名    
</span><span class="ln">205</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;-n&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">206</span>                <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">207</span>                <span class="n">ComponentName</span> <span class="n">cn</span> <span class="o">=</span> <span class="n">ComponentName</span><span class="o">.</span><span class="na">unflattenFromString</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
<span class="ln">208</span>                <span class="k">if</span> <span class="o">(</span><span class="n">cn</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
<span class="ln">209</span>                    <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&#34;Bad component name: &#34;</span> <span class="o">+</span> <span class="n">str</span><span class="o">);</span>
<span class="ln">210</span>                <span class="n">intent</span><span class="o">.</span><span class="na">setComponent</span><span class="o">(</span><span class="n">cn</span><span class="o">);</span>
<span class="ln">211</span>                <span class="k">if</span> <span class="o">(</span><span class="n">intent</span> <span class="o">==</span> <span class="n">baseIntent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">212</span>                    <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">213</span>                <span class="o">}</span>
<span class="ln">214</span>            <span class="o">}</span>
<span class="ln">215</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">216</span>            <span class="c1">//指定组件名    
</span><span class="ln">217</span><span class="c1"></span>            <span class="k">case</span> <span class="s">&#34;-p&#34;</span><span class="o">:</span> <span class="o">{</span>
<span class="ln">218</span>                <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="na">getNextArgRequired</span><span class="o">();</span>
<span class="ln">219</span>                <span class="n">intent</span><span class="o">.</span><span class="na">setPackage</span><span class="o">(</span><span class="n">str</span><span class="o">);</span>
<span class="ln">220</span>                <span class="k">if</span> <span class="o">(</span><span class="n">intent</span> <span class="o">==</span> <span class="n">baseIntent</span><span class="o">)</span> <span class="o">{</span>
<span class="ln">221</span>                    <span class="n">hasIntentInfo</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="ln">222</span>                <span class="o">}</span>
<span class="ln">223</span>            <span class="o">}</span>
<span class="ln">224</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">225</span>            <span class="o">...</span>
<span class="ln">226</span>            <span class="k">default</span><span class="o">:</span>
<span class="ln">227</span>                <span class="k">if</span> <span class="o">(</span><span class="n">optionHandler</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">optionHandler</span><span class="o">.</span><span class="na">handleOption</span><span class="o">(</span><span class="n">opt</span><span class="o">,</span> <span class="n">cmd</span><span class="o">))</span> <span class="o">{</span>
<span class="ln">228</span>                    <span class="c1">// Okay, caller handled this option.
</span><span class="ln">229</span><span class="c1"></span>                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<span class="ln">230</span>                    <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&#34;Unknown option: &#34;</span> <span class="o">+</span> <span class="n">opt</span><span class="o">);</span>
<span class="ln">231</span>                <span class="o">}</span>
<span class="ln">232</span>                <span class="k">break</span><span class="o">;</span>
<span class="ln">233</span>        <span class="o">}</span>
<span class="ln">234</span>    <span class="o">}</span>
<span class="ln">235</span>    <span class="o">...</span>
<span class="ln">236</span><span class="o">}</span>        
</code></pre></div><p><a href="https://github.com/YangYang48/project/tree/master/MyBroadcast">本文所有实例代码下载</a></p>
<p>祝各位宝宝们七夕快乐！</p>
<h1 id="参考">参考</h1>
<p><a href="https://blog.csdn.net/qq_25201379/article/details/94765398">[1] 散尽万千浮华, Android adb构造特定格式的broadcast intent，伪造短信广播, 2019.</a></p>
<p><a href="https://www.cnblogs.com/622698abc/archive/2013/06/11/3132306.html?utm_source=tuicool">[2] 我辛飞翔, 在命令行中通过adb shell am broadcast发送广播通知以及Android的常用adb命令, 2013.</a></p>
<p><a href="https://www.runoob.com/w3cnote/android-tutorial-broadcastreceiver.html">[3] 菜鸟教程, BroadcastReceiver牛刀小试, 2015.</a></p>
<p><a href="https://www.runoob.com/w3cnote/android-tutorial-broadcastreceiver-2.html">[4] 菜鸟教程, BroadcastReceiver庖丁解牛, 2015.</a></p>
<p><a href="https://blog.csdn.net/rebornSS/article/details/105824587">[5] 凉拌西红柿S, 有序广播详解, 2020.</a></p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">标签</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://yangyang48.github.io/tags/android/">Android</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yangyang48.github.io/2021/08/handler5-intentservice/" data-tooltip="Handler5 IntentService">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">下一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yangyang48.github.io/2021/07/rtmp%E5%B0%81%E5%8C%85/" data-tooltip="RTMP封包">
              
                  <span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
		
		<div class="post-comment main-content-wrap">
		
  
  <div id="vcomments"></div>
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <script type="text/javascript">
    new Valine({
        el: '#vcomments' ,
        appId: 'mwl8M1aQzLnRE6JIpIY3sgE5-9Nh9j0Va',
        appKey: 'mPGr6GMC0BuzAKkxinnd0IAr',
        notify:  true , 
        verify:  false , 
        avatar:'retro', 
        placeholder: '欢迎各位宝宝留言~',
        visitor:  true 
    });
  </script>

		</div>
        <footer id="footer" class="main-content-wrap">
  
  
  
  <span class="copyrights">
    &copy; 2022 Yang Ju. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yangyang48.github.io/2021/08/handler5-intentservice/" data-tooltip="Handler5 IntentService">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">下一篇</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yangyang48.github.io/2021/07/rtmp%E5%B0%81%E5%8C%85/" data-tooltip="RTMP封包">
              
                  <span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fyangyang48.github.io%2F2021%2F08%2F%25E4%25B8%2580%25E7%25AF%2587%25E6%2596%2587%25E7%25AB%25A0%25E6%2590%259E%25E5%25AE%259A%25E5%25B9%25BF%25E6%2592%25AD%2F">
          <i class="fa fa-facebook-official"></i><span>分享到 Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fyangyang48.github.io%2F2021%2F08%2F%25E4%25B8%2580%25E7%25AF%2587%25E6%2596%2587%25E7%25AB%25A0%25E6%2590%259E%25E5%25AE%259A%25E5%25B9%25BF%25E6%2592%25AD%2F">
          <i class="fa fa-twitter"></i><span>分享到 Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3A%2F%2Fyangyang48.github.io%2F2021%2F08%2F%25E4%25B8%2580%25E7%25AF%2587%25E6%2596%2587%25E7%25AB%25A0%25E6%2590%259E%25E5%25AE%259A%25E5%25B9%25BF%25E6%2592%25AD%2F">
          <i class="fa fa-google-plus"></i><span>分享到 Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://img-blog.csdnimg.cn/20210711204627625.jpg" alt="作者的图片" />
    
    <h4 id="about-card-name">Yang Ju</h4>
    
      <div id="about-card-bio">Nanjing University of Science and Technology</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Software Development Engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        NanJing,China
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://yangyang48.github.io/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://yangyang48.github.io/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


  
    <script src="https://yangyang48.github.io/js/copy-to-clipboard.js"></script>
  

<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'https:\/\/yangyang48.github.io\/2021\/08\/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E5%AE%9A%E5%B9%BF%E6%92%AD\/';
          
            this.page.identifier = '\/2021\/08\/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%90%9E%E5%AE%9A%E5%B9%BF%E6%92%AD\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'hugo-tranquilpeak-theme';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

